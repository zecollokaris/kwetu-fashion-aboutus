!function(t){if("function"==typeof define&&define.amd){var e=define;define=t}!function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return i(n||t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,n,r){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(n,r){function o(t){if("string"!=typeof t)return t;var e=/(?:^|[^\d])(\d{4}[\- ]?\d{4}[\- ]?\d{2}[\- ]?\d{2}[\- ]?\d{1,4})(?:[^\d]|$)/;return t.replace(e,"xxxx-xxxx-xxxx-xxxx")}function a(){"use strict";r("#idz_postmsg").prop("disabled",!1),r(".idz_writting").html(""),n.chat.disableLoading()}function s(){"use strict";!0!==r("#idz_postmsg").prop("disabled")&&(r("#idz_postmsg").prop("disabled",!0),r(".idz_writting").html(n.T("livechat.xmpp.connection.disconnected")))}function c(){"use strict";r(".idz_writting").html(""),n.chat.putOpAlert(n.T("CONNECTION_ERREUR"))}function u(t,e,i){g.invitation.setFirstMessageId(i);var o=t.status,a=r.Deferred();if(n.opOffline=o.opOffline,n.c2cOffline=o.c2cOffline,n.opWatching=o.opWatching,n.opBusy=o.opBusy,n.initSession=!1,!o.opOffline){n.chat.history_id=t.chatId,n.vStats.history_id=t.chatId,n.chat.status=2,n.conversationJid=t.conversationJid,g.room.join(n.conversationJid,n.vuid,10).done(function(){g.room.groupchat(e,i),a.resolve()},a.reject),setTimeout(function(){g.getConnection().connected&&n.chat.sendPresence("dnd")},2500);var s=h();r("#idz_button_print").attr("href",n.chaturl+"gethistory.php?id="+t.chatId+"&u="+n.vuid),r("#idz_button_mail").attr("href",n.chaturl+"gethistory_mail.php?id="+t.chatId+"&u="+n.vuid+"&timezoneAbbr="+s),_.emit("conversation.chat.started")}return(o.opOffline||o.opBusy)&&a.reject(),a.promise()}function l(t){var e=t.status;n.opOffline=e.opOffline,n.c2cOffline=e.c2cOffline,n.opBusy=e.opBusy,n.initSession=!1;var i=r.Deferred();if(e.opOffline)setTimeout(function(){n.setStatus()},400),n.chat.disableLoading();else{n.chat.history_id=t.chatId,n.vStats.history_id=t.chatId,n.chat.status=2,n.conversationJid=t.conversationJid,g.room.join(n.conversationJid,n.vuid,10).done(function(){g.getConnection().connected&&n.chat.sendPresence("dnd"),i.resolve()},i.reject),n.operator=t.operator,n.c2coperator=t.c2coperator?t.c2coperator:t.operator,n.on_call&&(n.operator=t.c2coperator);var o=h();r("#idz_button_print").attr("href",n.chaturl+"gethistory.php?id="+t.chatId+"&u="+n.vuid),r("#idz_button_mail").attr("href",n.chaturl+"gethistory_mail.php?id="+t.chatId+"&u="+n.vuid+"&timezoneAbbr="+o),_.emit("conversation.chat.started"),n.customize.floating_button>0&&n.floatingWidget.onPresenceChange(!0),n.vaSCI&&n.chat.sendAlert("!vaSCI","",!0)}return(e.opOffline||e.opBusy)&&i.reject(),i.promise()}function d(){var t="visitor";(n.flags.proactif_alert||n.flags.proactif_invit)&&(t="proactif"),n.callbacks.onChatStarted({id:n.chat.history_id,startedBy:t})}function f(t){return!m.isUndefined(t)&&!m.isNull(t)&&(!!m.some(x,t)||(x.push(t),x.length>5&&x.shift(),!1))}function h(){var t=String(new Date),e=/\((.*)\)/.exec(t,"g");return!e||e.length<2?"":e[1]}if(!iAdvize.lock){var p,m=e("lodash"),g=n.require("xmpp"),v=n.require("logger"),_=n.require("eventManager"),b=_.events,y=n.require("emojis-service");_.on(b.OnXmppRoomJoined,function(){g.sendChatState("paused")}),_.on(b.OnXmppConnectionDisconnected,function(){s()}),_.on(b.OnXmppReconnectionFailed,function(){c()}),_.on(b.OnXmppConnectionConnected,function(){a()});var w,S;n.call.isEnabled&&(w=n.require("livechat/call")),n.callMeeting.enabled&&n.require("livechat/callmeeting"),1==n.preferences.mirroring_enabled&&(S=n.require("mirror"))&&S.listen&&S.listen(_),n.visio.enabled&&n.require("visio"),n.define("emitter",function(){function t(t){function e(){for(var e=-1,r=n.length;++e<r;)n[e].apply(this,arguments);return t}var n=[];return e.on=function(e){return n.push(e),t},e}return function(){for(var e=-1,n=arguments.length,r={};++e<n;)r[arguments[e]]=t(r);return r.on=function(t,e){return r[t].on(e)},r}}),n.noDefaultScrollTemplate="iphone"==n.customize.layout||"mobile"==n.customize.layout||"tablette"==n.customize.layout||"chomette"==n.customize.layout||"monoprix2"==n.customize.layout||"interflora-uk"==n.customize.layout||"natixis-caissedepargne-espaceclient"==n.customize.layout||"nexecur"==n.customize.layout||"vvf"==n.customize.layout||"sfr3"==n.customize.layout||"boursorama3"==n.customize.layout||"fortuneo2"==n.customize.layout||"mecatechnic2"==n.customize.layout||"mecatechnic3"==n.customize.layout||"carglass"==n.customize.layout||"autosphere2"==n.customize.layout||"nordnet2"==n.customize.layout||"flowercampings"==n.customize.layout||"neckermannreisen"==n.customize.layout||"dermacenter"==n.customize.layout||"cdiscountv4"==n.customize.layout||"groupalia"==n.customize.layout||"entega2"==n.customize.layout;var O=function(){if(n.Templates.newTemplates)n.noOfferPanelTemplate=n.Templates.isResponsive;else{var t=n.require("template").customizer;n.noOfferPanelTemplate=t.noOfferPanelTemplate(n.customize.layout)}return n.noOfferPanelTemplate};n.initSession=!1;var T=function(t,e){return t&&e?t.toLowerCase()===e.toLowerCase():t===e},C=function(){1!==n.chat.satisfaction?(2===n.chat.status?window.confirm(n.T("VISITOR_CONFIRM_CLOSE"))&&(n.flags.visio_status&&_.emit(b.OnConversationVisioClosed),-1===n.operator.id||1===n.virtualOP||"1"!==n.preferences.param_satisfaction||2===n.chat.satisfaction||2!==n.chat.status||n.blocked?(n.Templates.hideUI(),n.chatbar_state=2,n.JSONStore.save({chatbar_state:n.chatbar_state})):(n.chat.satisfaction=1,n.Templates.displaySatisfaction(),n.callbacks.onSatisfactionDisplayed()),n.chat.sendChatClose(),n.callbacks.onChatEnded({id:n.chat.history_id,endedBy:"visitor"})):(n.Templates.hideUI(),n.chatbar_state=2,n.JSONStore.save({chatbar_state:n.chatbar_state})),n.chatbox_state=n.chat.CHATBOX_STATES.CHATBAR_HIDDEN):n.Templates.removeSatisfaction()};n.playSound=function(t){var e='<embed src="'+n.chaturl+"sounds/swf.php?s="+n.website_id+"&q="+t+'" width="1" height="1" quality="high" pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash">';r("#idz_sound_container").html(e)},n.onCoreLoaded=function(t){return n.coreloaded?("function"==typeof t&&t(),!1):(n.coreloaded=!0,r(document).keypress(function(t){27==t.keyCode&&t.preventDefault()}),n.chat.cCook=document.cookie,n.callbacks.onCookieSaved(),n.hasFocus=1,n.blinktm=null,n.oTitle=document.title,r(window).bind("scroll.activity",function(){n.onActivity()}),r(window.document).bind("keypress.activity",function(){n.onActivity()}),r("body").bind("mousemove.activity",function(){n.onActivity()}),r(window).focus(function(){n.hasFocus=1,null!==n.blinktm&&(clearInterval(n.blinktm),n.blinktm=null,document.title=n.oTitle)}),r(window).blur(function(){n.hasFocus=0,n.vStats.activeSince=null}),n.monitoredForms&&r("form").submit(function(t){if("post"==t.target.method.toLowerCase()){for(var e=n.monitoredForms.length;e--;)if(n.monitoredForms[e]==t.target.id){n.usePOST=t.target.id;break}}else n.usePOST=null}),n.onChatLoaded(t),!0)},n.onChatLoaded=function(t){if(!n.chatloaded){n.chatloaded=!0,n.chat.history_id=+n.flags.history_id,n.chat.prev_history=+n.flags.prev_history,n.chat.status=+n.flags.chat_status,n.chat.satisfaction=+n.flags.satisfaction_status,n.chat.cobrowsing=+n.flags.chat_cobrowsing,n.proactif_timeElapsed=n.flags.proactif_timeElapsed,n.proactif_activated=n.flags.proactif_activated,n.conversationJid=n.flags.conversationJid,n.chat.popinLeft=n.flags.popinLeft,n.chat.popinTop=n.flags.popinTop,n.callbacks.onScriptLoaded(),""===n.iframeID&&n.chat.bindWidgetEvents();var e=3===n.chat.status&&"0"===n.flags.operator_closed&&"1"===n.flags.visitor_closed;n.chat.history_id>0&&(2===n.chat.status||e)&&(_.on(b.OnXmppConnectionConnected,function(){g.room.join(n.conversationJid,n.vuid)}),g.connect(!0).fail(n.chat.showConnectionError));try{setTimeout(function(){n.Templates&&n.Templates.restoreState&&n.Templates.restoreState(),(n.chat.history_id>0||n.chat.prev_history>0)&&""==n.iframeID&&n.chat.reloadHistory(),2===n.chat.status&&"1"===n.flags.visio_status&&_.emit(b.OnConversationVisioRequested),r.each(["hideUI","hideDialog","minimizeChatbar"],function(t,e){var r=n.Templates[e];n.Templates[e]=function(){r.apply(n.Templates),n.callbacks.onChatHidden()}})},100)}catch(t){n.errorMailer("onChatLoaded try to connect: ",t,"")}}"function"==typeof t&&t()},n.transfer=function(t){var e=r.parseJSON(t);n.chat.putOpAlert(n.T("OPERATEUR_TRANSFER")),n.operator=e.operator,n.c2coperator=n.operator,n.chat.history_id=e.newConversationID,n.vStats.history_id=e.newConversationID,!0===n.operator.isExpert&&n.chat.putOpAlert(n.chat.getExpertDisclaimer());var i=h();r("#idz_button_print").attr("href",n.chaturl+"gethistory.php?id="+e.newConversationID+"&u="+n.vuid),r("#idz_button_mail").attr("href",n.chaturl+"gethistory_mail.php?id="+e.newConversationID+"&u="+n.vuid+"&timezoneAbbr="+i),n.chat.sendPresence("available"),n.callbacks.onVisitorTransferred({operatorId:n.operator.id,historyId:n.chat.history_id})},n.createConversation=function(t,e,i,o,a){if(n.initSession)return r.Deferred().reject().promise();n.initSession=!0;var s={sid:n.website_id,vuid:n.vuid,dep:n.forceDep,r:n.flags.proactif_activatedId||0,nick:Strophe.getNodeFromJid(g.getConnection().jid),msg:e?encodeURIComponent(e):"",messageId:a,op:n.operator.id||0,o:n.forceAgent?n.forceAgent:0,h:n.forceAgent&&n.vStats.merpHash?n.vStats.merpHash:"",br:n.vStats.browserInfo||""};if(void 0!==window.idzCustomData&&(idzCustomData.page_type&&(s.pt=encodeURIComponent(idzCustomData.page_type)),idzCustomData.brand&&(s.pb=encodeURIComponent(idzCustomData.brand)),idzCustomData.rayon&&(s.pr=encodeURIComponent(idzCustomData.rayon)),idzCustomData.univers&&(s.pu=encodeURIComponent(idzCustomData.univers)),idzCustomData.cust_name&&(s.pcna=encodeURIComponent(idzCustomData.cust_name)),idzCustomData.cust_firstname&&(s.pcfn=encodeURIComponent(idzCustomData.cust_firstname)),idzCustomData.cust_address&&(s.pcad=encodeURIComponent(idzCustomData.cust_address)),idzCustomData.cust_city&&(s.pcci=encodeURIComponent(idzCustomData.cust_city)),idzCustomData.cust_zipcode&&(s.pczc=encodeURIComponent(idzCustomData.cust_zipcode)),idzCustomData.cust_country&&(s.pcco=encodeURIComponent(idzCustomData.cust_country)),idzCustomData.cust_phonenumber&&(s.pcpn=encodeURIComponent(idzCustomData.cust_phonenumber)),idzCustomData.cust_email&&(s.pcem=encodeURIComponent(idzCustomData.cust_email))),"visio"===t)return r.getJSON(n.chaturl+"rpc/visio.php",s);n.vaSCI&&(s.va=n.vaSCI),s.cd=window.idzCustomData||[],s.h&&(n.routing.enabled=!1);var c=n.routing.enabled?"init_routing.php":"init_session.php";return(p=r.getJSON(n.chaturl+"rpc/"+c+"?lang="+n.curlang+"&log_uuid="+i+"&callback=?",s)).then(function(t){return n.routing.enabled?u(t,e,a):l(t)})},n.doInit=function(){2!=n.chat.status?n.chat.sendPresence("available"):n.chat.sendPresence("dnd"),n.chat.connected=!0};var x=[],E={OPERATOR:1,VISITOR:2,OPERATOR_ALERT:3,VISITOR_ALERT:4,VISITOR_NAVIGATION:5,OPERATOR_RICH_CONTENT:6,VISITOR_RICH_CONTENT:7},A={HIDDEN:1,OPENED:2,MINIMIZED:3,CHATBAR_HIDDEN:4};n.chat={MESSAGE_TYPES:E,CHATBOX_STATES:A,chatbox_state:A.HIDDEN,status:0,history_id:0,composing:0,watch:0,connected:!1,reconnecting:!1,started:!1,cobrowsing:0,offercount:1,satisfaction:0,automatedStartMessageId:555,automatedEndMessageId:777,buildChat:function(){try{if(n.chatbuilt)return;n.chatbuilt=!0,n.Templates.loadChatCss(),_.emit("events.chatBuilt")}catch(t){}try{n.Templates.appendChat();var t=document.createElement("div");t.setAttribute("id","idz_sound_container"),r("body").append(t);var e=n.Templates.append2header();""!=e&&r("head").append(e)}catch(t){n.errorMailer("buildChat 2: ",t,"")}try{var i=n.T("BESOIN_AIDE"),o=n.T("POSER_VOTRE_QUESTION_ICI_UN_CONSEILLER_VOUS_REPONDRA"),a="message";if(n.customize["chatbar_txt1_"+n.curlang]&&0!=n.customize["chatbar_txt1_"+n.curlang].length&&(i=n.customize["chatbar_txt1_"+n.curlang]),n.customize["chatbar_txt2_"+n.curlang]&&0!=n.customize["chatbar_txt2_"+n.curlang].length){o=n.customize["chatbar_txt2_"+n.curlang];a="message_edit"}var s=n.Templates.getChatContent().replace(/\{CHATBAR_TXT1\}/g,i).replace(/\{CHATBAR_TXT2\}/g,o).replace(/\{CHATBAR_TITLE\}/g,a);r("#idz_chatglobal").html(s),""!=(e=n.Templates.append2body())&&r("body").append(e),n.Templates.loadLayout()}catch(t){n.errorMailer("buildChat 3: ",t,"")}try{n.chat.loadLayout()}catch(t){n.errorMailer("buildChat 4: ",t,"")}},addCobrowsingImg:function(){r("body").append("<img src='https://static.iadvize.com/images/livechat/anim_clic.gif' id='anim_clic' width='163px' height='161px' style='position: absolute; z-index: 999999999998; top: -3000px; left: -3000px;' />"),r("body").append("<img src='https://static.iadvize.com/images/livechat/op_cursor.png' id='visitor_cursor' width='70px' height='70px' style='position: absolute; z-index: 999999999999; top: -3000px; left: -3000px;' />")},loadLayout:function(){1==n.chat.cobrowsing&&n.chat.addCobrowsingImg(),n.chat.bindSendMessage(),n.chat.bindChatStatesEvents(),r("#idz_chatbox_main").on("click","#idz_button_font_pos, .idz_button_font_pos",function(){var t=1.1*parseFloat(r("#idz_dialogbox").css("font-size"));return t<=21&&(r("#idz_dialogbox").css({"font-size":t+"px"}),n.chat.sendCommand(n.operator.barejid,"!textsize "+t)),!1}),r("#idz_chatbox_main").on("click","#idz_button_font_neg, .idz_button_font_neg",function(){var t=.9*parseFloat(r("#idz_dialogbox").css("font-size"));return t>=10&&(r("#idz_dialogbox").css({"font-size":t+"px"}),n.chat.sendCommand(n.operator.barejid,"!textsize "+t)),!1}),r("#idz_button_close, .idz_button_close").click(function(){if(_.emit("conversation.closed"),2===n.chat.status){var t=Strophe.getBareJidFromJid(g.getConnection().jid);g.getConnection().send($msg({to:t,from:t,type:"chat",website:n.website_id}).c("body").t("!magic_event disabled"))}return(n.Templates.closeDialog||C)(),!1}),r("#idz_button_hide, .idz_button_hide").click(function(){return r("#idz_chatbox").hasClass("idz_chatbox_hide")?(n.Templates.showDialog(),n.chat.sendAlert("!chatshow",n.T("VISITEUR_CHATBOX_OPEN")),n.chatbox_state=n.chat.CHATBOX_STATES.OPENED):(n.Templates.hideDialog(),n.chat.sendAlert("!chathide",n.T("VISITOR_CHATBOX_MINIMIZE")),n.chatbox_state=n.chat.CHATBOX_STATES.MINIMIZED),n.JSONStore.save({chat_status:n.chat.status,chatbox_state:n.chatbox_state}),!1}),setTimeout(function(){n.customize["chatbar_txt2_"+n.curlang]&&0==n.customize["chatbar_txt2_"+n.curlang].length&&r("#idz_msgmsg").width()<=370&&r("#idz_msgmsg").val(n.T("POSER_VOTRE_QUESTION_ICI"))},500),r("#idz_button_mail, .idz_button_mail").click(function(){var t=r("#idz_dialogbox div.idz_msg_visitor").last().size(),e=r("#idz_dialogbox div.idz_msg_operator").last().size();if(!(t>0||e>0))return r("#idz_button_print").attr("target","_self"),n.chat.put_dialog(n.Templates.opAlert.replace(/\{MSG\}/g,n.T("CHAT_VIDE_ACTION_IMPOSSIBLE")).replace(/\{TIME\}/g,n.chat.getMsgTime())),r("#idz_dialogbox div.idz_msg_alert_op").last().addClass("idz_noaction"),!1;var i=window.prompt(n.T("EMAIL_PROMPT"),"");if(""===i||null===i)return!1;var o=n.chat.history_id;0==n.chat.history_id&&(o=n.chat.prev_history);var a=h();r("#idz_button_mail").attr("href",n.chaturl+"gethistory_mail.php?id="+o+"&to="+encodeURIComponent(i)+"&u="+n.vuid+"&timezoneAbbr="+a),r("#mailFrame").length&&r("#mailFrame").remove(),r("body").append("<iframe id='mailFrame' name='mailFrame' style='width:0px; height:0px; border: 0px'></iframe>")}),r("#idz_button_print, .idz_button_print").click(function(){var t=r("#idz_dialogbox div.idz_msg_visitor").last().size(),e=r("#idz_dialogbox div.idz_msg_operator").last().size();return t>0||e>0?(r("#idz_button_print").attr("target","_blank"),!0):(r("#idz_button_print").attr("target","_self"),n.chat.put_dialog(n.Templates.opAlert.replace(/\{MSG\}/g,n.T("CHAT_VIDE_ACTION_IMPOSSIBLE")).replace(/\{TIME\}/g,n.chat.getMsgTime())),r("#idz_dialogbox div.idz_msg_alert_op").last().addClass("idz_noaction"),!1)}),r(".idz_slide_link_close a").click(function(t){t.preventDefault(),r(t.currentTarget).parents(".idz_slide").toggle()}),r("#idz_button_private").click(function(t){t.preventDefault(),r("#idz_chatbox_private").toggle()}),r(".idz_toggle").click(function(t){var e=r(t.currentTarget).find(".idz_toggle_button"),i=e.siblings("input"),o=i.val();e.toggleClass("idz_toggle_on"),e.toggleClass("idz_toggle_off"),1==o?(i.val(0),e.animate({"background-position-x":"-11px"},200)):(i.val(1),e.animate({"background-position-x":"-49px"},200));var a=i.val();n.JSONStore.saveData({visitorDeleteDataEnabled:a}),"1"===a?n.chat.sendAlert("!datadeletionenabled"):n.chat.sendAlert("!datadeletiondisabled")}),1==n.flags.visitorDeleteDataEnabled&&r(".idz_toggle").trigger("click"),setTimeout(function(){n.Templates.minimizeChatbarHide()},1e3),r("#idz_chatbar_minifier, .idz_chatbar_minifier").click(function(){return n.chat.sendAlert("!chatmini",n.T("VISITEUR_CHATBAR_MINIMIZE")),n.Templates.minimizeChatbar(),!1}),r("#idz_chatbar_mini, .idz_chatbar_mini").click(function(){return n.chat.sendAlert("!chatmaxi",n.T("VISITEUR_CHATBAR_OPEN")),n.Templates.maximizeChatbar(),n.Visio&&(n.Visio.reLaunchVideo=!0),r(this).hide(),!1}),r("#idz_msgmsg").charcount({max:n.preferences.chat_message_maxlength,className:"idz_char_counter",maxReachedClassName:"idz_char_counter_max",maxReachedText:n.T("MAXLENGTH_REACHED")}),r("#idz_chatbar").on("click",".idz_upload_trigger",function(t){t.stopPropagation(),t.preventDefault(),r(this).find("input").click()}),r("#idz_chatbar").on("change",".idz_upload_trigger input",function(t){_.emit(b.OnConversationChatFileSelected,t),t.preventDefault(),t.stopPropagation(),r(this).val("")}).on("click",".idz_upload_trigger input",function(t){t.stopPropagation()}),r("#idz_dialogbox").on("click",".idz_upload_abort",function(t){_.emit(b.OnConversationChatUploadAborted,r(this).parents(".idz_upload").data("id")),t.preventDefault(),t.stopPropagation()})},outframeChat:function(){r("body").append("<style>#idz_chatglobal, #idz_chatbar_mini {visibility:hidden;left:-9999px}</style>")},loadInvitation:function(t){n.invitLoaded||(n.Templates.loadChatCss(),n.invitLoaded=!0,1!==n.chat.composing&&(n.callbacks.onInvitationDisplayed({id:t}),n.Templates.hideDialog(),(iAdvize.$LAB||window.$LAB).script(n.chaturl+"invitation.php?id="+t+"&t="+n.customize.layout+"&sid="+n.website_id+"&lang="+n.curlang).wait(function(){})))},onClickChatWidget:function(){0==n.opOffline?(n.butMessage||(2!=n.chat.status&&n.chat.putOpAlert(n.T("SAISIR_UN_MESSAGE")),n.butMessage=!0),n.Templates.maximizeChatbar(),n.Templates.showDialog()):0==n.preferences.param_noconnectedwidget&&(n.butMessage||(2!=n.chat.status&&n.chat.putOpAlert(n.T("SAISIR_UN_MESSAGE")),n.butMessage=!0),n.Templates.maximizeChatbar(),n.Templates.showDialog())},onClickC2cWidget:function(){n.chat.showC2cPopin()},bindWidgetEvents:function(){try{r(".idz_widget")&&r(".idz_widget").length&&(r("#operator_status_textarea")&&r("#operator_status_textarea").length?(r(".idz_widget").click(function(){return 0==n.opOffline&&""!==r("#operator_status_textarea").val()&&(r("#idz_msgmsg").val(r("#operator_status_textarea").val()),r("#operator_status_textarea").val(""),r("#idz_postmsg").click()),!1}),r("#operator_status_textarea").focus(function(){r("#operator_status_textarea").val()==n.T("POSER_VOTRE_QUESTION_ICI_UN_CONSEILLER_VOUS_REPONDRA")&&(r("#operator_status_textarea").val(""),r("#operator_status_textarea").removeAttr("style"))})):r(".idz_widget").click(function(){return n.chat.onClickChatWidget(),!1}))}catch(t){}try{r("#operator_status_textarea")&&r("#operator_status_textarea").length&&r("#operator_status_textarea").keyup(function(t){13==t.which&&(r("#idz_msgmsg").val(r("#operator_status_textarea").val()),r("#operator_status_textarea").val(""),r("#idz_postmsg").click())})}catch(t){}try{r(".idz_widget_v2")&&r(".idz_widget_v2").length&&r(".idz_chatwidget").click(function(){return n.chat.onClickChatWidget(),!1})}catch(t){}try{r(".idz_c2cwidget").length&&r(".idz_c2cwidget").click(function(){return n.chat.onClickC2cWidget(),!1})}catch(t){}r(".idz_c2vwidget").length&&r(".idz_c2vwidget").click(function(){return _.emit(b.OnConversationVisioRequested),!1})},showC2cPopin:function(){_.emit("call.popin.open")},showC2cBusyMessage:function(t){w&&w.View.showC2cBusyMessage(t)},showC2cError:function(t){w&&w.View.showC2cError(t)},closeC2cPopin:function(){w&&w.View.closeC2cPopin()},resetC2cPopin:function(){w&&w.View.resetC2cPopin()},bindChatStatesEvents:function(){var t=function(t){n.operator.barejid&&(g.sendChatState(t),"composing"===t?(n.chat.composing=1,n.callbacks.onVisitorWriting()):(n.chat.composing=0,n.callbacks.onVisitorStopWriting()))};r("#idz_msgmsg").focusout(function(){t("paused")}).focusin(function(){t("active")}).keydown(function(e){13===e.which?t("active"):0===n.chat.composing&&t("composing")}).keyup(function(){!r(this).val().trim()&&n.chat.composing&&t("active")}),r("#idz_msgmsg").keydown(function(t){if(!t.ctrlKey||13!==t.keyCode&&10!==t.keyCode){if(13===t.which)return t.preventDefault(),void r("#idz_postmsg").click()}else{var e=r(this).val()+" \n";r(this).val(e)}})},bindSendMessage:function(){r("#idz_postmsg").on("click",function(){if(!r(this).prop("disabled")){try{var t=r("#idz_msgmsg").css("left"),e=r("#idz_msgmsg").css("top"),i=r("#idz_msgmsg").get(0).value;if(1===n.chat.satisfaction){var o=parseInt(r("#idzq1").attr("rel"),10)+1+"|";o=(o=o+(parseInt(r("#idzq2").attr("rel"),10)+1)+"|")+(parseInt(r("#idzq3").attr("rel"),10)+1)+"|",i===n.T("VOTRE_COMMENTAIRE_LIBRE")&&(i=""),o+=i;var a=n.chat.history_id||n.chat.prev_history;return n.util.addScript("satisfaction",n.chaturl+"rpc/satisfaction.php?save="+n.website_id+"&u="+n.vuid+"&hid="+a+"&data="+encodeURIComponent(o)),n.chat.sendAlert("!satisfaction completed",n.T("SATISFACTION_REPONDU")),n.Templates.removeSatisfaction(),r("#idz_msgmsg").val("").change(),n.chat.composing=0,n.callbacks.onSatisfactionAnswered(),!1}if(""===i||i===n.T("POSER_VOTRE_QUESTION_ICI")||i===n.T("POSER_VOTRE_QUESTION_ICI_UN_CONSEILLER_VOUS_REPONDRA")||i===n.customize["chatbar_txt2_"+n.curlang])return setTimeout(function(){r("#idz_msgmsg").css({left:parseInt(t,10)+"px",top:parseInt(e,10)+"px"})},1030),!1;if(r("#idz_msgmsg").val("").change(),n.operator.barejid&&(1!==n.on_call&&1===n.opOffline||n.blocked)&&2!==n.chat.status){var s=n.chat.getVmsg(i);return n.Templates.showDialog(),n.chat.put_dialog(s),n.chat.disableLoading(),setTimeout(function(){n.chat.putOpMsg(null,n.autoAnswer,0,1),n.setStatus()},300),!1}if(n.blocked||!i)return!1;var c=g.connect().fail(n.chat.showConnectionError);if(n.operator.barejid||1===n.chat.satisfaction)c.done(function(){n.chat.onSendMessage(i)});else{var u=function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t)}(),l=g.getConnection().getUniqueId();n.chat.enableLoading(),c.then(function(){return n.createConversation("chat",i,u,null,l)}).then(function(){if(n.routing.enabled){var t=n.$.Deferred();return n.operator.barejid||(n.operator.barejid="i_will_be_back"),t.resolve(l),t.promise()}return g.room.groupchat(i,l),n.util.retry(4,n.chat.onSendFirstMessage,n.chat,[i,l])}).done(function(t){d(),n.chat.putVmsg(i,t,u),!0===n.operator.isExpert&&n.chat.putOpAlert(n.chat.getExpertDisclaimer())}).fail(function(){n.chat.put_dialog(n.chat.getVmsg(n.util.nl2br(n.util.htmlspecialchars(i)))),n.chat.showUnavailableMessage(),n.chat.disableLoading()})}}catch(t){n.errorMailer("bindSendMessage: ",t,"")}return!1}})},enableLoading:function(){r("#idz_msgmsg").attr("disabled","disabled"),r(".idz_loading").show()},disableLoading:function(){r("#idz_msgmsg").attr("disabled",!1),r(".idz_loading").hide()},showUnavailableMessage:function(){n.chat.putOpMsg(null,n.autoAnswer,0,1),n.chat.status=1,n.operator={}},sendProactifAlert:function(){n.flags.proactif_alert&&""!=n.flags.proactif_alert&&n.chat.sendAlert(n.flags.proactif_alert,n.flags.message,!0)},onSendFirstMessage:function(t,e){var i=r.Deferred();return n.chat.dialogCount(),n.Templates.showDialog(),g.invitation.sendEngage(e,t,n.conversationJid,n.operator.barejid,n.website_id,n.chat.history_id).then(function(t){n.chat.sendProactifAlert(),n.chat.sendProfile(n.operator.barejid,n.vStats.getProfile()),i.resolve(t)},i.reject),setTimeout(i.reject,4e3),n.proactif_now=0,i.promise()},onSendMessage:function(t){if("1"===n.preferences.bankcard_number_hidden&&(t=o(t)),t){n.Templates.showDialog();var e=g.getConnection().getUniqueId();n.chat.sendMessage(t,e).fail(function(){}),n.chat.putVmsg(t,e),n.proactif_now=0}},dialogCount:function(){n.flags.proactif_activatedId&&!n.flags.proactif_dialogIsCounted&&(n.flags.proactif_dialogIsCounted=!0,setTimeout(function(){n.util.addScript("proactifDialogcount",n.chaturl+"rpc/proactif_dialogCount.php?inc="+n.flags.proactif_activatedId+"&sid="+n.website_id+"&u="+n.vuid+"&hid="+n.chat.history_id)},1650))},updateHistory:function(t,e,r,i){if(e){r=r||0;var o=n&&n.vStats?n.vStats.browserInfo+" | "+n.vStats.country:"";i||(i=""),n.util.addScript("IDZhistory",n.chaturl+"rpc/chat_history.php?sid="+n.website_id+"&update="+n.chat.history_id+"&u="+n.vuid+"&oid="+n.operator.id+"&data="+encodeURIComponent(e)+"&type="+t+"&id="+r+"&nick="+Strophe.getNodeFromJid(g.getConnection().jid)+"&userData="+o+"&log_uuid="+i)}},reloadHistory:function(){n.chat.buildChat(),setTimeout(function(){var t=n.chat.history_id||n.chat.prev_history,e=h();n.util.addScript("IDZRhistory",n.chaturl+"rpc/chat_history.php?reload="+t+"&u="+n.vuid),r("#idz_button_print").attr("href",n.chaturl+"gethistory.php?id="+t+"&u="+n.vuid),r("#idz_button_mail").attr("href",n.chaturl+"gethistory_mail.php?id="+t+"&u="+n.vuid+"&timezoneAbbr="+e)},400)},convertLinks:function(t,e){var n="";return e&&(n="target=_blank "),t.replace(/((ftp|https?):\/\/([-\w\.]+)+(:\d+)?(\/([\w/_\.\(\)\-,\#\~\%\=\+&;:]*(\?\S+)?)?)?)/gm,"<a "+n+'rel="nofollow" href="$1">$1</a>')},getVmsg:function(e,r){var i=r!=t?r:n.chat.getMsgTime();return e=n.chat.convertLinks(e,!0),e=y.replaceAliasesToShortname(e),e=y.replaceUtf8ToShortname("apple",e),e=y.replaceShortnameToImage("apple",e),n.Templates.vMsg.replace(/\{MSG\}/g,e).replace(/\{TIME\}/g,i)},putVmsg:function(t,e,r){e=e||0;var i=n.util.nl2br(n.util.htmlspecialchars(t));n.chat.put_dialog(n.chat.getVmsg(i),e),t=y.replaceShortnameToUtf8("apple",t),n.chat.updateHistory(n.chat.MESSAGE_TYPES.VISITOR,t,e,r),n.chat.disableLoading(),n.Templates.showDialog(),n.Templates.maximizeChatbar(),n.callbacks.onVisitorStopWriting(),n.callbacks.onMessageSent({time:n.chat.getMsgTime(),msg:i})},getOpAlert:function(e,r){var i=r!=t?r:n.chat.getMsgTime();return e=n.util.nl2br(n.util.htmlspecialchars(e)),e=e.replace(/&lt;br \/&gt;/gi,"<br/>").replace(/&lt;br\/&gt;/gi,"<br/>").replace(/&lt;br&gt;/gi,"<br/>"),n.Templates.opAlert.replace(/\{MSG\}/g,e).replace(/\{TIME\}/g,i)},putOpAlert:function(t,e){n.Templates.showDialog(),n.Templates.maximizeChatbar(),n.chat.put_dialog(n.chat.getOpAlert(t)),e&&1===e&&n.chat.updateHistory(n.chat.MESSAGE_TYPES.OPERATOR_ALERT,t),n.callbacks.onAlertReceived({time:n.chat.getMsgTime(),msg:t})},getOperatorAvatarUrl:function(){var t=n.static_url+"images/livechat/blank.gif";return n.operator.avatar&&(t=n.operator.avatar),t},getOpMsg:function(e,i){var o=i!=t?i:n.chat.getMsgTime(),a=n.chat.getOperatorAvatarUrl(),s="";if(n.operator.pseudo){s=n.util.htmlspecialchars(n.operator.pseudo);var c="";n.operator.isExpert&&(c=" "+iAdvize.T("SEE_MORE")),s=s+'<span class="idz_colonspace">'+c+"</span> : "}-1===e.indexOf(n.autoAnswer)&&(e=-1===e.indexOf(n.website_url)?n.chat.convertLinks(e,!0):n.chat.convertLinks(e,!1)),e=e.replace(/&lt;br \/&gt;/gi,"<br/>").replace(/&lt;br\/&gt;/gi,"<br/>").replace(/&lt;br&gt;/gi,"<br/>"),e=y.replaceUtf8ToImage("apple",e);var u=n.Templates.opMsg.replace(/\{PSEUDO\}/g,s).replace(/\{AVATAR\}/g,a).replace(/\{MSG\}/g,e).replace(/\{TIME\}/g,o);if(n.operator.direct_phone&&""!=n.operator.direct_phone&&0===n.phoneDisplayed){n.phoneDisplayed=1;var l=n.Templates.opMsgFooter.replace(/\{PHONE_PRICE\}/g,n.operator.phone_facturation).replace(/\{PHONE_NUMBER\}/g,n.operator.direct_phone);u=u.replace(/\{FOOTER\}/g,l)}else u=u.replace(/\{FOOTER\}/g,"");return n.operator.id&&(_.emit("events.operatorMessageSent",n.operator),u=r(u).attr("data-operatorid",n.operator.id)[0].outerHTML),u},tagAutomatedMessages:function(t,e){e==n.chat.automatedStartMessageId&&t.find(".idz_msgtext:last, .idz_msgtime:last").addClass("idz_automatedMessage idz_automatedStartMessage"),e==n.chat.automatedEndMessageId&&t.find(".idz_msgtext:last, .idz_msgtime:last").addClass("idz_automatedMessage idz_automatedEndMessage")},putOpFile:function(t,e){r('.idz_upload[data-id="'+t+'"]').remove(),e.find("img").on("load",function(){n.Templates.scrollChatBoxDialog()}),n.Templates.showDialog(),n.Templates.maximizeChatbar(),n.chat.put_dialog(e),n.Templates.scrollChatBoxDialog()},putOpProduct:function(t,e){e.find("img").on("load",function(){n.Templates.scrollChatBoxDialog()}),n.Templates.showDialog(),n.Templates.maximizeChatbar(),n.chat.put_dialog(e),n.Templates.scrollChatBoxDialog()},putOpMessageWithMultipleChoices:function(t,e,i){i?i.append(e):(n.Templates.showDialog(),n.Templates.maximizeChatbar(),r("#idz_dialogbox #idz_dialogbox_bottom").before(e),n.Templates.scrollChatBoxDialog()),e.find(".idz_choice_button").on("click",function(t){t.preventDefault();var e=r(this),i=e.parents("#hist_container").length>0,o=i&&r("#hist_container").is(":nth-last-child(2)"),a=e.parents(".idz_msg_operator").is(":nth-last-child(2)");o||!i&&a?n.chat.onSendMessage(t.target.innerText):e.off(t)})},putOpMsg:function(t,e,i,o){var a="";if(a=o?n.util.nl2br(e):n.util.nl2br(n.util.htmlspecialchars(e)),!f(t)){n.Templates.showDialog(),n.Templates.maximizeChatbar();var s=n.chat.getOpMsg(a);n.chat.put_dialog(s),_.emit("events.operatorMessageAppended",n.operator),null!=t&&r("#idz_dialogbox").find(".idz_msgtext:last").attr({id:t}),n.chat.tagAutomatedMessages(r("#idz_dialogbox"),t),1===i?n.chat.updateHistory(n.chat.MESSAGE_TYPES.OPERATOR,e,t):2===i&&setTimeout(function(){n.chat.updateHistory(n.chat.MESSAGE_TYPES.OPERATOR,e,t)},2200),n.callbacks.onMessageReceived({time:n.chat.getMsgTime(),msg:e})}},onCommand:function(e){var o=e.body,a=e.from,s=e.barejid,c=e.getCommand(),u=function(){var t=n.operator.barejid;return null===t||T(t,s)},l=c.name,f=c.param1,h=c.param2;if(""===n.iframeID){if("routing_operator_found"===l){var m=function(){if(!n.operator.id){if(n.routing.enabled&&!n.activeCall&&(0===n.chat.history_id||0===n.vStats.history_id||!n.conversationJid))return n.errorMailer("Routing operator found with invalid states",new Error("invalid routing states"),"",{historyId:n.chat.history_id,vStatsHistoryId:n.vStats.history_id,jid:n.conversationJid,profile:e,operator:n.operator}),n.chat.putOpMsg(null,n.T("AN_ERROR_OCCURED_PLEASE_RETRY"),0,1),void n.chat.disableLoading();var t=o.substr(o.indexOf(" ")+1),e=JSON.parse(t);n.operator=e,!0===n.operator.isExpert&&n.chat.putOpAlert(n.chat.getExpertDisclaimer()),n.activeCall?w&&w.Service.onCallOperator(e.barejid):(n.logMailer("conversations.routing.operator.found","Routing operator found",{vuid:iAdvize.vuid,barejid:e.barejid}),g.invitation.sendEngage(null,e.message,n.conversationJid,n.operator.barejid,n.website_id,n.chat.history_id).then(n.chat.sendProactifAlert),n.chat.sendProfile(e.barejid,n.vStats.getProfile()),_.emit("events.chatBuilt",null))}};switch(!0){case n.activeCall!==t:m();break;case"1"==n.flags.visio_status:var v=o.substr(o.indexOf(" ")+1),y=JSON.parse(v);_.emit(b.OnConversationVisioRoutingDone,y);break;default:p.then(m)}}if("vprofile"===l&&n.chat.sendProfile(a,n.vStats.getProfile()),"windowsize"===l&&n.chat.sendCommand(a,"!windowsize "+r(window).width()+"|"+r(window).height()),"getcook"===l&&n.chat.sendCookie(a),"customdata"===l&&n.chat.sendCustomData(a),"visio"===l&&("refused"===f?_.emit(b.OnConversationVisioRefused):"timeout"===f?_.emit(b.OnConversationVisioTimeout):"close"===f&&_.emit(b.OnConversationVisioClose)),u()&&"push"===l){var C="";f=n.util.nl2br(n.util.htmlspecialchars(f)),h=n.util.nl2br(n.util.htmlspecialchars(h)),n.chat.updateHistory(n.chat.MESSAGE_TYPES.OPERATOR_ALERT,"PUSH "+f+" "+h),n.callbacks.onLinkReceived({name:h,url:f,push:!0}),-1===f.indexOf(n.website_url)?C=" target='_blank'":setTimeout(function(){window.parent.location.href=f},800);var x=n.Templates.putLinkItem(f,h,C);O()?n.chat.put_dialog(x):n.chat.putOpAlert(n.T("OPERATEUR_PUSHLINK"))}if("blockme"===l&&(2===n.chat.status?(n.chat.put_dialog(n.Templates.opAlert.replace(/\{MSG\}/g,n.T("OPERATEUR_DECONNECTION")).replace(/\{TIME\}/g,n.chat.getMsgTime())),n.blocked=!0):n.Templates.hideUI()),u()&&"links"===l&&(C="",f=n.util.nl2br(n.util.htmlspecialchars(decodeURIComponent(f))),h=n.util.nl2br(n.util.htmlspecialchars(h)),n.chat.updateHistory(n.chat.MESSAGE_TYPES.OPERATOR_ALERT,"LINKS "+f+" "+h),-1===f.indexOf(n.website_url)&&(C=" target='_blank'"),x=n.Templates.putLinkItem(f,h,C),O()?n.chat.put_dialog(x):n.chat.putOpAlert(n.T("OPERATEUR_SENDLINK")),n.callbacks.onLinkReceived({name:h,url:f,push:!1})),u()&&"offers"===l){C="",n.chat.updateHistory(n.chat.MESSAGE_TYPES.OPERATOR_ALERT,"OFFERS "+n.util.htmlspecialchars(f)+" "+n.util.htmlspecialchars(h)),-1===f.indexOf(n.website_url)&&(C=" target='_blank'");E=n.Templates.putOfferItem(n.util.htmlspecialchars(f),n.util.htmlspecialchars(h),C);O()?n.chat.put_dialog(E):n.chat.putOpAlert(n.T("OPERATEUR_SENDOFFER")),n.callbacks.onOfferReceived({name:h.split("|")[0],url:f})}if(u()&&"pushoffer"===l){C="",n.chat.updateHistory(n.chat.MESSAGE_TYPES.OPERATOR_ALERT,"OFFERS "+n.util.htmlspecialchars(f)+" "+n.util.htmlspecialchars(h)),-1===f.indexOf(n.website_url)?C=" target='_blank'":setTimeout(function(){window.parent.location.href=f},800);var E=n.Templates.putOfferItem(n.util.htmlspecialchars(f),n.util.htmlspecialchars(h),C);O()?n.chat.put_dialog(E):n.chat.putOpAlert(n.T("OPERATEUR_PUSHOFFER"))}if(u()&&"closedialog"===l){if(2===n.chat.status){r("#idz_msgmsg, #idz_postmsg").prop("disabled",!0),n.flags.visio_status&&_.emit(b.OnConversationVisioClosed),n.chat.putOpAlert(n.T("FIN_DISCUSSION")),n.callbacks.onChatEnded({id:n.chat.history_id,endedBy:"operator"}),delete n.operator.barejid;var A=4e3;iAdvize.REDOUTE&&(A=8e3),169===n.client_id&&(A=1e4),setTimeout(function(){r("#idz_msgmsg, #idz_postmsg").prop("disabled",!1),-1===n.operator.id||1===n.virtualOP||"1"!=n.preferences.param_satisfaction||0!==n.chat.satisfaction||n.blocked?n.Templates.hideDialog():(n.chat.satisfaction=1,n.Templates.displaySatisfaction(),n.callbacks.onSatisfactionDisplayed())},A)}n.flags.popup_mode&&delete n.flags.popup_mode,n.chat.EndOfChat()}if("nomoreslot"===l||"routing_operator_not_found"===l){if(n.routing.enabled&&!n.operator.barejid)return;n.routing.enabled&&n.logMailer("conversations.routing.operator.nomoreslot","Routing operator unavailable",{vuid:iAdvize.vuid,barejid:n.operator.id,history_id:n.chat.history_id}),n.chat.putOpMsg(null,n.T("BONJOUR_NOTRE_SERVICE_CLIENT_EST_ACTUELLEMENT_FERME"),0,1),n.util.addScript("IDZhistory",n.chaturl+"rpc/chat_history.php?sid="+n.website_id+"&missed="+n.chat.history_id+"&oid="+n.operator.id+"&u="+n.vuid),n.opOffline=1,n.chat.status=1,n.operator={}}if("showinvit"===l&&n.chat.loadInvitation(f),"c2c"===l){if(clearTimeout(n.c2cTimeout),"opanswered"===f){var I=r(e.raw).attr("conversationJid");g.room.join(I,n.vuid),n.conversationJid=I,n.callbacks.onCallStarted(),1===n.preferences.c2c_callvisitorfirst?r(".c2cpopin_label").html('<div class="c2cpopin_label_phone"></div>'+n.T("NOUS_VOUS_RAPPELLONS_GRATUITEMENT_TXT2")):r(".c2cpopin_label").html('<div class="c2cpopin_label_phone"></div>'+n.T("NOUS_VOUS_RAPPELLONS_GRATUITEMENT_TXT3")),1!==n.preferences.call_offline_enabled&&(n.on_call=1),n.opOffline=0,n.chat.status=2,n.chat.history_id=h,n.vStats.history_id=h,n.chat.dialogCount(),n.setStatus(),n.operator=n.c2coperator,T(n.c2coperator.barejid,s)||(n.c2coperator.barejid=s,n.operator.barejid=s,n.util.addScript("getop",n.chaturl+"rpc/getop.php?sid="+n.website_id+"&u="+n.vuid+"&getop="+s)),n.flags.proactif_alert&&""!=n.flags.proactif_alert&&n.chat.sendAlert(n.flags.proactif_alert,n.flags.message,!0),n.c2cTimeout=setTimeout(function(){r("#c2cpopin_step2").hide(),r("#c2cpopin_step1").show(),n.chat.closeC2cPopin()},1e4)}else"start"===f?(r(".c2cpopin_label").html('<div class="c2cpopin_label_phone"></div>'+n.T("NOUS_VOUS_RAPPELLONS_GRATUITEMENT_TXT3")),n.chat.dialogCount(),1!==n.preferences.call_offline_enabled&&(n.on_call=1),n.opOffline=0,n.chat.status=2,n.chat.history_id=h,setTimeout(function(){r("#c2cpopin_step2").hide(),r("#c2cpopin_step1").show(),n.chat.closeC2cPopin()},7e3)):"stop"===f?(g.room.leave(n.conversationJid,n.vuid),n.callbacks.onCallEnded(),r(".c2cpopin_label").html('<div class="c2cpopin_label_phone"></div>'+n.T("NOUS_VOUS_RAPPELLONS_GRATUITEMENT_TXT1")),n.on_call=0,n.chat.status=3,n.chatbox_state=n.chat.CHATBAR_HIDDEN,n.activeCall=null,setTimeout(function(){r("#c2cpopin_step2").hide(),r("#c2cpopin_step1").show(),n.chat.closeC2cPopin()},7e3),"1"==n.preferences.param_satisfaction&&0==n.chat.satisfaction&&(n.chat.buildChat(),n.chat.satisfaction=1,n.Templates.displaySatisfaction(),n.callbacks.onSatisfactionDisplayed())):"redial"==f?w&&w.Service.onMakeCall():"error"==f&&(n.chat.showC2cError(n.T(h.trim())),n.on_call=0,n.chat.status=1);n.JSONStore.saveData({on_call:n.on_call,chat_status:n.chat.status,history_id:n.chat.history_id,chatbox_state:n.chatbox_state})}if("init_cobro"===l&&S){if(!S.init)return!0;S.init().done(function(){n.operator.barejid&&n.chat.sendCommand(n.operator.barejid,"!cobro_init")})}}if("magic_event"===l){if(!S)return!0;if(!S.isReceiver||!S.changeState)return n.errorMailer("Mirroring magic_event error: Defined Mirror but undefined methods",{object:S,type:void 0===S?"undefined":i(S),browser:window.navigator.userAgent,url:window.location.href},""),!0;"sender"==f||"disabled"==f||"receiver"==f?("sender"==f&&S.isReceiver()&&(r("#op_cursor").animate({top:"-3000px",left:"-3000px"},150),""==n.iframeID&&(n.Templates.showDialog(),n.chat.cobrowsing=0,n.JSONStore.saveData({chat_cobrowsing:n.chat.cobrowsing}),n.chat.putOpAlert(n.T("COBROWSING_STOP")),n.chat.updateHistory(n.chat.MESSAGE_TYPES.OPERATOR_ALERT,"COBROWSING_STOP"),n.callbacks.onCobrowsingStopped())),"sender"!=f||n.operator.barejid||(n.monitor_jid=s),"disabled"==f&&2!=n.chat.status&&delete n.monitor_jid,S.changeState(f)):"receiver_request"==f&&""==n.iframeID&&(n.chat.buildChat(),n.Templates.showDialog(),n.Templates.maximizeChatbar(),n.chat.put_dialog(n.Templates.askCobrowsing.replace(/\{TIME\}/g,n.chat.getMsgTime())),n.chat.updateHistory(n.chat.MESSAGE_TYPES.OPERATOR_ALERT,"COBROWSING_ASK"),r('[id="idz_cobrowsing_accept"]').bind("click",function(t){return n.chat.addCobrowsingImg(),r(t.target).closest(".idz_msg_alert_op").remove(),n.chat.put_dialog(n.Templates.opAlert.replace(/\{MSG\}/g,n.T("COBROWSING_ACCEPT")).replace(/\{TIME\}/g,n.chat.getMsgTime())),S.state("receiver"),n.chat.updateHistory(n.chat.MESSAGE_TYPES.OPERATOR_ALERT,"COBROWSING_ACCEPT"),n.chat.sendCommand(n.operator.barejid,"!magic_event receiver_accept"),"numericable"==n.customize.layout||n.flags.streamId||(n.Templates.hideDialog(),n.chatbar_state=1,n.JSONStore.saveData({chatbar_state:n.chatbar_state})),n.chat.cobrowsing=1,n.JSONStore.saveData({chat_cobrowsing:n.chat.cobrowsing}),n.callbacks.onCobrowsingAccepted(),!1}),r('[id="idz_cobrowsing_refuse"]').bind("click",function(t){return r(t.target).closest(".idz_msg_alert_op").remove(),n.chat.put_dialog(n.Templates.opAlert.replace(/\{MSG\}/g,n.T("COBROWSING_REFUSE")).replace(/\{TIME\}/g,n.chat.getMsgTime())),n.chat.updateHistory(n.chat.MESSAGE_TYPES.OPERATOR_ALERT,"COBROWSING_REFUSE"),n.chat.sendCommand(n.operator.barejid,"!magic_event receiver_refuse"),n.callbacks.onCobrowsingRefused(),!1}),n.callbacks.onCobrowsingRequested())}"change_page"===l&&(document.location.href=decodeURIComponent(f)),"ackEngage"===l&&(n.routing.enabled&&n.logMailer("conversations.routing.operator.engage.acknowledge","Routing acknowledge received",{vuid:iAdvize.vuid,barejid:iAdvize.operator.barejid,historyId:n.chat.history_id}),2!==n.chat.status&&d(),n.chat.status=2,n.operator.barejid=s)},onChatStates:function(t,e){try{T(n.operator.pseudo,t)&&""===n.iframeID&&("composing"===e?(r(".idz_writting").html(n.T("OPERATEUR_COMPOSING")),n.callbacks.onOperatorWriting()):(r(".idz_writting").html(" "),n.callbacks.onOperatorStopWriting()))}catch(t){n.PROD?n.errorMailer("onChatState: ",t,e):console&&console.debug&&console.debug("[Erreur][onChatStates]",t.message,e)}},onMessage:function(t){var e=t.body,i=t.id,o=t.from,a=t.barejid;if(!function(t){return Strophe.getResourceFromJid(t)===n.vuid}(o)&&""==n.iframeID){if(n.opBusy=0,!function(){var t=n.conversationJid;return null===t||T(t,a)}())return n.chat.sendCommand(a,"!chatting"),r(".idz_writting").html(" "),!0;if(n.operator.barejid||(n.operator.barejid=a),n.chat.putOpMsg(i,e,1),setTimeout(function(){r(".idz_writting").html(" ")},350),n.chat.status=2,n.chatbox_state=n.chat.OPENED,n.virtualOP=0,n.blink_title(),"1"==n.customize.sound_alert){n.playSound("message")}}},onMessageReceipt:function(t){try{if(t.isCommand()){var e=t.getCommand();"transfer"===e.name&&n.transfer(e.param1)}}catch(e){n.PROD?n.errorMailer("onReceipt: ",e,t):console&&console.debug&&console.debug("[Erreur][onMessageReceipt]",e.message,t)}return!0},EndOfChat:function(){n.chat.status=3,(0==n.chat.prev_history||isNaN(n.chat.prev_history)||n.chat.history_id>n.chat.prev_history)&&(n.chat.prev_history=n.chat.history_id),n.chat.history_id=0,n.chatbox_state=n.chat.CHATBOX_STATES.CHATBAR_HIDDEN,n.JSONStore.save({chat_status:n.chat.status,chatbox_state:n.chatbox_state,chatbar_state:n.chatbar_state}),n.operator={},g.getConnection().connected&&(g.room.leave(n.conversationJid,n.vuid),n.chat.sendPresence("available"))},showConnectionError:function(){(r("#idz_chatglobal").is(":visible")||2==n.chat.status)&&(r(".idz_writting").html(""),n.chat.putOpAlert(n.T("CONNECTION_ERREUR")),n.chat.disableLoading(),r("#idz_msgmsg, #idz_postmsg").prop("disabled",!0))},sendMessage:function(t,e){var i=r.Deferred();try{if(!t||""===t)return i.reject("desk.publish.error.empty"),i.promise();if(n.blocked)return i.reject("desk.publish.error.blocked"),i.promise();3==n.chat.status&&n.chat.history_id>0&&n.chat.sendPresence("dnd"),n.chat.status=2,n.chatbox_state=n.chat.CHATBOX_STATES.OPENED,n.chatbar_state=0,g.room.groupchat(t,e).done(function(t){i.resolve(t)}).fail(n.chat.onRetrySendMessage)}catch(t){return i.reject("desk.publish.error.unknown",t)}return i.promise()},onRetrySendMessage:function(t,e,r){r&&r.done(function(t){}).fail(n.chat.onRetrySendMessage)},sendChatClose:function(){var t=n.chat.sendAlert("!chatclose",n.T("VISITOR_CHATBOX_CLOSE"));1!=n.chat.status&&(n.chat.status=3,n.chat.sendPresence("available"),n.JSONStore.saveData({chat_status:n.chat.status,visitor_closed:1}),n.chat.updateHistory(n.chat.MESSAGE_TYPES.OPERATOR_ALERT,"VISITOR_CHAT_CLOSE",t))},sendAlert:function(t,e,r){try{if(1==n.virtualOP)return;var i=(new Date).getTime();if(2==n.chat.status||r){var o=$msg({to:n.operator.barejid,from:g.getConnection().jid,type:"chat",id:i,website:n.website_id}).c("body").t(t);return g.getConnection().send(o),i}}catch(r){n.errorMailer("sendAlert: ",r,t+"\n\n"+e)}},sendPresence:function(t){var e={site:n.website_id,opid:n.operator.id,frameid:n.iframeID};n.chat.history_id&&(e.history=n.chat.history_id),"unavailable"==t?g.getConnection().send($pres({type:"unavailable"})):"available"==t?g.getConnection().send($pres(e).c("status").t(location.href)):"away"!=t&&"dnd"!=t||g.getConnection().send($pres(e).c("show").t(t).up().c("status").t(location.href))},sendCommand:function(t,e){if(g.isOnline(t)){var r=(new Date).getTime();g.getConnection().send($msg({id:r,to:t+"/operators",from:g.getConnection().jid,type:"command",website:n.website_id}).c("body").t(e))}},sendProfile:function(t,e){g.getConnection().send($msg({to:t,from:g.getConnection().jid,type:"command",website:n.website_id}).c("body").t("!vprofile "+e))},sendCookie:n.util.runOnce(1500,function(t){var e="!getcook "+n.chat.cCook;g.getConnection().send($msg({to:t[0],from:g.getConnection().jid,type:"command",website:n.website_id}).c("body").t(e))}),sendCustomData:function(t){var e="!customdata "+n.vStats.customData();g.getConnection().send($msg({to:t,from:g.getConnection().jid,type:"command",website:n.website_id}).c("body").t(e))},getMsgTime:function(){var t=new Date,e=t.getHours(),n=t.getMinutes();return n<10&&(n="0"+n),e+":"+n},put_dialog:function(t,e){var i=r(t);i.find(".idz_msgtext").attr("data-id",e);var o=i.attr("class"),a=r("#idz_dialogbox_bottom"),s=a.prev("div").attr("class"),c=a.prev("div").find(".idz_msgtime:last").html();if("idz_msg_operator"!=o&&"idz_msg_visitor"!=o||o!=s)r("#idz_dialogbox #idz_dialogbox_bottom").before(t);else{var u=i.find(".idz_msgtext"),l=i.find(".idz_msgtime");c==l.html()&&(l=""),a.prev("div").find(".idz_msgtext:last").after(u).after(l),"idz_msg_operator"==o&&r(".idz_opename:last").remove()}n.Templates.scrollChatBoxDialog()},getLocalTime:function(t){var e=6e4*(new Date).getTimezoneOffset(),n=new Date,r=new Date(n.getTime()+e);r.setHours(t.split(":")[0]),r.setMinutes(t.split(":")[1]);var i=new Date(r.getTime()-e),o=i.getHours(),a=i.getMinutes();return a<10&&(a="0"+a),o+":"+a},prepare_history:function(t){try{t=JSON.parse("["+t+"]")}catch(e){return void n.errorMailer("prepare_history JSON.parse: ",e,t)}var e=r("<div id='hist_container'></div>"),i="",o="",a="",s="",c="",u=!0,l=!1,d="",h="",p="",g=0;m.forEach(t,function(t){var r={type:t[0],time:t[1],content:t[2],id:t[3]};if(f(r.id))return!0;if(h=n.util.htmlSimpleEscape(r.content),h=h.replace(/&lt;br \/&gt;/gi,"<br/>").replace(/&lt;br\/&gt;/gi,"<br/>").replace(/&lt;br&gt;/gi,"<br/>"),g!=r.type||r.type!=n.chat.MESSAGE_TYPES.OPERATOR&&r.type!=n.chat.MESSAGE_TYPES.VISITOR?r.type==n.chat.MESSAGE_TYPES.OPERATOR?e.append(n.chat.getOpMsg(h,r.time)):r.type==n.chat.MESSAGE_TYPES.VISITOR&&e.append(n.chat.getVmsg(h,r.time)):(d=p==r.time?"":"<div class='idz_msgtime'>"+r.time+"</div>",h=y.replaceUtf8ToImage("apple",h),h=n.chat.convertLinks(h,!0),e.find(".idz_msgtext:last").after("<div class='idz_msgtext'>"+h+"</div>").after(d)),n.chat.tagAutomatedMessages(e,r.id),g=r.type,p=r.time,r.type==n.chat.MESSAGE_TYPES.VISITOR&&u&&(u=!1,!0===n.operator.isExpert&&(e.append(n.chat.getOpAlert(n.chat.getExpertDisclaimer(),p)),g=n.chat.MESSAGE_TYPES.OPERATOR_ALERT,l=!0)),r.type==n.chat.MESSAGE_TYPES.OPERATOR_ALERT){if(i=r.content,"LINKS"===(o=i.split(" ")[0])||"PUSH"===o){a=i.split(" ")[1],s=i.substr(a.length+o.length+2),-1==a.indexOf(n.website_url,0)&&(c=" target='_blank'");var m=n.Templates.putLinkItem(a,s,c);O()?e.append(m):("LINKS"===o&&e.append(n.chat.getOpAlert(n.T("OPERATEUR_SENDLINK"),r.time)),"PUSH"===o&&e.append(n.chat.getOpAlert(n.T("OPERATEUR_PUSHLINK"),r.time)))}if("OFFERS"===o){a=i.split(" ")[1],s=i.substr(a.length+o.length+2),-1===a.indexOf(n.website_url)&&(c=" target='_blank'");var v=n.Templates.putOfferItem(a,s,c);O()?e.append(v):e.append(n.chat.getOpAlert(n.T("OPERATEUR_SENDOFFER"),r.time))}"VISIOCONF_ACCEPT"===o&&e.append(n.chat.getOpAlert(n.T("VISIOCONF_ACCEPT"),r.time)),"COBROWSING_ASK"===o&&e.append(n.chat.getOpAlert(n.T("COBROWSING_ASK_SHORT"),r.time)),"COBROWSING_ACCEPT"===o&&e.append(n.chat.getOpAlert(n.T("COBROWSING_ACCEPT"),r.time)),"COBROWSING_REFUSE"===o&&e.append(n.chat.getOpAlert(n.T("COBROWSING_REFUSE"),r.time)),"COBROWSING_STOP"===o&&e.append(n.chat.getOpAlert(n.T("COBROWSING_STOP"),r.time)),"CHAT_CLOSE"!==o&&"VISITOR_CHAT_CLOSE"!==o&&"OPERATOR_CHAT_CLOSE"!==o||e.append(n.chat.getOpAlert(n.T("FIN_DISCUSSION_SHORT"),r.time))}if(r.type==n.chat.MESSAGE_TYPES.OPERATOR&&x.push(r.id),r.type===n.chat.MESSAGE_TYPES.OPERATOR_RICH_CONTENT||r.type===n.chat.MESSAGE_TYPES.VISITOR_RICH_CONTENT)try{var w=JSON.parse(r.content),S=r.type===n.chat.MESSAGE_TYPES.OPERATOR_RICH_CONTENT?"operator":"visitor";_.emit(b.OnXmppOOBReceived,r.id,S,r.time,w.type,w.data.url,w.data,e)}catch(t){console.error(t)}}),!1===l&&!0===n.operator.isExpert&&e.append(n.chat.getOpAlert(n.chat.getExpertDisclaimer())),r("#idz_dialogbox #idz_dialogbox_bottom").before(e),_.emit("events.operatorMessageAppended",n.operator),r("#idz_dialogbox").find(".idz_msgtime").each(function(){r(this).text(n.chat.getLocalTime(r(this).text()))}),n.chatbox_state==n.chat.CHATBOX_STATES.OPENED&&n.chat.offercount>1&&(O()||n.Templates.showOfferPanel()),n.Templates.scrollChatBoxDialog(),n.Templates.scrollLinkDialog()},getExpertDisclaimer:function(){return n.T("chatbox.operatorAlert.expertDisclaimer").replace(/\{\{ company }}/g,n.website_label)}},n.blink_title=function(){1!==n.hasFocus&&(null!==n.blinktm&&(clearInterval(n.blinktm),n.blinktm=null),n.blinktm=setInterval(function(){r("title").html()===n.oTitle?document.title=n.T("NOUVEAU_MESSAGE"):document.title=n.oTitle},1500))},n.lastPreview=null,n.livePreview=window.setInterval(function(){if(n.chat&&2===n.chat.status&&n.operator&&n.operator.barejid){var t=r("#idz_msgmsg").val();if(n.lastPreview!=t&&t!=n.T("POSER_VOTRE_QUESTION_ICI")&&t!=n.T("POSER_VOTRE_QUESTION_ICI_UN_CONSEILLER_VOUS_REPONDRA")&&t!=n.customize["chatbar_txt2_"+n.curlang]){n.lastPreview=t,"1"===n.preferences.bankcard_number_hidden&&(t=o(t));var e=$msg({to:Strophe.getBareJidFromJid(n.operator.barejid)+"/operators",from:g.getConnection().jid,type:"command",website:n.website_id}).c("body").t("!preview "+t);g.getConnection().send(e)}}},2800),n.findOPDelayed=function(){return n.routing.enabled?0:setTimeout(function(){n.AvailableOp.find()},1500)},n.findOpCallback=function(t){var e=n.preferences.priority_channel;if("all"!=e&&0==t.opOffline&&0==t.c2cOffline&&("chat"==e&&(t.c2cOffline=1),"call"==e&&(t.opOffline=1)),n.opOffline=t.opOffline,n.c2cOffline=t.c2cOffline,n.callMeeting.available=!!t.callMeeting&&t.callMeeting.available,n.callMeeting.enabled=!!t.callMeeting&&t.callMeeting.enabled,n.callInstant.available=!!t.callInstant&&t.callInstant.available,n.callInstant.enabled=!!t.callInstant&&t.callInstant.enabled,n.callOffline.available=!!t.callOffline&&t.callOffline.available,n.callOffline.enabled=!!t.callOffline&&t.callOffline.enabled,n.c2vOffline=t.c2vOffline,void 0!==t.opBusy&&(n.opBusy=t.opBusy),setTimeout(function(){2!=n.chat.status&&(n.callbacks.onStatusChanged({offline:t.opOffline,busy:t.opBusy,c2cOffline:t.c2cOffline}),n.callbacks.onCallStatusChanged({offline:t.c2cOffline,chatOffline:t.opOffline}))},450),1==t.opOffline&&1==n.c2cOffline&&1==n.c2vOffline){try{n.setStatus(),!0===n.chat.connected&&S&&S.disable&&S.disable()}catch(t){}try{n.chat.status<2&&n.Templates.hideUI()}catch(t){}}else if(setTimeout(n.setStatus,300),1==t.opOffline)try{n.chat.status<2&&n.Templates.hideUI()}catch(t){}_.emit("targeting.poll.callback",t)},n.onActivity=function(){n.vStats.lastMove=(new Date).getTime(),null==n.vStats.activeSince&&(n.vStats.activeSince=(new Date).getTime())},n.setStatus=function(){if(n.flags.popup_mode&&!n.popout)return!0;n.floatingWidget&&n.floatingWidget.onPresenceChange(),n.SetOnline(),n.SetOffline(),n.OCallBack&&(1==n.opOffline&&1==n.c2cOffline||1==n.on_call?n.OCallBack.onOffline():n.OCallBack.onOnline());var t="";r(".idz_widget_v2").length&&(n.opOffline&&n.c2cOffline?0!=n.preferences.param_noconnectedwidget?r(".idz_widget_v2").hide():(r(".idz_widget_v2 .wtext1").html(" "),r(".idz_widget_v2 .wtext2").html(n.T("OPERATEURS_INDISPONIBLES_ENVOYER_EMAIL")),r(".idz_widget_v2 .wtext5").show()):(n.opOffline?r(".idz_chatwidget").hide():(t+="Nous vous assistons en direct par chat.",r(".idz_chatwidget").show()),n.opOffline||n.c2cOffline||(t+=" <span>OU</span> "),n.c2cOffline?(r(".idz_c2cwidget").hide(),n.chat&&n.chat.closeC2cPopin(),r("#call_button_online,.call_button_online").hide(),r("#call_button_offline,.call_button_offline").show()):(t+=n.T("NOUS_VOUS_RAPPELONS_GRATUITEMENT"),r(".idz_c2cwidget").show()),1==n.preferences.param_connectedwidget?r(".idz_widget_v2").hide():(r(".idz_widget_v2 .wtext1").html(n.T("PUIS_JE_VOUS_AIDER")),r(".idz_widget_v2 .wtext2").html(t),r(".idz_widget_v2").show()),r(".idz_widget_v2 .wtext5").hide()))},n.onChatButtonDisplay=function(){_.emit(b.chatButtonDisplayed),n.callButCB||(n.callbacks.onChatButtonDisplayed(),n.callButCB=!0)},n.onCallButtonDisplay=function(){_.emit(b.callButtonDisplayed),n.chatButCB||(n.callbacks.onCallButtonDisplayed(),n.chatButCB=!0)},n.onVisioButtonDisplay=function(){_.emit(b.videoButtonDisplayed),n.visioButCB||(n.callbacks.onVideoButtonDisplayed(),n.visioButCB=!0)},n.SetOnline=function(){1!=n.on_call&&(0==n.opOffline&&("1"==n.customize.chatbar_avatar&&(r("#idz_avatar_status").addClass("idz_online").removeClass("idz_offline").html(n.T("EN_LIGNE")),r("#idz_status_msg").html(n.T("NOS_CONSEILLERS_SONT_ACTUELLEMENT_A_VOTRE_DISPOSITION"))),r(".idz_widget").length&&r("#button_online").is(":hidden")&&(1!=n.preferences.param_connectedwidget?(r("#button_offline").hide(),r("#button_online").show(),n.onChatButtonDisplay()):(r("#button_offline").hide(),r("#button_online").hide()))),0==n.c2cOffline&&(r(".idz_c2cwidget").length&&(1!=n.preferences.param_c2c_connectedwidget?(r(".idz_c2cwidget").show(),n.onCallButtonDisplay()):r(".idz_c2cwidget").hide()),1!=n.preferences.param_c2c_connectedwidget?(r("#call_button_online,.call_button_online").show(),r("#call_button_offline,.call_button_online").hide()):(r("#call_button_online,.call_button_online").hide(),r("#call_button_offline,.call_button_offline").hide())),0==n.c2vOffline&&(r(".idz_c2vwidget").length&&(1!=n.preferences.param_visio_connectedwidget?(r(".idz_c2vwidget").show(),n.onVisioButtonDisplay()):r(".idz_c2vwidget").hide()),1!=n.preferences.param_visio_connectedwidget?(r("#visio_button_online,.visio_button_online").show(),r("#visio_button_offline,.visio_button_online").hide()):(r("#visio_button_online,.visio_button_online").hide(),r("#visio_button_offline,.visio_button_offline").hide())))},n.SetOffline=function(){1!=n.opOffline&&1!=n.on_call||("1"==n.customize.chatbar_avatar&&(r("#idz_avatar_status").addClass("idz_offline").removeClass("idz_online").html(n.T("HORS_LIGNE")),r("#idz_status_msg").html(n.T("BONJOUR_AUCUN_CONSEILLER_EST_DISPONIBLE_POUR_VOUS_REPONDRE"))),r(".idz_widget").length&&(r("#button_offline").length&&r("#button_offline").is(":hidden")?0==n.preferences.param_noconnectedwidget?(r("#button_offline").show(),r("#button_online").hide()):(r("#button_offline").hide(),r("#button_online").hide()):r("#button_online").hide()),r(".idz_chatwidget").length&&r(".idz_chatwidget").hide()),1==n.c2vOffline&&(r(".idz_c2vwidget").length&&r(".idz_c2vwidget").hide(),0==n.preferences.param_visio_noconnectedwidget?(r("#visio_button_offline,.visio_button_offline").show(),r("#visio_button_online,.visio_button_offline").hide()):(r("#visio_button_offline,.visio_button_offline").hide(),r("#visio_button_online,.visio_button_offline").hide()))},n.logMailer=v.info,n.errorMailer=v.error,void 0===n.Utils&&(n.Utils={}),n.Utils.errorMailer=n.errorMailer}}(iAdvize,iAdvize.$)},{lodash:35}],2:[function(t,e,n){iAdvize.define("livechat/call",function(t,e){iAdvize.$;var n=t("livechat/call/service"),r=t("livechat/call/view"),i=t("livechat/call/event");r.init({CallEvent:i}),i.init({CallView:r,CallService:n}),e.Service=n,e.View=r,e.Event=i})},{}],3:[function(t,e,n){iAdvize.define("livechat/call/event",function(t,e){function n(){return s.closeC2cPopin(),!1}function r(t){return t.stopPropagation(),l("#c2cpopin_flag_list").show(),!1}function i(){l("body").unbind("click.clickoutsideCountry"),l("#c2cpopin_flag_list").is(":visible")&&l("#c2cpopin_flag_list").fadeOut()}function o(){var t=u.Templates.buildC2cPopin,e=u.call.countries,n=l(this).attr("id");return s.updateSelectedCountryC2c(n,t,e),l("#c2cpopin_flag_list").is(":visible")&&l("#c2cpopin_flag_list").fadeOut(),!1}function a(){return l(this).hasClass("c2cpopin_phone_default")&&l(this).removeClass("c2cpopin_phone_default"),!1}var s,c,u=iAdvize,l=u.$,d=t("eventManager");e.init=function(t){s=t.CallView,c=t.CallService,d.on("call.popin.open",s.showC2cPopin)},e.bindEvents=function(t){t.find("#c2cpopin_close").click(n),t.find(".c2cpopin_call").off("click").click(c.onMakeCall),t.find("#c2cpopin_flag_selector").click(r),l("body").bind("click.clickoutsideCountry",i),t.find("#c2cpopin_flag_list li").click(o),t.find("#c2cpopin_phone").focus(a)}})},{}],4:[function(t,e,n){iAdvize.define("livechat/call/service",function(t,e){function n(t,e){if(!o.ringing){o.activeCall=t,o.ringing=!0;var n=void 0!==window.idzCustomData?idzCustomData:{};a.each(n,function(t,e){"city_cp"==t?n.city=e:"name_firstname"==t?n.name=e:"extID"==t&&(n.extid=e)});var r={customData:n},i=o.routing.enabled?"c2c_routing.php":"c2c.php";s.connect().done(function(){o.util.addScript("IDZc2cCall",o.chaturl+"rpc/"+i+"?sid="+o.website_id+"&oid="+o.c2coperator.id+"&vphone="+encodeURIComponent(t)+"&u="+o.vuid+"&visitorCountryCode="+e+"&visitorLocale="+o.visitor.locale+"&dep="+o.forceDep+"&vnick="+Strophe.getBareJidFromJid(s.getConnection().jid)+"&forcedLang="+o.forcedLang+"&"+a.param(r))})}}function r(t,e){a("#c2cpopin_step1").hide(),a("#c2cpopin_step2").show(),n(t,e)}function i(t,e){var n=o.call.countries[e];if(!n)throw new Error("Unknown country or not referenced in the countries list");if(n.number_pattern&&!new RegExp(n.number_pattern).test(t))throw new Error("The given phone number format is unknown");return parseInt(n.zero_prefixed,10)&&(t=t.substr(1)),"+"+n.calling_code+t}var o=iAdvize,a=o.$,s=t("xmpp"),c=t("eventManager");c.on("call.phone.format.validated",r),c.on("call.phone.callOperator",function(t,e,n){var r=void 0!==window.idzCustomData?idzCustomData:{};a.each(r,function(t,e){"city_cp"==t?r.city=e:"name_firstname"==t?r.name=e:"extID"==t&&(r.extid=e)});var i={customData:r};s.connect().done(function(){o.util.addScript("IDZc2cCall",o.chaturl+"rpc/c2c_routing_operator.php?sid="+o.website_id+"&operator="+t+"&vphone="+encodeURIComponent(e)+"&u="+o.vuid+"&visitorCountryCode="+n+"&visitorLocale="+o.visitor.locale+"&dep="+o.forceDep+"&vnick="+Strophe.getBareJidFromJid(s.getConnection().jid)+"&forcedLang="+o.forcedLang+"&"+a.param(i))})}),e.onMakeCall=function(){var t=a("#c2cpopin_phone").val(),e=a("#c2cpopin_flag_selector div").attr("rel");try{if(!t)throw new Error("No phone number provided");phoneNumber=i(t,e)}catch(t){return o.chat.showC2cError(o.T("INVALID_PHONE_NUMBER"))}return a("#c2cpopin_step1").removeClass("c2cpopin_error"),c.emit("call.phone.format.validated",phoneNumber,e),!1},e.onCallOperator=function(t){o.activeCall;var e=a("#c2cpopin_flag_selector div").attr("rel");return c.emit("call.phone.callOperator",t,phoneNumber,e),!1},e.onPhoneValidated=r,e.getInternationalPhoneNumberFormat=i})},{}],5:[function(t,e,n){iAdvize.define("livechat/call/view",function(t,e){function n(t,e){var n,i,o=[],a=[];for(n in t)i=t[n],o.push(r(i,e)),a.push(i);return u=a.shift(),"<ul>"+o.join("")+"</ul>"}function r(t,e){return e.replace(/{([\s\S]+?)}/g,function(e,n){return t[n]||""})}function i(t,e,r){var i,o,a=d(window).height();t?(i=n(e,r),o=l.Templates.buildC2cPopin(i)):o=l.Templates.c2cPopin;var s=d(o);return l.Templates.buildC2cPopin&&s.find("#c2cpopin_flag_list .flag").hide(),s.find("#c2coverlay").css({height:a}),s}function o(){var t=d(window).height();d("#c2coverlay").css({height:t}),d("#c2coverlay").show(),d("#c2cpopin").show()}function a(){d("#idzc2c").remove()}function s(t,e,n){var r,i=d("#c2cpopin_flag_selector div"),o=i.find("img"),a="";t&&"string"==typeof t&&(t=t.toLowerCase()),n[t]||n[t=l.curlang]||(t=u.country_code),i.removeClass().addClass("flag flag_"+t),i.attr({rel:t}),e&&(r=n[t].icon_path,i.css("background","none"),a=(o.data("basepath")||"")+r,o.attr("src",a))}var c,u,l=iAdvize,d=l.$,f=t("xmpp"),h=t("eventManager");e.init=function(t){c=t.CallEvent},e.updateSelectedCountryC2c=s,e.showC2cPopin=function(){var t,e=l.Templates.buildC2cPopin,n=l.call.countries,r=l.Templates.countryItemTemplate;if(l.ringing=!1,l.chat.connected||f.connect(),d("#c2cpopin").length>0)o();else{var a=i(e,n,r);c.bindEvents(a),a.appendTo("body")}l.visitor.country&&(t=l.visitor.country),s(t,e,n),l.callInstant.available||d("#c2cpopin_step1 .c2cpopin_call").hide(),h.emit("call.popin.open.after")},e.closeC2cPopin=function(){l.ringing=!1,a(),d("#c2coverlay").hide(),d("#c2cpopin").hide()},e.showC2cError=function(t){clearTimeout(l.c2cTimeout),this.showC2cPopin(),d("#c2cpopin_step2").hide(),d("#c2cpopin_step1").show(),d("#c2cpopin_step1").addClass("c2cpopin_error"),d(".c2cpopin_label_error").attr("style","").html(l.util.htmlspecialchars(t))},e.showC2cBusyMessage=function(t){this.showC2cPopin(),d("#c2cpopin_step2").hide(),d("#c2cpopin_step1").show(),d("#c2cpopin_step1").addClass("c2cpopin_error"),d(".c2cpopin_label_error").html(l.util.htmlspecialchars(t)).css("color","black")},e.resetC2cPopin=a})},{}],6:[function(t,e,n){"use strict";e.exports=t("./lib/emojisService.js")},{"./lib/emojisService.js":8}],7:[function(t,e,n){"use strict";e.exports={"<3":"heavy-black-heart","</3":"broken-heart",":)":"slightly-smiling-face","(:":"slightly-smiling-face",":-)":"slightly-smiling-face","C:":"grinning-face","c:":"grinning-face",":D":"grinning-face",":-D":"grinning-face",";)":"winking-face",";-)":"winking-face","):":"slightly-frowning-face",":(":"slightly-frowning-face",":-(":"slightly-frowning-face",":'(":"crying-face","=)":"smiling-face-with-open-mouth","=-)":"smiling-face-with-open-mouth",":*":"kissing-face",":-*":"kissing-face",":>":"grinning-face",":->":"grinning-face","8)":"smiling-face-with-sunglasses",":\\":"confused-face",":-\\":"confused-face",":/":"confused-face",":-/":"confused-face",":|":"neutral-face",":-|":"neutral-face",":O":"face-with-open-mouth",":-o":"face-with-open-mouth",">:(":"angry-face",">:-(":"angry-face",":-p":"face-with-stuck-out-tongue",":P":"face-with-stuck-out-tongue",":-P":"face-with-stuck-out-tongue",":-b":"face-with-stuck-out-tongue",";p":"face-with-stuck-out-tongue-and-winking-eye",";-p":"face-with-stuck-out-tongue-and-winking-eye",";b":"face-with-stuck-out-tongue-and-winking-eye",";-b":"face-with-stuck-out-tongue-and-winking-eye",";P":"face-with-stuck-out-tongue-and-winking-eye",";-P":"face-with-stuck-out-tongue-and-winking-eye",":o)":"monkey-face","D:":"anguished-face",":fu:":"reversed-hand-with-middle-finger-extended",xD:"rolling-on-the-floor-laughing"}},{}],8:[function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var i=t("lodash"),o=t("emoji-aware").split,a=t("store"),s=t("./aliases.js");e.exports=function(t){var e=i.get(t,"baseUrl","/"),n=i.get(t,"blackList",[]),c=/:([a-z0-9-]+):/gm,u=i.chain(i.clone(s)).mapKeys(function(t,e){return e.replace("\\","\\\\").replace(")","\\)").replace(":","\\:").replace(";","\\;").replace("-","\\-").replace("*","\\*").replace("|","\\|").replace("(","\\(").replace("/","\\/")}).keys().value().join("|"),l=new RegExp("(\\s|^)("+u+")(?:(?=\\s|$))","mg"),d={recents:"idz-icon-emojis-recent",people:"idz-icon-emojis-people",nature:"idz-icon-emojis-animals-plants","food-drink":"idz-icon-emojis-food",objects:"idz-icon-emojis-objects","travel-places":"idz-icon-emojis-car",activity:"idz-icon-emojis-activity",symbols:"idz-icon-emojis-symbols",flags:"idz-icon-emojis-flag"},f={},h={},p={},m={},g={},v=function(t){for(var e=0,n=0,r=0,i=[];e<t.length;)n=t.charCodeAt(e++),r?(i.push((65536+(r-55296<<10)+(n-56320)).toString(16)),r=0):55296<=n&&n<=56319?r=n:i.push(n.toString(16));return i.join("-")},_=function(t,n){var r=m[t][n];return e+"/"+t+"/"+r.category+"/"+n+".png"},b=function(t){var e=i.get(a.get("emojis"),t,{name:"recents",emojis:[{char:"no recent",shortname:"noRecent",category:"recent",count:0}],fullName:"Recents"});return e.emojis=i.chain(e.emojis).sortBy(function(t){return t.count}).reverse().value(),e},y=function(t){var e=i.assign({},t);return i.forEach(e,function(t){t.emojis=i.filter(t.emojis,function(t){return!i.includes(n,t.shortname)})}),e},w=function(t,e){p[t]={},h[t]={},m[t]={},g[t]={},i.each(e,function(e){"recents"!==e.name&&i.each(e.emojis,function(e){p[t][e.unicode]=e.shortname,h[t][e.shortname]=e.char,m[t][e.shortname]=e,g[t][e.unicode]=e,i.has(e,"modifiers")&&i.each(e.modifiers,function(e){p[t][e.unicode]=e.shortname,h[t][e.shortname]=e.char,m[t][e.shortname]=e,g[t][e.unicode]=e})})})},S=function(t,e){var n=o(e);return!1===n?O(e):(n=i.map(n,function(e){var n=v(e);return i.has(g[t],n)?":"+p[t][n]+":":i.has(g.apple,n)?":"+p.apple[n]+":":e}),O(n.join("")))},O=function(t){return t.replace(l,function(t,e,n){return e+":"+s[n]+":"})},T=function(t,e,n){var r='<img src="<%url%>" data-char="<%char%>" data-shortname="<%shortname%>" class="emoji idzEmoji'+(n?" emojiBig":"")+'" alt="<%char%>"/>';return e=e.replace(c,function(e,n){var o=e;return i.has(h.apple,n)&&(o=r.replace(/<%char%>/g,h.apple[n]).replace(/<%url%>/g,_("apple",n)).replace(/<%shortname%>/g,n)),i.has(h[t],n)&&(o=r.replace(/<%char%>/g,h[t][n]).replace(/<%url%>/g,_(t,n)).replace(/<%shortname%>/g,n)),o})};return{getUnicode:v,getEmojiUrl:_,getSpriteUrl:function(t){return e+"/"+t+"/"+t+".png"},getJSONUrl:function(t){return e+"/"+t+"/"+t+".json"},getHistory:b,updateHistory:function(t,e){var n=a.get("emojis"),o=b(t).emojis;i.remove(o,{shortname:"noRecent"}),-1===i.findIndex(o,function(t){return t.unicode===e.unicode})?o=o.concat({shortname:e.shortname,char:e.char,category:"recent",count:1,unicode:e.unicode}):i.find(o,function(t){return t.unicode===e.unicode}).count+=1,i.size(o)>14&&(o=i.chain(o).sortBy("count").drop().value()),a.set("emojis",i.assign({},n,r({},t,i.assign(b(t),{emojis:o}))))},getEmojis:function(t,e){var n=f[t]||{};return e&&(n=i.assign(n,{recents:b(t)})),n},setEmojis:function(t,e){var n=y(e);return f[t]=i.merge(f[t]||{},n),w(t,n),f[t]},hasTheme:function(t){return i.has(f,t)},getIcons:function(){return d},replaceUtf8ToImage:function(t,e){var n=o(e),r=n&&1===n.length;return T(t,S(t,e),r)},replaceUtf8ToShortname:S,replaceAliasesToShortname:O,replaceShortnameToImage:T,replaceShortnameToUtf8:function(t,e){var n=O(e);return n=n.replace(c,function(e,n){var r=e;return i.has(h.apple,n)&&(r=h.apple[n]),i.has(h[t],n)&&(r=h[t][n]),r})}}}},{"./aliases.js":7,"emoji-aware":15,lodash:35,store:37}],9:[function(t,e,n){e.exports=function(t){t.addConnectionPlugin("fileupload",{connection:null,init:function(t){this.connection=t},requestSlot:function(e,n,r,i){var o=$iq({id:this.connection.getUniqueId(),from:this.connection.jid,to:"upload."+t.getDomainFromJid(this.connection.jid),type:"get"}).c("request",{xmlns:"urn:xmpp:http:upload"}).c("filename",{},e.name).c("size",{},e.size).c("content-type",{},e.contentType);this.connection.sendIQ(o,n,r,i)}})}},{}],10:[function(t,e,n){var r,i,o={}.hasOwnProperty,a=function(t,e){return function(){return t.apply(e,arguments)}};Strophe.addConnectionPlugin("muc",{_connection:null,rooms:{},roomNames:[],init:function(t){return this._connection=t,this._muc_handler=null,Strophe.addNamespace("MUC_OWNER",Strophe.NS.MUC+"#owner"),Strophe.addNamespace("MUC_ADMIN",Strophe.NS.MUC+"#admin"),Strophe.addNamespace("MUC_USER",Strophe.NS.MUC+"#user"),Strophe.addNamespace("MUC_ROOMCONF",Strophe.NS.MUC+"#roomconfig"),Strophe.addNamespace("MUC_REGISTER","jabber:iq:register")},join:function(t,e,n,r,o,a,s,c){var u,l;return l=this.test_append_nick(t,e),u=$pres({from:this._connection.jid,to:l}).c("x",{xmlns:Strophe.NS.MUC}),null!=s&&(u=u.c("history",s).up()),null!=a&&u.cnode(Strophe.xmlElement("password",[],a)),null!=c&&u.up().cnode(c),null==this._muc_handler&&(this._muc_handler=this._connection.addHandler(function(e){return function(n){var r,i,o,a,s,c,u,l,d;if(!(r=n.getAttribute("from")))return!0;if(c=r.split("/")[0],!e.rooms[c])return!0;if(t=e.rooms[c],i={},"message"===n.nodeName)i=t._message_handlers;else if("presence"===n.nodeName&&(d=n.getElementsByTagName("x")).length>0)for(o=0,s=d.length;o<s;o++)if(u=d[o],(l=u.getAttribute("xmlns"))&&l.match(Strophe.NS.MUC)){i=t._presence_handlers;break}for(a in i)(0,i[a])(n,t)||delete i[a];return!0}}(this))),this.rooms.hasOwnProperty(t)||(this.rooms[t]=new i(this,t,e,a),r&&this.rooms[t].addHandler("presence",r),n&&this.rooms[t].addHandler("message",n),o&&this.rooms[t].addHandler("roster",o),this.roomNames.push(t)),this._connection.send(u)},leave:function(t,e,n,r){var i,o,a,s;return i=this.roomNames.indexOf(t),delete this.rooms[t],i>=0&&(this.roomNames.splice(i,1),0===this.roomNames.length&&(this._connection.deleteHandler(this._muc_handler),this._muc_handler=null)),s=this.test_append_nick(t,e),a=this._connection.getUniqueId(),o=$pres({type:"unavailable",id:a,from:this._connection.jid,to:s}),null!=r&&o.c("status",r),null!=n&&this._connection.addHandler(n,null,"presence",null,a),this._connection.send(o),a},message:function(t,e,n,r,i,o){var a,s,c;return c=this.test_append_nick(t,e),i=i||(null!=e?"chat":"groupchat"),o=o||this._connection.getUniqueId(),(a=$msg({to:c,from:this._connection.jid,type:i,id:o}).c("body").t(n)).up(),null!=r&&(a.c("html",{xmlns:Strophe.NS.XHTML_IM}).c("body",{xmlns:Strophe.NS.XHTML}).h(r),0===a.node.childNodes.length?(s=a.node.parentNode,a.up().up(),a.node.removeChild(s)):a.up().up()),a.c("x",{xmlns:"jabber:x:event"}).c("composing"),this._connection.send(a),o},groupchat:function(t,e,n,r){return this.message(t,null,e,n,void 0,r)},invite:function(t,e,n){var r,i;return i=this._connection.getUniqueId(),r=$msg({from:this._connection.jid,to:t,id:i}).c("x",{xmlns:Strophe.NS.MUC_USER}).c("invite",{to:e}),null!=n&&r.c("reason",n),this._connection.send(r),i},multipleInvites:function(t,e,n){var r,i,o,a,s;for(a=this._connection.getUniqueId(),i=$msg({from:this._connection.jid,to:t,id:a}).c("x",{xmlns:Strophe.NS.MUC_USER}),r=0,o=e.length;r<o;r++)s=e[r],i.c("invite",{to:s}),null!=n&&(i.c("reason",n),i.up()),i.up();return this._connection.send(i),a},directInvite:function(t,e,n,r){var i,o,a;return a=this._connection.getUniqueId(),i={xmlns:"jabber:x:conference",jid:t},null!=n&&(i.reason=n),null!=r&&(i.password=r),o=$msg({from:this._connection.jid,to:e,id:a}).c("x",i),this._connection.send(o),a},queryOccupants:function(t,e,n){var r,i;return r={xmlns:Strophe.NS.DISCO_ITEMS},i=$iq({from:this._connection.jid,to:t,type:"get"}).c("query",r),this._connection.sendIQ(i,e,n)},configure:function(t,e,n){var r,i;return r=$iq({to:t,type:"get"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}),i=r.tree(),this._connection.sendIQ(i,e,n)},cancelConfigure:function(t){var e,n;return e=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"cancel"}),n=e.tree(),this._connection.sendIQ(n)},saveConfiguration:function(t,e,n,r){var i,o,a,s,c;if(a=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}),void 0!==Strophe.x&&void 0!==Strophe.x.Form&&e instanceof Strophe.x.Form)e.type="submit",a.cnode(e.toXML());else for(a.c("x",{xmlns:"jabber:x:data",type:"submit"}),o=0,s=e.length;o<s;o++)i=e[o],a.cnode(i).up();return c=a.tree(),this._connection.sendIQ(c,n,r)},createInstantRoom:function(t,e,n){var r;return r=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"}),this._connection.sendIQ(r.tree(),e,n)},createConfiguredRoom:function(t,e,n,r){var i,a,s;(a=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_OWNER}).c("x",{xmlns:"jabber:x:data",type:"submit"})).c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up();for(i in e)o.call(e,i)&&(s=e[i],a.c("field",{var:i}).c("value").t(s).up().up());return this._connection.sendIQ(a.tree(),n,r)},setTopic:function(t,e){var n;return n=$msg({to:t,from:this._connection.jid,type:"groupchat"}).c("subject",{xmlns:"jabber:client"}).t(e),this._connection.send(n.tree())},_modifyPrivilege:function(t,e,n,r,i){var o;return o=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_ADMIN}).cnode(e.node),null!=n&&o.c("reason",n),this._connection.sendIQ(o.tree(),r,i)},modifyRole:function(t,e,n,r,i,o){var a;return a=$build("item",{nick:e,role:n}),this._modifyPrivilege(t,a,r,i,o)},kick:function(t,e,n,r,i){return this.modifyRole(t,e,"none",n,r,i)},voice:function(t,e,n,r,i){return this.modifyRole(t,e,"participant",n,r,i)},mute:function(t,e,n,r,i){return this.modifyRole(t,e,"visitor",n,r,i)},op:function(t,e,n,r,i){return this.modifyRole(t,e,"moderator",n,r,i)},deop:function(t,e,n,r,i){return this.modifyRole(t,e,"participant",n,r,i)},modifyAffiliation:function(t,e,n,r,i,o){var a;return a=$build("item",{jid:e,affiliation:n}),this._modifyPrivilege(t,a,r,i,o)},ban:function(t,e,n,r,i){return this.modifyAffiliation(t,e,"outcast",n,r,i)},member:function(t,e,n,r,i){return this.modifyAffiliation(t,e,"member",n,r,i)},revoke:function(t,e,n,r,i){return this.modifyAffiliation(t,e,"none",n,r,i)},owner:function(t,e,n,r,i){return this.modifyAffiliation(t,e,"owner",n,r,i)},admin:function(t,e,n,r,i){return this.modifyAffiliation(t,e,"admin",n,r,i)},changeNick:function(t,e){var n,r;return r=this.test_append_nick(t,e),n=$pres({from:this._connection.jid,to:r,id:this._connection.getUniqueId()}),this._connection.send(n.tree())},setStatus:function(t,e,n,r){var i,o;return o=this.test_append_nick(t,e),i=$pres({from:this._connection.jid,to:o}),null!=n&&i.c("show",n).up(),null!=r&&i.c("status",r),this._connection.send(i.tree())},registrationRequest:function(t,e,n){var r;return r=$iq({to:t,from:this._connection.jid,type:"get"}).c("query",{xmlns:Strophe.NS.MUC_REGISTER}),this._connection.sendIQ(r,function(t){var n,r,i,o,a,s;for((r=t.getElementsByTagName("field")).length,o={required:[],optional:[]},a=0,s=r.length;a<s;a++)i={var:(n=r[a]).getAttribute("var"),label:n.getAttribute("label"),type:n.getAttribute("type")},n.getElementsByTagName("required").length>0?o.required.push(i):o.optional.push(i);return e(o)},n)},submitRegistrationForm:function(t,e,n,r){var i,o,a;(i=$iq({to:t,type:"set"}).c("query",{xmlns:Strophe.NS.MUC_REGISTER})).c("x",{xmlns:"jabber:x:data",type:"submit"}),i.c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#register").up().up();for(o in e)a=e[o],i.c("field",{var:o}).c("value").t(a).up().up();return this._connection.sendIQ(i,n,r)},listRooms:function(t,e,n){var r;return r=$iq({to:t,from:this._connection.jid,type:"get"}).c("query",{xmlns:Strophe.NS.DISCO_ITEMS}),this._connection.sendIQ(r,e,n)},test_append_nick:function(t,e){var n,r;return r=Strophe.escapeNode(Strophe.getNodeFromJid(t)),n=Strophe.getDomainFromJid(t),r+"@"+n+(null!=e?"/"+e:"")}}),i=function(){function t(t,e,n,r){this.client=t,this.name=e,this.nick=n,this.password=r,this._roomRosterHandler=a(this._roomRosterHandler,this),this._addOccupant=a(this._addOccupant,this),this.roster={},this._message_handlers={},this._presence_handlers={},this._roster_handlers={},this._handler_ids=0,this.client.muc&&(this.client=this.client.muc),this.name=Strophe.getBareJidFromJid(this.name),this.addHandler("presence",this._roomRosterHandler)}return t.prototype.join=function(t,e,n){return this.client.join(this.name,this.nick,t,e,n,this.password)},t.prototype.leave=function(t,e){return this.client.leave(this.name,this.nick,t,e),delete this.client.rooms[this.name]},t.prototype.message=function(t,e,n,r){return this.client.message(this.name,t,e,n,r)},t.prototype.groupchat=function(t,e){return this.client.groupchat(this.name,t,e)},t.prototype.invite=function(t,e){return this.client.invite(this.name,t,e)},t.prototype.multipleInvites=function(t,e){return this.client.invite(this.name,t,e)},t.prototype.directInvite=function(t,e){return this.client.directInvite(this.name,t,e,this.password)},t.prototype.configure=function(t){return this.client.configure(this.name,t)},t.prototype.cancelConfigure=function(){return this.client.cancelConfigure(this.name)},t.prototype.saveConfiguration=function(t){return this.client.saveConfiguration(this.name,t)},t.prototype.queryOccupants=function(t,e){return this.client.queryOccupants(this.name,t,e)},t.prototype.setTopic=function(t){return this.client.setTopic(this.name,t)},t.prototype.modifyRole=function(t,e,n,r,i){return this.client.modifyRole(this.name,t,e,n,r,i)},t.prototype.kick=function(t,e,n,r){return this.client.kick(this.name,t,e,n,r)},t.prototype.voice=function(t,e,n,r){return this.client.voice(this.name,t,e,n,r)},t.prototype.mute=function(t,e,n,r){return this.client.mute(this.name,t,e,n,r)},t.prototype.op=function(t,e,n,r){return this.client.op(this.name,t,e,n,r)},t.prototype.deop=function(t,e,n,r){return this.client.deop(this.name,t,e,n,r)},t.prototype.modifyAffiliation=function(t,e,n,r,i){return this.client.modifyAffiliation(this.name,t,e,n,r,i)},t.prototype.ban=function(t,e,n,r){return this.client.ban(this.name,t,e,n,r)},t.prototype.member=function(t,e,n,r){return this.client.member(this.name,t,e,n,r)},t.prototype.revoke=function(t,e,n,r){return this.client.revoke(this.name,t,e,n,r)},t.prototype.owner=function(t,e,n,r){return this.client.owner(this.name,t,e,n,r)},t.prototype.admin=function(t,e,n,r){return this.client.admin(this.name,t,e,n,r)},t.prototype.changeNick=function(t){return this.nick=t,this.client.changeNick(this.name,nick)},t.prototype.setStatus=function(t,e){return this.client.setStatus(this.name,this.nick,t,e)},t.prototype.addHandler=function(t,e){var n;switch(n=this._handler_ids++,t){case"presence":this._presence_handlers[n]=e;break;case"message":this._message_handlers[n]=e;break;case"roster":this._roster_handlers[n]=e;break;default:return this._handler_ids--,null}return n},t.prototype.removeHandler=function(t){return delete this._presence_handlers[t],delete this._message_handlers[t],delete this._roster_handlers[t]},t.prototype._addOccupant=function(t){var e;return e=new r(t,this),this.roster[e.nick]=e,e},t.prototype._roomRosterHandler=function(e){var n,r,i,o,a;switch(n=t._parsePresence(e),o=n.nick,i=n.newnick||null,n.type){case"error":return!0;case"unavailable":i&&(n.nick=i,this.roster[o]&&this.roster[i]&&(this.roster[o].update(this.roster[i]),this.roster[i]=this.roster[o]),this.roster[o]&&!this.roster[i]&&(this.roster[i]=this.roster[o].update(n))),delete this.roster[o];break;default:this.roster[o]?this.roster[o].update(n):this._addOccupant(n)}a=this._roster_handlers;for(r in a)(0,a[r])(this.roster,this)||delete this._roster_handlers[r];return!0},t._parsePresence=function(t){var e,n,r,i,o,a,s,c,u;for((r={}).nick=Strophe.getResourceFromJid(t.getAttribute("from")),r.type=t.getAttribute("type"),r.states=[],i=0,a=(c=t.childNodes).length;i<a;i++)switch((e=c[i]).nodeName){case"status":r.status=e.textContent||null;break;case"show":r.show=e.textContent||null;break;case"x":if(e.getAttribute("xmlns")===Strophe.NS.MUC_USER)for(o=0,s=(u=e.childNodes).length;o<s;o++)switch((n=u[o]).nodeName){case"item":r.affiliation=n.getAttribute("affiliation"),r.role=n.getAttribute("role"),r.jid=n.getAttribute("jid"),r.newnick=n.getAttribute("nick");break;case"status":n.getAttribute("code")&&r.states.push(n.getAttribute("code"))}}return r},t}(),function(){function t(t){this.parse=a(this.parse,this),null!=t&&this.parse(t)}t.prototype.parse=function(t){var e,n,r,i,o,a,s,c,u,l,d,f,h;for(f=t.getElementsByTagName("query")[0].childNodes,this.identities=[],this.features=[],this.x=[],o=0,u=f.length;o<u;o++)switch(r=f[o],n=r.attributes,r.nodeName){case"identity":for(a={},s=0,l=n.length;s<l;s++)a[(e=n[s]).name]=e.textContent;this.identities.push(a);break;case"feature":this.features.push(r.getAttribute("var"));break;case"x":if("FORM_TYPE"===!r.childNodes[0].getAttribute("var")||"hidden"===!r.childNodes[0].getAttribute("type"))break;for(c=0,d=(h=r.childNodes).length;c<d;c++)(i=h[c]).attributes.type||this.x.push({var:i.getAttribute("var"),label:i.getAttribute("label")||"",value:i.firstChild.textContent||""})}return{identities:this.identities,features:this.features,x:this.x}}}(),r=function(){function t(t,e){this.room=e,this.update=a(this.update,this),this.admin=a(this.admin,this),this.owner=a(this.owner,this),this.revoke=a(this.revoke,this),this.member=a(this.member,this),this.ban=a(this.ban,this),this.modifyAffiliation=a(this.modifyAffiliation,this),this.deop=a(this.deop,this),this.op=a(this.op,this),this.mute=a(this.mute,this),this.voice=a(this.voice,this),this.kick=a(this.kick,this),this.modifyRole=a(this.modifyRole,this),this.update(t)}return t.prototype.modifyRole=function(t,e,n,r){return this.room.modifyRole(this.nick,t,e,n,r)},t.prototype.kick=function(t,e,n){return this.room.kick(this.nick,t,e,n)},t.prototype.voice=function(t,e,n){return this.room.voice(this.nick,t,e,n)},t.prototype.mute=function(t,e,n){return this.room.mute(this.nick,t,e,n)},t.prototype.op=function(t,e,n){return this.room.op(this.nick,t,e,n)},t.prototype.deop=function(t,e,n){return this.room.deop(this.nick,t,e,n)},t.prototype.modifyAffiliation=function(t,e,n,r){return this.room.modifyAffiliation(this.jid,t,e,n,r)},t.prototype.ban=function(t,e,n){return this.room.ban(this.jid,t,e,n)},t.prototype.member=function(t,e,n){return this.room.member(this.jid,t,e,n)},t.prototype.revoke=function(t,e,n){return this.room.revoke(this.jid,t,e,n)},t.prototype.owner=function(t,e,n){return this.room.owner(this.jid,t,e,n)},t.prototype.admin=function(t,e,n){return this.room.admin(this.jid,t,e,n)},t.prototype.update=function(t){return this.nick=t.nick||null,this.affiliation=t.affiliation||null,this.role=t.role||null,this.jid=t.jid||null,this.status=t.status||null,this.show=t.show||null,this},t}()},{}],11:[function(t,e,n){e.exports=function(t){t.addConnectionPlugin("outofband",{_conn:null,init:function(e){this._conn=e,t.addNamespace("OUTOFBAND","jabber:iq:oob")},sendIq:function(e,n){var r=null;return $(e).filter("iq").each(function(){var e=$(this).find("url:first").text(),i=$(this).find("desc:first").text();switch(n){case null:r=$iq({to:$(this).attr("from"),from:$(this).attr("to"),type:"result",id:$(this).attr("id")});break;case"404":r=$iq({to:$(this).attr("from"),from:$(this).attr("to"),type:"error",id:$(this).attr("id")}).c("query",{xmlns:t.NS.OUTOFBAND}).c("url",{},e).c("desc",{},i).up().c("error",{code:"404",type:"cancel"}).c("item-not-found",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"});break;case"406":r=$iq({to:$(this).attr("from"),from:$(this).attr("to"),type:"error",id:$(this).attr("id")}).c("query",{xmlns:t.NS.OUTOFBAND}).c("url",{},e).c("desc",{},i).up().c("error",{code:"406",type:"modify"}).c("not-acceptable",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"});break;default:console.log("Unhandled errorcode: a response has not been sent")}}),r&&(console.log(r.toString()),this._conn.send(r)),r},sendUrl:function(e,n,r){var i=$iq({id:this._conn.getUniqueId(),type:"set",from:this._conn.jid,to:e}).c("query",{xmlns:t.NS.OUTOFBAND}).c("url",{},n).c("desc",{},r);this._conn.send(i)},addOutOfBandHandler:function(e,n,r,i){this._conn.addHandler(e,t.NS.OUTOFBAND,"iq",n,null,r,i)}})}},{}],12:[function(t,e,n){Strophe.addConnectionPlugin("receipts",{_conn:null,_msgQueue:{},_retries:{},_resendCount:10,_resendTime:9e3,_requestCallbacks:{},init:function(t){this._conn=t,Strophe.addNamespace("RECEIPTS","urn:xmpp:receipts")},statusChanged:function(t){if(t===Strophe.Status.CONNECTED||t===Strophe.Status.ATTACHED){var e=this;setTimeout(function(){e.resendQueue()},4e3)}},sendMessage:function(t,e,n){var r=t.tree().getAttribute("id");r||(r=+new Date,t.tree().setAttribute("id",r));var i=Strophe.xmlElement("request",{xmlns:Strophe.NS.RECEIPTS});return t.tree().appendChild(i),this._msgQueue[r]=t,this._retries[r]=0,(e||n)&&(this._requestCallbacks[r]=[e,n]),this._conn.send(t),n||this.resendMessage(r),r},resendMessage:function(t){var e=this;setTimeout(function(){if(e._msgQueue[t]){if(!e._conn.connected)return void e.resendMessage(t);if(++e._retries[t]>e._resendCount)return;e._msgQueue[t].tree().setAttribute("from",e._conn.jid),e._conn.send(e._msgQueue[t]),e.resendMessage(t)}},this._resendTime)},addReceiptHandler:function(t,e,n,r){var i=this;this._conn.addHandler(function(e){var n=t(e);return i._processReceipt(e,n),n},Strophe.NS.RECEIPTS,"message",e,null,n,r)},_processReceipt:function(t,e){var n=t.getAttribute("id"),r=t.getAttribute("from"),i=t.getElementsByTagName("request"),o=t.getElementsByTagName("received"),a="error"===t.getAttribute("type"),s=this;if(i.length>0&&!a&&(e&&"object"==typeof e&&"done"in e?e.done(function(){s.sendReceipt(r,n)}):this.sendReceipt(r,n)),o.length>0){var c=o[0].getAttribute("id");if(c&&(delete this._msgQueue[c],delete this._retries[c],c in this._requestCallbacks)){var u=this._requestCallbacks[c][a?1:0];u&&u.apply(null),delete this._requestCallbacks[c]}}},sendReceipt:function(t,e){var n=$msg({to:t,from:this._conn.jid,id:this._conn.getUniqueId()}),r=Strophe.xmlElement("received",{xmlns:Strophe.NS.RECEIPTS,id:e});n.tree().appendChild(r),this._conn.send(n)},resendQueue:function(){if(this._conn.connected)for(var t in this._msgQueue)this._msgQueue.hasOwnProperty(t)&&(this._msgQueue[t].tree().setAttribute("from",this._conn.jid),this._conn.send(this._msgQueue[t]));else{var e=this;setTimeout(function(){e.resendQueue()},4e3)}},getUnreceivedMsgs:function(){var t=[];for(var e in this._msgQueue)this._msgQueue.hasOwnProperty(e)&&t.push(this._msgQueue[e]);return t},clearMessages:function(){this._msgQueue={}}})},{}],13:[function(e,n,r){!function(t,e){"function"==typeof define&&define.amd?define("strophe-base64",function(){return e()}):t.Base64=e()}(this,function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(e){var n,r,i,o,a,s,c,u="",l=0;do{o=(n=e.charCodeAt(l++))>>2,a=(3&n)<<4|(r=e.charCodeAt(l++))>>4,s=(15&r)<<2|(i=e.charCodeAt(l++))>>6,c=63&i,isNaN(r)?(a=(3&n)<<4,s=c=64):isNaN(i)&&(c=64),u=u+t.charAt(o)+t.charAt(a)+t.charAt(s)+t.charAt(c)}while(l<e.length);return u},decode:function(e){var n,r,i,o,a,s,c="",u=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{n=t.indexOf(e.charAt(u++))<<2|(o=t.indexOf(e.charAt(u++)))>>4,r=(15&o)<<4|(a=t.indexOf(e.charAt(u++)))>>2,i=(3&a)<<6|(s=t.indexOf(e.charAt(u++))),c+=String.fromCharCode(n),64!=a&&(c+=String.fromCharCode(r)),64!=s&&(c+=String.fromCharCode(i))}while(u<e.length);return c}}}),function(t,e){"function"==typeof define&&define.amd?define("strophe-sha1",function(){return e()}):t.SHA1=e()}(this,function(){function t(t,r){t[r>>5]|=128<<24-r%32,t[15+(r+64>>9<<4)]=r;var a,s,c,u,l,d,f,h,p=new Array(80),m=1732584193,g=-271733879,v=-1732584194,_=271733878,b=-1009589776;for(a=0;a<t.length;a+=16){for(u=m,l=g,d=v,f=_,h=b,s=0;s<80;s++)p[s]=s<16?t[a+s]:o(p[s-3]^p[s-8]^p[s-14]^p[s-16],1),c=i(i(o(m,5),e(s,g,v,_)),i(i(b,p[s]),n(s))),b=_,_=v,v=o(g,30),g=m,m=c;m=i(m,u),g=i(g,l),v=i(v,d),_=i(_,f),b=i(b,h)}return[m,g,v,_,b]}function e(t,e,n,r){return t<20?e&n|~e&r:t<40?e^n^r:t<60?e&n|e&r|n&r:e^n^r}function n(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514}function r(e,n){var r=a(e);r.length>16&&(r=t(r,8*e.length));for(var i=new Array(16),o=new Array(16),s=0;s<16;s++)i[s]=909522486^r[s],o[s]=1549556828^r[s];var c=t(i.concat(a(n)),512+8*n.length);return t(o.concat(c),672)}function i(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function o(t,e){return t<<e|t>>>32-e}function a(t){for(var e=[],n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<24-n%32;return e}function s(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>24-n%32&255);return e}function c(t){for(var e,n,r="",i=0;i<4*t.length;i+=3)for(e=(t[i>>2]>>8*(3-i%4)&255)<<16|(t[i+1>>2]>>8*(3-(i+1)%4)&255)<<8|t[i+2>>2]>>8*(3-(i+2)%4)&255,n=0;n<4;n++)8*i+6*n>32*t.length?r+="=":r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>6*(3-n)&63);return r}return{b64_hmac_sha1:function(t,e){return c(r(t,e))},b64_sha1:function(e){return c(t(a(e),8*e.length))},binb2str:s,core_hmac_sha1:r,str_hmac_sha1:function(t,e){return s(r(t,e))},str_sha1:function(e){return s(t(a(e),8*e.length))}}}),function(t,e){"function"==typeof define&&define.amd?define("strophe-md5",function(){return e()}):t.MD5=e()}(this,function(t){var e=function(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n},n=function(t,e){return t<<e|t>>>32-e},r=function(t){for(var e=[],n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e},i=function(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e},o=function(t){for(var e="",n=0;n<4*t.length;n++)e+="0123456789abcdef".charAt(t[n>>2]>>n%4*8+4&15)+"0123456789abcdef".charAt(t[n>>2]>>n%4*8&15);return e},a=function(t,r,i,o,a,s){return e(n(e(e(r,t),e(o,s)),a),i)},s=function(t,e,n,r,i,o,s){return a(e&n|~e&r,t,e,i,o,s)},c=function(t,e,n,r,i,o,s){return a(e&r|n&~r,t,e,i,o,s)},u=function(t,e,n,r,i,o,s){return a(e^n^r,t,e,i,o,s)},l=function(t,e,n,r,i,o,s){return a(n^(e|~r),t,e,i,o,s)},d=function(t,n){t[n>>5]|=128<<n%32,t[14+(n+64>>>9<<4)]=n;for(var r,i,o,a,d=1732584193,f=-271733879,h=-1732584194,p=271733878,m=0;m<t.length;m+=16)r=d,i=f,o=h,a=p,d=s(d,f,h,p,t[m+0],7,-680876936),p=s(p,d,f,h,t[m+1],12,-389564586),h=s(h,p,d,f,t[m+2],17,606105819),f=s(f,h,p,d,t[m+3],22,-1044525330),d=s(d,f,h,p,t[m+4],7,-176418897),p=s(p,d,f,h,t[m+5],12,1200080426),h=s(h,p,d,f,t[m+6],17,-1473231341),f=s(f,h,p,d,t[m+7],22,-45705983),d=s(d,f,h,p,t[m+8],7,1770035416),p=s(p,d,f,h,t[m+9],12,-1958414417),h=s(h,p,d,f,t[m+10],17,-42063),f=s(f,h,p,d,t[m+11],22,-1990404162),d=s(d,f,h,p,t[m+12],7,1804603682),p=s(p,d,f,h,t[m+13],12,-40341101),h=s(h,p,d,f,t[m+14],17,-1502002290),f=s(f,h,p,d,t[m+15],22,1236535329),d=c(d,f,h,p,t[m+1],5,-165796510),p=c(p,d,f,h,t[m+6],9,-1069501632),h=c(h,p,d,f,t[m+11],14,643717713),f=c(f,h,p,d,t[m+0],20,-373897302),d=c(d,f,h,p,t[m+5],5,-701558691),p=c(p,d,f,h,t[m+10],9,38016083),h=c(h,p,d,f,t[m+15],14,-660478335),f=c(f,h,p,d,t[m+4],20,-405537848),d=c(d,f,h,p,t[m+9],5,568446438),p=c(p,d,f,h,t[m+14],9,-1019803690),h=c(h,p,d,f,t[m+3],14,-187363961),f=c(f,h,p,d,t[m+8],20,1163531501),d=c(d,f,h,p,t[m+13],5,-1444681467),p=c(p,d,f,h,t[m+2],9,-51403784),h=c(h,p,d,f,t[m+7],14,1735328473),f=c(f,h,p,d,t[m+12],20,-1926607734),d=u(d,f,h,p,t[m+5],4,-378558),p=u(p,d,f,h,t[m+8],11,-2022574463),h=u(h,p,d,f,t[m+11],16,1839030562),f=u(f,h,p,d,t[m+14],23,-35309556),d=u(d,f,h,p,t[m+1],4,-1530992060),p=u(p,d,f,h,t[m+4],11,1272893353),h=u(h,p,d,f,t[m+7],16,-155497632),f=u(f,h,p,d,t[m+10],23,-1094730640),d=u(d,f,h,p,t[m+13],4,681279174),p=u(p,d,f,h,t[m+0],11,-358537222),h=u(h,p,d,f,t[m+3],16,-722521979),f=u(f,h,p,d,t[m+6],23,76029189),d=u(d,f,h,p,t[m+9],4,-640364487),p=u(p,d,f,h,t[m+12],11,-421815835),h=u(h,p,d,f,t[m+15],16,530742520),f=u(f,h,p,d,t[m+2],23,-995338651),d=l(d,f,h,p,t[m+0],6,-198630844),p=l(p,d,f,h,t[m+7],10,1126891415),h=l(h,p,d,f,t[m+14],15,-1416354905),f=l(f,h,p,d,t[m+5],21,-57434055),d=l(d,f,h,p,t[m+12],6,1700485571),p=l(p,d,f,h,t[m+3],10,-1894986606),h=l(h,p,d,f,t[m+10],15,-1051523),f=l(f,h,p,d,t[m+1],21,-2054922799),d=l(d,f,h,p,t[m+8],6,1873313359),p=l(p,d,f,h,t[m+15],10,-30611744),h=l(h,p,d,f,t[m+6],15,-1560198380),f=l(f,h,p,d,t[m+13],21,1309151649),d=l(d,f,h,p,t[m+4],6,-145523070),p=l(p,d,f,h,t[m+11],10,-1120210379),h=l(h,p,d,f,t[m+2],15,718787259),f=l(f,h,p,d,t[m+9],21,-343485551),d=e(d,r),f=e(f,i),h=e(h,o),p=e(p,a);return[d,f,h,p]};return{hexdigest:function(t){return o(d(r(t),8*t.length))},hash:function(t){return i(d(r(t),8*t.length))}}}),function(t,e){"function"==typeof define&&define.amd?define("strophe-utils",function(){return e()}):t.stropheUtils=e()}(this,function(){return{utf16to8:function(t){var e,n,r="",i=t.length;for(e=0;e<i;e++)(n=t.charCodeAt(e))>=0&&n<=127?r+=t.charAt(e):n>2047?(r+=String.fromCharCode(224|n>>12&15),r+=String.fromCharCode(128|n>>6&63),r+=String.fromCharCode(128|n>>0&63)):(r+=String.fromCharCode(192|n>>6&31),r+=String.fromCharCode(128|n>>0&63));return r},addCookies:function(t){var e,n,r,i,o,a,s;for(e in t||{})o="",a="",s="",r="object"==typeof(n=t[e]),i=escape(unescape(r?n.value:n)),r&&(o=n.expires?";expires="+n.expires:"",a=n.domain?";domain="+n.domain:"",s=n.path?";path="+n.path:""),document.cookie=e+"="+i+o+a+s}}}),function(t,e){"function"==typeof define&&define.amd?define("strophe-polyfill",[],function(){return e()}):t.polyfills=e()}(this,function(){var t={bind:function(t,e){var n=Array.prototype.slice,r=Array.prototype.concat,i=n.call(arguments,2);return function(){return t.apply(e||this,r.call(i,n.call(arguments,0)))}}};return Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length,n=Number(arguments[1])||0;for((n=n<0?Math.ceil(n):Math.floor(n))<0&&(n+=e);n<e;n++)if(n in this&&this[n]===t)return n;return-1}),t}),function(t,e){if("function"==typeof define&&define.amd)define("strophe-core",["strophe-sha1","strophe-base64","strophe-md5","strophe-utils","strophe-polyfill"],function(){return e.apply(this,arguments)});else{var n=e(t.SHA1,t.Base64,t.MD5,t.stropheUtils,t.polyfills);t.Strophe=n.Strophe,t.$build=n.$build,t.$iq=n.$iq,t.$msg=n.$msg,t.$pres=n.$pres}}(this,function(e,n,r,i,o){function a(t,e){return new u.Builder(t,e)}function s(t){return new u.Builder("iq",t)}function c(t){return new u.Builder("presence",t)}var u,l=o.bind;return u={bind:l,VERSION:"3.2.0",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag:function(t){for(var e=0;e<u.XHTML.tags.length;e++)if(t==u.XHTML.tags[e])return!0;return!1},validAttribute:function(t,e){if(void 0!==u.XHTML.attributes[t]&&u.XHTML.attributes[t].length>0)for(var n=0;n<u.XHTML.attributes[t].length;n++)if(e==u.XHTML.attributes[t][n])return!0;return!1},validCSS:function(t){for(var e=0;e<u.XHTML.css.length;e++)if(t==u.XHTML.css[e])return!0;return!1}},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8,REDIRECT:9,CONNTIMEOUT:10},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,addNamespace:function(t,e){u.NS[t]=e},forEachChild:function(t,e,n){var r,i;for(r=0;r<t.childNodes.length;r++)(i=t.childNodes[r]).nodeType!=u.ElementType.NORMAL||e&&!this.isTagEqual(i,e)||n(i)},isTagEqual:function(t,e){return t.tagName==e},_xmlGenerator:null,_makeGenerator:function(){var e;return document.implementation.createDocument===t||document.implementation.createDocument&&document.documentMode&&document.documentMode<10?(e=this._getIEXmlDom()).appendChild(e.createElement("strophe")):e=document.implementation.createDocument("jabber:client","strophe",null),e},xmlGenerator:function(){return u._xmlGenerator||(u._xmlGenerator=u._makeGenerator()),u._xmlGenerator},_getIEXmlDom:function(){for(var t=null,e=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"],n=0;n<e.length&&null===t;n++)try{t=new ActiveXObject(e[n])}catch(e){t=null}return t},xmlElement:function(e){if(!e)return null;var n,r,i,o=u.xmlGenerator().createElement(e);for(n=1;n<arguments.length;n++){var a=arguments[n];if(a)if("string"==typeof a||"number"==typeof a)o.appendChild(u.xmlTextNode(a));else if("object"==typeof a&&"function"==typeof a.sort)for(r=0;r<a.length;r++){var s=a[r];"object"==typeof s&&"function"==typeof s.sort&&s[1]!==t&&null!==s[1]&&o.setAttribute(s[0],s[1])}else if("object"==typeof a)for(i in a)a.hasOwnProperty(i)&&a[i]!==t&&null!==a[i]&&o.setAttribute(i,a[i])}return o},xmlescape:function(t){return t=t.replace(/\&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/'/g,"&apos;"),t=t.replace(/"/g,"&quot;")},xmlunescape:function(t){return t=t.replace(/\&amp;/g,"&"),t=t.replace(/&lt;/g,"<"),t=t.replace(/&gt;/g,">"),t=t.replace(/&apos;/g,"'"),t=t.replace(/&quot;/g,'"')},xmlTextNode:function(t){return u.xmlGenerator().createTextNode(t)},xmlHtmlNode:function(t){var e;return window.DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t)),e},getText:function(t){if(!t)return null;var e="";0===t.childNodes.length&&t.nodeType==u.ElementType.TEXT&&(e+=t.nodeValue);for(var n=0;n<t.childNodes.length;n++)t.childNodes[n].nodeType==u.ElementType.TEXT&&(e+=t.childNodes[n].nodeValue);return u.xmlescape(e)},copyElement:function(t){var e,n;if(t.nodeType==u.ElementType.NORMAL){for(n=u.xmlElement(t.tagName),e=0;e<t.attributes.length;e++)n.setAttribute(t.attributes[e].nodeName,t.attributes[e].value);for(e=0;e<t.childNodes.length;e++)n.appendChild(u.copyElement(t.childNodes[e]))}else t.nodeType==u.ElementType.TEXT&&(n=u.xmlGenerator().createTextNode(t.nodeValue));return n},createHtml:function(t){var e,n,r,i,o,a,s,c,l,d,f;if(t.nodeType==u.ElementType.NORMAL)if(i=t.nodeName.toLowerCase(),u.XHTML.validTag(i))try{for(n=u.xmlElement(i),e=0;e<u.XHTML.attributes[i].length;e++)if(o=u.XHTML.attributes[i][e],void 0!==(a=t.getAttribute(o))&&null!==a&&""!==a&&!1!==a&&0!==a)if("style"==o&&"object"==typeof a&&void 0!==a.cssText&&(a=a.cssText),"style"==o){for(s=[],c=a.split(";"),r=0;r<c.length;r++)d=(l=c[r].split(":"))[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase(),u.XHTML.validCSS(d)&&(f=l[1].replace(/^\s*/,"").replace(/\s*$/,""),s.push(d+": "+f));s.length>0&&(a=s.join("; "),n.setAttribute(o,a))}else n.setAttribute(o,a);for(e=0;e<t.childNodes.length;e++)n.appendChild(u.createHtml(t.childNodes[e]))}catch(t){n=u.xmlTextNode("")}else for(n=u.xmlGenerator().createDocumentFragment(),e=0;e<t.childNodes.length;e++)n.appendChild(u.createHtml(t.childNodes[e]));else if(t.nodeType==u.ElementType.FRAGMENT)for(n=u.xmlGenerator().createDocumentFragment(),e=0;e<t.childNodes.length;e++)n.appendChild(u.createHtml(t.childNodes[e]));else t.nodeType==u.ElementType.TEXT&&(n=u.xmlTextNode(t.nodeValue));return n},escapeNode:function(t){return"string"!=typeof t?t:t.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},unescapeNode:function(t){return"string"!=typeof t?t:t.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},getNodeFromJid:function(t){return t.indexOf("@")<0?null:t.split("@")[0]},getDomainFromJid:function(t){var e=u.getBareJidFromJid(t);if(e.indexOf("@")<0)return e;var n=e.split("@");return n.splice(0,1),n.join("@")},getResourceFromJid:function(t){var e=t.split("/");return e.length<2?null:(e.splice(0,1),e.join("/"))},getBareJidFromJid:function(t){return t?t.split("/")[0]:null},log:function(t,e){},debug:function(t){this.log(this.LogLevel.DEBUG,t)},info:function(t){this.log(this.LogLevel.INFO,t)},warn:function(t){this.log(this.LogLevel.WARN,t)},error:function(t){this.log(this.LogLevel.ERROR,t)},fatal:function(t){this.log(this.LogLevel.FATAL,t)},serialize:function(t){var e;if(!t)return null;"function"==typeof t.tree&&(t=t.tree());var n,r,i=t.nodeName;for(t.getAttribute("_realname")&&(i=t.getAttribute("_realname")),e="<"+i,n=0;n<t.attributes.length;n++)"_realname"!=t.attributes[n].nodeName&&(e+=" "+t.attributes[n].nodeName+"='"+u.xmlescape(t.attributes[n].value)+"'");if(t.childNodes.length>0){for(e+=">",n=0;n<t.childNodes.length;n++)switch((r=t.childNodes[n]).nodeType){case u.ElementType.NORMAL:e+=u.serialize(r);break;case u.ElementType.TEXT:e+=u.xmlescape(r.nodeValue);break;case u.ElementType.CDATA:e+="<![CDATA["+r.nodeValue+"]]>"}e+="</"+i+">"}else e+="/>";return e},_requestId:0,_connectionPlugins:{},addConnectionPlugin:function(t,e){u._connectionPlugins[t]=e}},u.Builder=function(t,e){"presence"!=t&&"message"!=t&&"iq"!=t||(e&&!e.xmlns?e.xmlns=u.NS.CLIENT:e||(e={xmlns:u.NS.CLIENT})),this.nodeTree=u.xmlElement(t,e),this.node=this.nodeTree},u.Builder.prototype={tree:function(){return this.nodeTree},toString:function(){return u.serialize(this.nodeTree)},up:function(){return this.node=this.node.parentNode,this},attrs:function(e){for(var n in e)e.hasOwnProperty(n)&&(e[n]===t?this.node.removeAttribute(n):this.node.setAttribute(n,e[n]));return this},c:function(t,e,n){var r=u.xmlElement(t,e,n);return this.node.appendChild(r),"string"!=typeof n&&"number"!=typeof n&&(this.node=r),this},cnode:function(e){var n,r=u.xmlGenerator();try{n=r.importNode!==t}catch(t){n=!1}var i=n?r.importNode(e,!0):u.copyElement(e);return this.node.appendChild(i),this.node=i,this},t:function(t){var e=u.xmlTextNode(t);return this.node.appendChild(e),this},h:function(t){var e=document.createElement("body");e.innerHTML=t;for(var n=u.createHtml(e);n.childNodes.length>0;)this.node.appendChild(n.childNodes[0]);return this}},u.Handler=function(t,e,n,r,i,o,a){this.handler=t,this.ns=e,this.name=n,this.type=r,this.id=i,this.options=a||{matchBare:!1},this.options.matchBare||(this.options.matchBare=!1),this.options.matchBare?this.from=o?u.getBareJidFromJid(o):null:this.from=o,this.user=!0},u.Handler.prototype={isMatch:function(t){var e,n=null;if(n=this.options.matchBare?u.getBareJidFromJid(t.getAttribute("from")):t.getAttribute("from"),e=!1,this.ns){var r=this;u.forEachChild(t,null,function(t){t.getAttribute("xmlns")==r.ns&&(e=!0)}),e=e||t.getAttribute("xmlns")==this.ns}else e=!0;var i=t.getAttribute("type");return!(!e||this.name&&!u.isTagEqual(t,this.name)||this.type&&(Array.isArray(this.type)?-1==this.type.indexOf(i):i!=this.type)||this.id&&t.getAttribute("id")!=this.id||this.from&&n!=this.from)},run:function(t){var e=null;try{e=this.handler(t)}catch(t){throw t.sourceURL?u.fatal("error: "+this.handler+" "+t.sourceURL+":"+t.line+" - "+t.name+": "+t.message):t.fileName?("undefined"!=typeof console&&(console.trace(),console.error(this.handler," - error - ",t,t.message)),u.fatal("error: "+this.handler+" "+t.fileName+":"+t.lineNumber+" - "+t.name+": "+t.message)):u.fatal("error: "+t.message+"\n"+t.stack),t}return e},toString:function(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}},u.TimedHandler=function(t,e){this.period=t,this.handler=e,this.lastCalled=(new Date).getTime(),this.user=!0},u.TimedHandler.prototype={run:function(){return this.lastCalled=(new Date).getTime(),this.handler()},reset:function(){this.lastCalled=(new Date).getTime()},toString:function(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}},u.Connection=function(t,e){this.service=t,this.options=e||{};var n=this.options.protocol||"";0===t.indexOf("ws:")||0===t.indexOf("wss:")||0===n.indexOf("ws")?this._proto=new u.Websocket(this):this._proto=new u.Bosh(this),this.jid="",this.domain=null,this.features=null,this._sasl_data={},this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._authentication={},this._idleTimeout=null,this._disconnectTimeout=null,this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.do_authentication=!0,this.paused=!1,this.restored=!1,this._data=[],this._uniqueId=0,this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout(l(this._onIdle,this),100),i.addCookies(this.options.cookies);for(var r in u._connectionPlugins)if(u._connectionPlugins.hasOwnProperty(r)){var o=u._connectionPlugins[r],a=function(){};a.prototype=o,this[r]=new a,this[r].init(this)}},u.Connection.prototype={reset:function(){this._proto._reset(),this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._authentication={},this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.restored=!1,this._data=[],this._requests=[],this._uniqueId=0},pause:function(){this.paused=!0},resume:function(){this.paused=!1},getUniqueId:function(t){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)});return"string"==typeof t||"number"==typeof t?e+":"+t:e+""},connect:function(t,e,n,r,i,o,a){this.jid=t,this.authzid=u.getBareJidFromJid(this.jid),this.authcid=a||u.getNodeFromJid(this.jid),this.pass=e,this.servtype="xmpp",this.connect_callback=n,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.restored=!1,this.domain=u.getDomainFromJid(this.jid),this._changeConnectStatus(u.Status.CONNECTING,null),this._proto._connect(r,i,o)},attach:function(t,e,n,r,i,o,a){if(!(this._proto instanceof u.Bosh))throw{name:"StropheSessionError",message:'The "attach" method can only be used with a BOSH connection.'};this._proto._attach(t,e,n,r,i,o,a)},restore:function(t,e,n,r,i){if(!this._sessionCachingSupported())throw{name:"StropheSessionError",message:'The "restore" method can only be used with a BOSH connection.'};this._proto._restore(t,e,n,r,i)},_sessionCachingSupported:function(){if(this._proto instanceof u.Bosh){if(!JSON)return!1;try{window.sessionStorage.setItem("_strophe_","_strophe_"),window.sessionStorage.removeItem("_strophe_")}catch(t){return!1}return!0}return!1},xmlInput:function(t){},xmlOutput:function(t){},rawInput:function(t){},rawOutput:function(t){},nextValidRid:function(t){},send:function(t){if(null!==t){if("function"==typeof t.sort)for(var e=0;e<t.length;e++)this._queueData(t[e]);else"function"==typeof t.tree?this._queueData(t.tree()):this._queueData(t);this._proto._send()}},flush:function(){clearTimeout(this._idleTimeout),this._onIdle()},sendIQ:function(t,e,n,r){var i=null,o=this;"function"==typeof t.tree&&(t=t.tree());var a=t.getAttribute("id");a||(a=this.getUniqueId("sendIQ"),t.setAttribute("id",a));var s=t.getAttribute("to"),c=this.jid,l=this.addHandler(function(t){i&&o.deleteTimedHandler(i);var r=!1,a=t.getAttribute("from");if(a!==s&&(s||a!==u.getBareJidFromJid(c)&&a!==u.getDomainFromJid(c)&&a!==c)||(r=!0),!r)throw{name:"StropheError",message:"Got answer to IQ from wrong jid:"+a+"\nExpected jid: "+s};var l=t.getAttribute("type");if("result"==l)e&&e(t);else{if("error"!=l)throw{name:"StropheError",message:"Got bad IQ type of "+l};n&&n(t)}},null,"iq",["error","result"],a);return r&&(i=this.addTimedHandler(r,function(){return o.deleteHandler(l),n&&n(null),!1})),this.send(t),a},_queueData:function(t){if(null===t||!t.tagName||!t.childNodes)throw{name:"StropheError",message:"Cannot queue non-DOMElement."};this._data.push(t)},_sendRestart:function(){this._data.push("restart"),this._proto._sendRestart(),this._idleTimeout=setTimeout(l(this._onIdle,this),100)},addTimedHandler:function(t,e){var n=new u.TimedHandler(t,e);return this.addTimeds.push(n),n},deleteTimedHandler:function(t){this.removeTimeds.push(t)},addHandler:function(t,e,n,r,i,o,a){var s=new u.Handler(t,e,n,r,i,o,a);return this.addHandlers.push(s),s},deleteHandler:function(t){this.removeHandlers.push(t);var e=this.addHandlers.indexOf(t);e>=0&&this.addHandlers.splice(e,1)},disconnect:function(t){if(this._changeConnectStatus(u.Status.DISCONNECTING,t),u.info("Disconnect was called because: "+t),this.connected){var e=!1;this.disconnecting=!0,this.authenticated&&(e=c({xmlns:u.NS.CLIENT,type:"unavailable"})),this._disconnectTimeout=this._addSysTimedHandler(3e3,l(this._onDisconnectTimeout,this)),this._proto._disconnect(e)}else u.info("Disconnect was called before Strophe connected to the server"),this._proto._abortAllRequests()},_changeConnectStatus:function(t,e){for(var n in u._connectionPlugins)if(u._connectionPlugins.hasOwnProperty(n)){var r=this[n];if(r.statusChanged)try{r.statusChanged(t,e)}catch(t){u.error(n+" plugin caused an exception changing status: "+t)}}if(this.connect_callback)try{this.connect_callback(t,e)}catch(t){u.error("User connection callback caused an exception: "+t)}},_doDisconnect:function(t){"number"==typeof this._idleTimeout&&clearTimeout(this._idleTimeout),null!==this._disconnectTimeout&&(this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null),u.info("_doDisconnect was called"),this._proto._doDisconnect(),this.authenticated=!1,this.disconnecting=!1,this.restored=!1,this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._changeConnectStatus(u.Status.DISCONNECTED,t),this.connected=!1},_dataRecv:function(t,e){u.info("_dataRecv called");var n=this._proto._reqToData(t);if(null!==n){this.xmlInput!==u.Connection.prototype.xmlInput&&(n.nodeName===this._proto.strip&&n.childNodes.length?this.xmlInput(n.childNodes[0]):this.xmlInput(n)),this.rawInput!==u.Connection.prototype.rawInput&&(e?this.rawInput(e):this.rawInput(u.serialize(n)));for(var r,i;this.removeHandlers.length>0;)i=this.removeHandlers.pop(),(r=this.handlers.indexOf(i))>=0&&this.handlers.splice(r,1);for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._proto._emptyQueue())this._doDisconnect();else{var o,a,s=n.getAttribute("type");if(null!==s&&"terminate"==s){if(this.disconnecting)return;return o=n.getAttribute("condition"),a=n.getElementsByTagName("conflict"),null!==o?("remote-stream-error"==o&&a.length>0&&(o="conflict"),this._changeConnectStatus(u.Status.CONNFAIL,o)):this._changeConnectStatus(u.Status.CONNFAIL,"unknown"),void this._doDisconnect(o)}var c=this;u.forEachChild(n,null,function(t){var e,n;for(n=c.handlers,c.handlers=[],e=0;e<n.length;e++){var r=n[e];try{!r.isMatch(t)||!c.authenticated&&r.user?c.handlers.push(r):r.run(t)&&c.handlers.push(r)}catch(t){u.warn("Removing Strophe handlers due to uncaught exception: "+t.message)}}})}}},mechanisms:{},_connect_cb:function(t,e,n){u.info("_connect_cb was called"),this.connected=!0;var r;try{r=this._proto._reqToData(t)}catch(t){if("badformat"!=t)throw t;this._changeConnectStatus(u.Status.CONNFAIL,"bad-format"),this._doDisconnect("bad-format")}if(r&&(this.xmlInput!==u.Connection.prototype.xmlInput&&(r.nodeName===this._proto.strip&&r.childNodes.length?this.xmlInput(r.childNodes[0]):this.xmlInput(r)),this.rawInput!==u.Connection.prototype.rawInput&&(n?this.rawInput(n):this.rawInput(u.serialize(r))),this._proto._connect_cb(r)!==u.Status.CONNFAIL)){this._authentication.sasl_scram_sha1=!1,this._authentication.sasl_plain=!1,this._authentication.sasl_digest_md5=!1,this._authentication.sasl_anonymous=!1,this._authentication.legacy_auth=!1;var i;i=r.getElementsByTagNameNS?r.getElementsByTagNameNS(u.NS.STREAM,"features").length>0:r.getElementsByTagName("stream:features").length>0||r.getElementsByTagName("features").length>0;var o,a,s=r.getElementsByTagName("mechanism"),c=[];if(i){if(s.length>0)for(o=0;o<s.length;o++)a=u.getText(s[o]),this.mechanisms[a]&&c.push(this.mechanisms[a]);this._authentication.legacy_auth=r.getElementsByTagName("auth").length>0,this._authentication.legacy_auth||c.length>0?!1!==this.do_authentication&&this.authenticate(c):this._proto._no_auth_received(e)}else this._proto._no_auth_received(e)}},authenticate:function(t){var e;for(e=0;e<t.length-1;++e){for(var r=e,i=e+1;i<t.length;++i)t[i].prototype.priority>t[r].prototype.priority&&(r=i);if(r!=e){var o=t[e];t[e]=t[r],t[r]=o}}var c=!1;for(e=0;e<t.length;++e)if(t[e].prototype.test(this)){this._sasl_success_handler=this._addSysHandler(l(this._sasl_success_cb,this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(l(this._sasl_failure_cb,this),null,"failure",null,null),this._sasl_challenge_handler=this._addSysHandler(l(this._sasl_challenge_cb,this),null,"challenge",null,null),this._sasl_mechanism=new t[e],this._sasl_mechanism.onStart(this);var d=a("auth",{xmlns:u.NS.SASL,mechanism:this._sasl_mechanism.name});if(this._sasl_mechanism.isClientFirst){var f=this._sasl_mechanism.onChallenge(this,null);d.t(n.encode(f))}this.send(d.tree()),c=!0;break}c||(null===u.getNodeFromJid(this.jid)?(this._changeConnectStatus(u.Status.CONNFAIL,"x-strophe-bad-non-anon-jid"),this.disconnect("x-strophe-bad-non-anon-jid")):(this._changeConnectStatus(u.Status.AUTHENTICATING,null),this._addSysHandler(l(this._auth1_cb,this),null,null,null,"_auth_1"),this.send(s({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:u.NS.AUTH}).c("username",{}).t(u.getNodeFromJid(this.jid)).tree())))},_sasl_challenge_cb:function(t){var e=n.decode(u.getText(t)),r=this._sasl_mechanism.onChallenge(this,e),i=a("response",{xmlns:u.NS.SASL});return""!==r&&i.t(n.encode(r)),this.send(i.tree()),!0},_auth1_cb:function(t){var e=s({type:"set",id:"_auth_2"}).c("query",{xmlns:u.NS.AUTH}).c("username",{}).t(u.getNodeFromJid(this.jid)).up().c("password").t(this.pass);return u.getResourceFromJid(this.jid)||(this.jid=u.getBareJidFromJid(this.jid)+"/strophe"),e.up().c("resource",{}).t(u.getResourceFromJid(this.jid)),this._addSysHandler(l(this._auth2_cb,this),null,null,null,"_auth_2"),this.send(e.tree()),!1},_sasl_success_cb:function(t){if(this._sasl_data["server-signature"]){var e,r=/([a-z]+)=([^,]+)(,|$)/,i=n.decode(u.getText(t)).match(r);if("v"==i[1]&&(e=i[2]),e!=this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data={},this._sasl_failure_cb(null)}u.info("SASL authentication succeeded."),this._sasl_mechanism&&this._sasl_mechanism.onSuccess(),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null);var o=[],a=function(t,e){for(;t.length;)this.deleteHandler(t.pop());return l(this._sasl_auth1_cb,this)(e),!1};return o.push(this._addSysHandler(l(function(t){l(a,this)(o,t)},this),null,"stream:features",null,null)),o.push(this._addSysHandler(l(function(t){l(a,this)(o,t)},this),u.NS.STREAM,"features",null,null)),this._sendRestart(),!1},_sasl_auth1_cb:function(t){this.features=t;var e,n;for(e=0;e<t.childNodes.length;e++)"bind"==(n=t.childNodes[e]).nodeName&&(this.do_bind=!0),"session"==n.nodeName&&(this.do_session=!0);if(!this.do_bind)return this._changeConnectStatus(u.Status.AUTHFAIL,null),!1;this._addSysHandler(l(this._sasl_bind_cb,this),null,null,null,"_bind_auth_2");var r=u.getResourceFromJid(this.jid);return r?this.send(s({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:u.NS.BIND}).c("resource",{}).t(r).tree()):this.send(s({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:u.NS.BIND}).tree()),!1},_sasl_bind_cb:function(t){if("error"==t.getAttribute("type")){u.info("SASL binding failed.");var e;return t.getElementsByTagName("conflict").length>0&&(e="conflict"),this._changeConnectStatus(u.Status.AUTHFAIL,e),!1}var n,r=t.getElementsByTagName("bind");if(!(r.length>0))return u.info("SASL binding failed."),this._changeConnectStatus(u.Status.AUTHFAIL,null),!1;(n=r[0].getElementsByTagName("jid")).length>0&&(this.jid=u.getText(n[0]),this.do_session?(this._addSysHandler(l(this._sasl_session_cb,this),null,null,null,"_session_auth_2"),this.send(s({type:"set",id:"_session_auth_2"}).c("session",{xmlns:u.NS.SESSION}).tree())):(this.authenticated=!0,this._changeConnectStatus(u.Status.CONNECTED,null)))},_sasl_session_cb:function(t){if("result"==t.getAttribute("type"))this.authenticated=!0,this._changeConnectStatus(u.Status.CONNECTED,null);else if("error"==t.getAttribute("type"))return u.info("Session creation failed."),this._changeConnectStatus(u.Status.AUTHFAIL,null),!1;return!1},_sasl_failure_cb:function(t){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_mechanism&&this._sasl_mechanism.onFailure(),this._changeConnectStatus(u.Status.AUTHFAIL,null),!1},_auth2_cb:function(t){return"result"==t.getAttribute("type")?(this.authenticated=!0,this._changeConnectStatus(u.Status.CONNECTED,null)):"error"==t.getAttribute("type")&&(this._changeConnectStatus(u.Status.AUTHFAIL,null),this.disconnect("authentication failed")),!1},_addSysTimedHandler:function(t,e){var n=new u.TimedHandler(t,e);return n.user=!1,this.addTimeds.push(n),n},_addSysHandler:function(t,e,n,r,i){var o=new u.Handler(t,e,n,r,i);return o.user=!1,this.addHandlers.push(o),o},_onDisconnectTimeout:function(){return u.info("_onDisconnectTimeout was called"),this._changeConnectStatus(u.Status.CONNTIMEOUT,null),this._proto._onDisconnectTimeout(),this._doDisconnect(),!1},_onIdle:function(){for(var t,e,n;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;)e=this.removeTimeds.pop(),(t=this.timedHandlers.indexOf(e))>=0&&this.timedHandlers.splice(t,1);var r=(new Date).getTime();for(n=[],t=0;t<this.timedHandlers.length;t++)e=this.timedHandlers[t],!this.authenticated&&e.user||(e.lastCalled+e.period-r<=0?e.run()&&n.push(e):n.push(e));this.timedHandlers=n,clearTimeout(this._idleTimeout),this._proto._onIdle(),this.connected&&(this._idleTimeout=setTimeout(l(this._onIdle,this),100))}},u.SASLMechanism=function(t,e,n){this.name=t,this.isClientFirst=e,this.priority=n},u.SASLMechanism.prototype={test:function(t){return!0},onStart:function(t){this._connection=t},onChallenge:function(t,e){throw new Error("You should implement challenge handling!")},onFailure:function(){this._connection=null},onSuccess:function(){this._connection=null}},u.SASLAnonymous=function(){},u.SASLAnonymous.prototype=new u.SASLMechanism("ANONYMOUS",!1,10),u.SASLAnonymous.prototype.test=function(t){return null===t.authcid},u.Connection.prototype.mechanisms[u.SASLAnonymous.prototype.name]=u.SASLAnonymous,u.SASLPlain=function(){},u.SASLPlain.prototype=new u.SASLMechanism("PLAIN",!0,20),u.SASLPlain.prototype.test=function(t){return null!==t.authcid},u.SASLPlain.prototype.onChallenge=function(t){var e=t.authzid;return e+="\0",e+=t.authcid,e+="\0",e+=t.pass,i.utf16to8(e)},u.Connection.prototype.mechanisms[u.SASLPlain.prototype.name]=u.SASLPlain,u.SASLSHA1=function(){},u.SASLSHA1.prototype=new u.SASLMechanism("SCRAM-SHA-1",!0,40),u.SASLSHA1.prototype.test=function(t){return null!==t.authcid},u.SASLSHA1.prototype.onChallenge=function(t,o,a){var s=a||r.hexdigest(1234567890*Math.random()),c="n="+i.utf16to8(t.authcid);return c+=",r=",c+=s,t._sasl_data.cnonce=s,t._sasl_data["client-first-message-bare"]=c,c="n,,"+c,this.onChallenge=l(function(t,r){for(var o,a,s,c,u,l,d,f,h,p,m,g="c=biws,",v=t._sasl_data["client-first-message-bare"]+","+r+",",_=t._sasl_data.cnonce,b=/([a-z]+)=([^,]+)(,|$)/;r.match(b);){var y=r.match(b);switch(r=r.replace(y[0],""),y[1]){case"r":o=y[2];break;case"s":a=y[2];break;case"i":s=y[2]}}if(o.substr(0,_.length)!==_)return t._sasl_data={},t._sasl_failure_cb();v+=g+="r="+o,a=n.decode(a),a+="\0\0\0";var w=i.utf16to8(t.pass);for(c=l=e.core_hmac_sha1(w,a),d=1;d<s;d++){for(u=e.core_hmac_sha1(w,e.binb2str(l)),f=0;f<5;f++)c[f]^=u[f];l=u}for(c=e.binb2str(c),h=e.core_hmac_sha1(c,"Client Key"),p=e.str_hmac_sha1(c,"Server Key"),m=e.core_hmac_sha1(e.str_sha1(e.binb2str(h)),v),t._sasl_data["server-signature"]=e.b64_hmac_sha1(p,v),f=0;f<5;f++)h[f]^=m[f];return g+=",p="+n.encode(e.binb2str(h))},this),c},u.Connection.prototype.mechanisms[u.SASLSHA1.prototype.name]=u.SASLSHA1,u.SASLMD5=function(){},u.SASLMD5.prototype=new u.SASLMechanism("DIGEST-MD5",!1,30),u.SASLMD5.prototype.test=function(t){return null!==t.authcid},u.SASLMD5.prototype._quote=function(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},u.SASLMD5.prototype.onChallenge=function(t,e,n){for(var o,a=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/,s=n||r.hexdigest(""+1234567890*Math.random()),c="",u=null,d="";e.match(a);)switch(o=e.match(a),e=e.replace(o[0],""),o[2]=o[2].replace(/^"(.+)"$/,"$1"),o[1]){case"realm":c=o[2];break;case"nonce":d=o[2];break;case"qop":o[2];break;case"host":u=o[2]}var f=t.servtype+"/"+t.domain;null!==u&&(f=f+"/"+u);var h=i.utf16to8(t.authcid+":"+c+":"+this._connection.pass),p=r.hash(h)+":"+d+":"+s,m="AUTHENTICATE:"+f,g="";return g+="charset=utf-8,",g+="username="+this._quote(i.utf16to8(t.authcid))+",",g+="realm="+this._quote(c)+",",g+="nonce="+this._quote(d)+",",g+="nc=00000001,",g+="cnonce="+this._quote(s)+",",g+="digest-uri="+this._quote(f)+",",g+="response="+r.hexdigest(r.hexdigest(p)+":"+d+":00000001:"+s+":auth:"+r.hexdigest(m))+",",g+="qop=auth",this.onChallenge=l(function(){return""},this),g},u.Connection.prototype.mechanisms[u.SASLMD5.prototype.name]=u.SASLMD5,u.SASLOAuthBearer=function(){},u.SASLOAuthBearer.prototype=new u.SASLMechanism("OAUTHBEARER",!0,50),u.SASLOAuthBearer.prototype.test=function(t){return null!==t.authcid},u.SASLOAuthBearer.prototype.onChallenge=function(t){var e="n,a=";return e+=t.authzid,e+=",",e+="",e+="auth=Bearer ",e+=t.pass,e+="",e+="",i.utf16to8(e)},u.Connection.prototype.mechanisms[u.SASLOAuthBearer.prototype.name]=u.SASLOAuthBearer,u.SASLExternal=function(){},u.SASLExternal.prototype=new u.SASLMechanism("EXTERNAL",!0,60),u.SASLExternal.prototype.onChallenge=function(t){return t.authcid===t.authzid?"":t.authzid},u.Connection.prototype.mechanisms[u.SASLExternal.prototype.name]=u.SASLExternal,{Strophe:u,$build:a,$msg:function(t){return new u.Builder("message",t)},$iq:s,$pres:c,SHA1:e,Base64:n,MD5:r,polyfills:o}}),function(t,e){if("function"!=typeof define||!define.amd)return e(t.Strophe,t.$build,t.polyfills);define("strophe-bosh",["strophe-core"],function(t){return e(t.Strophe,t.$build,t.polyfills)})}(this,function(t,e,n){var r=n.bind;return t.Request=function(e,n,r,i){this.id=++t._requestId,this.xmlData=e,this.data=t.serialize(e),this.origFunc=n,this.func=n,this.rid=r,this.date=NaN,this.sends=i||0,this.abort=!1,this.dead=null,this.age=function(){return this.date?(new Date-this.date)/1e3:0},this.timeDead=function(){return this.dead?(new Date-this.dead)/1e3:0},this.xhr=this._newXHR()},t.Request.prototype={getResponse:function(){var e=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if("parsererror"==(e=this.xhr.responseXML.documentElement).tagName)throw t.error("invalid response received"),t.error("responseText: "+this.xhr.responseText),t.error("responseXML: "+t.serialize(this.xhr.responseXML)),"parsererror"}else if(this.xhr.responseText)throw t.error("invalid response received"),t.error("responseText: "+this.xhr.responseText),"badformat";return e},_newXHR:function(){var t=null;return window.XMLHttpRequest?(t=new XMLHttpRequest).overrideMimeType&&t.overrideMimeType("text/xml; charset=utf-8"):window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),t.onreadystatechange=r(this.func,null,this),t}},t.Bosh=function(t){this._conn=t,this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.hold=1,this.wait=60,this.window=5,this.errors=0,this._requests=[]},t.Bosh.prototype={strip:null,_buildBody:function(){var n=e("body",{rid:this.rid++,xmlns:t.NS.HTTPBIND});return null!==this.sid&&n.attrs({sid:this.sid}),this._conn.options.keepalive&&this._conn._sessionCachingSupported()&&this._cacheSession(),n},_reset:function(){this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.errors=0,this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_connect:function(e,n,i){this.wait=e||this.wait,this.hold=n||this.hold,this.errors=0;var o=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":t.NS.BOSH});i&&o.attrs({route:i});var a=this._conn._connect_cb;this._requests.push(new t.Request(o.tree(),r(this._onRequestStateChange,this,r(a,this._conn)),o.tree().getAttribute("rid"))),this._throttledRequestHandler()},_attach:function(e,n,r,i,o,a,s){this._conn.jid=e,this.sid=n,this.rid=r,this._conn.connect_callback=i,this._conn.domain=t.getDomainFromJid(this._conn.jid),this._conn.authenticated=!0,this._conn.connected=!0,this.wait=o||this.wait,this.hold=a||this.hold,this.window=s||this.window,this._conn._changeConnectStatus(t.Status.ATTACHED,null)},_restore:function(e,n,r,i,o){var a=JSON.parse(window.sessionStorage.getItem("strophe-bosh-session"));if(!(void 0!==a&&null!==a&&a.rid&&a.sid&&a.jid)||void 0!==e&&null!==e&&t.getBareJidFromJid(a.jid)!=t.getBareJidFromJid(e))throw{name:"StropheSessionError",message:"_restore: no restoreable session."};this._conn.restored=!0,this._attach(a.jid,a.sid,a.rid,n,r,i,o)},_cacheSession:function(){this._conn.authenticated?this._conn.jid&&this.rid&&this.sid&&window.sessionStorage.setItem("strophe-bosh-session",JSON.stringify({jid:this._conn.jid,rid:this.rid,sid:this.sid})):window.sessionStorage.removeItem("strophe-bosh-session")},_connect_cb:function(e){var n,r,i=e.getAttribute("type");if(null!==i&&"terminate"==i)return n=e.getAttribute("condition"),t.error("BOSH-Connection failed: "+n),r=e.getElementsByTagName("conflict"),null!==n?("remote-stream-error"==n&&r.length>0&&(n="conflict"),this._conn._changeConnectStatus(t.Status.CONNFAIL,n)):this._conn._changeConnectStatus(t.Status.CONNFAIL,"unknown"),this._conn._doDisconnect(n),t.Status.CONNFAIL;this.sid||(this.sid=e.getAttribute("sid"));var o=e.getAttribute("requests");o&&(this.window=parseInt(o,10));var a=e.getAttribute("hold");a&&(this.hold=parseInt(a,10));var s=e.getAttribute("wait");s&&(this.wait=parseInt(s,10))},_disconnect:function(t){this._sendTerminate(t)},_doDisconnect:function(){this.sid=null,this.rid=Math.floor(4294967295*Math.random()),this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_emptyQueue:function(){return 0===this._requests.length},_hitError:function(e){this.errors++,t.warn("request errored, status: "+e+", number of errors: "+this.errors),this.errors>4&&this._conn._onDisconnectTimeout()},_no_auth_received:function(e){e=e?r(e,this._conn):r(this._conn._connect_cb,this._conn);var n=this._buildBody();this._requests.push(new t.Request(n.tree(),r(this._onRequestStateChange,this,r(e,this._conn)),n.tree().getAttribute("rid"))),this._throttledRequestHandler()},_onDisconnectTimeout:function(){this._abortAllRequests()},_abortAllRequests:function(){for(var t;this._requests.length>0;)(t=this._requests.pop()).abort=!0,t.xhr.abort(),t.xhr.onreadystatechange=function(){}},_onIdle:function(){var e=this._conn._data;if(this._conn.authenticated&&0===this._requests.length&&0===e.length&&!this._conn.disconnecting&&(t.info("no requests during idle cycle, sending blank request"),e.push(null)),!this._conn.paused){if(this._requests.length<2&&e.length>0){for(var n=this._buildBody(),i=0;i<e.length;i++)null!==e[i]&&("restart"===e[i]?n.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":t.NS.BOSH}):n.cnode(e[i]).up());delete this._conn._data,this._conn._data=[],this._requests.push(new t.Request(n.tree(),r(this._onRequestStateChange,this,r(this._conn._dataRecv,this._conn)),n.tree().getAttribute("rid"))),this._throttledRequestHandler()}if(this._requests.length>0){var o=this._requests[0].age();null!==this._requests[0].dead&&this._requests[0].timeDead()>Math.floor(t.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),o>Math.floor(t.TIMEOUT*this.wait)&&(t.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(t.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())}}},_onRequestStateChange:function(e,n){if(t.debug("request id "+n.id+"."+n.sends+" state changed to "+n.xhr.readyState),n.abort)n.abort=!1;else{var r;if(4==n.xhr.readyState){r=0;try{r=n.xhr.status}catch(t){}if(void 0===r&&(r=0),this.disconnecting&&r>=400)return void this._hitError(r);var i=this._requests[0]==n,o=this._requests[1]==n;(r>0&&r<500||n.sends>5)&&(this._removeRequest(n),t.debug("request id "+n.id+" should now be removed")),200==r?((o||i&&this._requests.length>0&&this._requests[0].age()>Math.floor(t.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),this._conn.nextValidRid(Number(n.rid)+1),t.debug("request id "+n.id+"."+n.sends+" got 200"),e(n),this.errors=0):(t.error("request id "+n.id+"."+n.sends+" error "+r+" happened"),(0===r||r>=400&&r<600||r>=12e3)&&(this._hitError(r),r>=400&&r<500&&(this._conn._changeConnectStatus(t.Status.DISCONNECTING,null),this._conn._doDisconnect()))),r>0&&r<500||n.sends>5||this._throttledRequestHandler()}}},_processRequest:function(e){var n=this,r=this._requests[e],i=-1;try{4==r.xhr.readyState&&(i=r.xhr.status)}catch(n){t.error("caught an error in _requests["+e+"], reqStatus: "+i)}if(void 0===i&&(i=-1),r.sends>this._conn.maxRetries)this._conn._onDisconnectTimeout();else{var o=r.age(),a=!isNaN(o)&&o>Math.floor(t.TIMEOUT*this.wait),s=null!==r.dead&&r.timeDead()>Math.floor(t.SECONDARY_TIMEOUT*this.wait),c=4==r.xhr.readyState&&(i<1||i>=500);if((a||s||c)&&(s&&t.error("Request "+this._requests[e].id+" timed out (secondary), restarting"),r.abort=!0,r.xhr.abort(),r.xhr.onreadystatechange=function(){},this._requests[e]=new t.Request(r.xmlData,r.origFunc,r.rid,r.sends),r=this._requests[e]),0===r.xhr.readyState){t.debug("request id "+r.id+"."+r.sends+" posting");try{var u=this._conn.options.contentType||"text/xml; charset=utf-8";r.xhr.open("POST",this._conn.service,!this._conn.options.sync),r.xhr.setRequestHeader("Content-Type",u),this._conn.options.withCredentials&&(r.xhr.withCredentials=!0)}catch(e){return t.error("XHR open failed."),this._conn.connected||this._conn._changeConnectStatus(t.Status.CONNFAIL,"bad-service"),void this._conn.disconnect()}var l=function(){if(r.date=new Date,n._conn.options.customHeaders){var t=n._conn.options.customHeaders;for(var e in t)t.hasOwnProperty(e)&&r.xhr.setRequestHeader(e,t[e])}r.xhr.send(r.data)};if(r.sends>1){var d=1e3*Math.min(Math.floor(t.TIMEOUT*this.wait),Math.pow(r.sends,3));setTimeout(function(){l()},d)}else l();r.sends++,this._conn.xmlOutput!==t.Connection.prototype.xmlOutput&&(r.xmlData.nodeName===this.strip&&r.xmlData.childNodes.length?this._conn.xmlOutput(r.xmlData.childNodes[0]):this._conn.xmlOutput(r.xmlData)),this._conn.rawOutput!==t.Connection.prototype.rawOutput&&this._conn.rawOutput(r.data)}else t.debug("_processRequest: "+(0===e?"first":"second")+" request has readyState of "+r.xhr.readyState)}},_removeRequest:function(e){t.debug("removing request");var n;for(n=this._requests.length-1;n>=0;n--)e==this._requests[n]&&this._requests.splice(n,1);e.xhr.onreadystatechange=function(){},this._throttledRequestHandler()},_restartRequest:function(t){var e=this._requests[t];null===e.dead&&(e.dead=new Date),this._processRequest(t)},_reqToData:function(t){try{return t.getResponse()}catch(t){if("parsererror"!=t)throw t;this._conn.disconnect("strophe-parsererror")}},_sendTerminate:function(e){t.info("_sendTerminate was called");var n=this._buildBody().attrs({type:"terminate"});e&&n.cnode(e.tree());var i=new t.Request(n.tree(),r(this._onRequestStateChange,this,r(this._conn._dataRecv,this._conn)),n.tree().getAttribute("rid"));this._requests.push(i),this._throttledRequestHandler()},_send:function(){clearTimeout(this._conn._idleTimeout),this._throttledRequestHandler(),this._conn._idleTimeout=setTimeout(r(this._conn._onIdle,this._conn),100)},_sendRestart:function(){this._throttledRequestHandler(),clearTimeout(this._conn._idleTimeout)},_throttledRequestHandler:function(){this._requests?t.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):t.debug("_throttledRequestHandler called with undefined requests"),this._requests&&0!==this._requests.length&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))}},t}),function(t,e){if("function"!=typeof define||!define.amd)return e(t.Strophe,t.$build,t.polyfills);define("strophe-websocket",["strophe-core"],function(t){return e(t.Strophe,t.$build)})}(this,function(t,e,n){var r=n.bind;return t.Websocket=function(t){this._conn=t,this.strip="wrapper";var e=t.service;if(0!==e.indexOf("ws:")&&0!==e.indexOf("wss:")){var n="";"ws"===t.options.protocol&&"https:"!==window.location.protocol?n+="ws":n+="wss",n+="://"+window.location.host,0!==e.indexOf("/")?n+=window.location.pathname+e:n+=e,t.service=n}},t.Websocket.prototype={_buildStream:function(){return e("open",{xmlns:t.NS.FRAMING,to:this._conn.domain,version:"1.0"})},_check_streamerror:function(e,n){var r;if(0===(r=e.getElementsByTagNameNS?e.getElementsByTagNameNS(t.NS.STREAM,"error"):e.getElementsByTagName("stream:error")).length)return!1;for(var i=r[0],o="",a="",s=0;s<i.childNodes.length;s++){var c=i.childNodes[s];if("urn:ietf:params:xml:ns:xmpp-streams"!==c.getAttribute("xmlns"))break;"text"===c.nodeName?a=c.textContent:o=c.nodeName}var u="WebSocket stream error: ";return u+=o||"unknown",a&&(u+=" - "+o),t.error(u),this._conn._changeConnectStatus(n,o),this._conn._doDisconnect(),!0},_reset:function(){},_connect:function(){this._closeSocket(),this.socket=new WebSocket(this._conn.service,"xmpp"),this.socket.onopen=r(this._onOpen,this),this.socket.onerror=r(this._onError,this),this.socket.onclose=r(this._onClose,this),this.socket.onmessage=r(this._connect_cb_wrapper,this)},_connect_cb:function(e){if(this._check_streamerror(e,t.Status.CONNFAIL))return t.Status.CONNFAIL},_handleStreamStart:function(e){var n=!1,r=e.getAttribute("xmlns");"string"!=typeof r?n="Missing xmlns in <open />":r!==t.NS.FRAMING&&(n="Wrong xmlns in <open />: "+r);var i=e.getAttribute("version");return"string"!=typeof i?n="Missing version in <open />":"1.0"!==i&&(n="Wrong version in <open />: "+i),!n||(this._conn._changeConnectStatus(t.Status.CONNFAIL,n),this._conn._doDisconnect(),!1)},_connect_cb_wrapper:function(e){if(0===e.data.indexOf("<open ")||0===e.data.indexOf("<?xml")){var n=e.data.replace(/^(<\?.*?\?>\s*)*/,"");if(""===n)return;var i=(new DOMParser).parseFromString(n,"text/xml").documentElement;this._conn.xmlInput(i),this._conn.rawInput(e.data),this._handleStreamStart(i)&&this._connect_cb(i)}else if(0===e.data.indexOf("<close ")){this._conn.rawInput(e.data),this._conn.xmlInput(e);var o=e.getAttribute("see-other-uri");o?(this._conn._changeConnectStatus(t.Status.REDIRECT,"Received see-other-uri, resetting connection"),this._conn.reset(),this._conn.service=o,this._connect()):(this._conn._changeConnectStatus(t.Status.CONNFAIL,"Received closing stream"),this._conn._doDisconnect())}else{var a=this._streamWrap(e.data),s=(new DOMParser).parseFromString(a,"text/xml").documentElement;this.socket.onmessage=r(this._onMessage,this),this._conn._connect_cb(s,null,e.data)}},_disconnect:function(n){if(this.socket&&this.socket.readyState!==WebSocket.CLOSED){n&&this._conn.send(n);var r=e("close",{xmlns:t.NS.FRAMING});this._conn.xmlOutput(r);var i=t.serialize(r);this._conn.rawOutput(i);try{this.socket.send(i)}catch(e){t.info("Couldn't send <close /> tag.")}}this._conn._doDisconnect()},_doDisconnect:function(){t.info("WebSockets _doDisconnect was called"),this._closeSocket()},_streamWrap:function(t){return"<wrapper>"+t+"</wrapper>"},_closeSocket:function(){if(this.socket)try{this.socket.close()}catch(t){}this.socket=null},_emptyQueue:function(){return!0},_onClose:function(){this._conn.connected&&!this._conn.disconnecting?(t.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):t.info("Websocket closed")},_no_auth_received:function(e){t.error("Server did not send any auth methods"),this._conn._changeConnectStatus(t.Status.CONNFAIL,"Server did not send any auth methods"),e&&(e=r(e,this._conn))(),this._conn._doDisconnect()},_onDisconnectTimeout:function(){},_abortAllRequests:function(){},_onError:function(e){t.error("Websocket error "+e),this._conn._changeConnectStatus(t.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._disconnect()},_onIdle:function(){var e=this._conn._data;if(e.length>0&&!this._conn.paused){for(var n=0;n<e.length;n++)if(null!==e[n]){var r,i;r="restart"===e[n]?this._buildStream().tree():e[n],i=t.serialize(r),this._conn.xmlOutput(r),this._conn.rawOutput(i),this.socket.send(i)}this._conn._data=[]}},_onMessage:function(e){var n,r,i='<close xmlns="urn:ietf:params:xml:ns:xmpp-framing" />';if(e.data===i)return this._conn.rawInput(i),this._conn.xmlInput(e),void(this._conn.disconnecting||this._conn._doDisconnect());if(0===e.data.search("<open ")){if(n=(new DOMParser).parseFromString(e.data,"text/xml").documentElement,!this._handleStreamStart(n))return}else r=this._streamWrap(e.data),n=(new DOMParser).parseFromString(r,"text/xml").documentElement;return this._check_streamerror(n,t.Status.ERROR)?void 0:this._conn.disconnecting&&"presence"===n.firstChild.nodeName&&"unavailable"===n.firstChild.getAttribute("type")?(this._conn.xmlInput(n),void this._conn.rawInput(t.serialize(n))):void this._conn._dataRecv(n,e.data)},_onOpen:function(){t.info("Websocket open");var e=this._buildStream();this._conn.xmlOutput(e.tree());var n=t.serialize(e);this._conn.rawOutput(n),this.socket.send(n)},_reqToData:function(t){return t},_send:function(){this._conn.flush()},_sendRestart:function(){clearTimeout(this._conn._idleTimeout),r(this._conn._onIdle,this._conn)()}},t})},{}],14:[function(t,e,n){!function(){"use strict";function t(){for(var e=[],r=0;r<arguments.length;r++){var i=arguments[r];if(i){var o=typeof i;if("string"===o||"number"===o)e.push(i);else if(Array.isArray(i))e.push(t.apply(null,i));else if("object"===o)for(var a in i)n.call(i,a)&&i[a]&&e.push(a)}}return e.join(" ")}var n={}.hasOwnProperty;void 0!==e&&e.exports?e.exports=t:"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("classnames",[],function(){return t}):window.classNames=t}()},{}],15:[function(t,e,n){"use strict";n.consoleFormat=t("./lib/console-format.js");var r=n.isEmoji=t("./lib/is-emoji.js"),i=n.split=t("./parsers/unicode-and-emoji.js").parse;n.withoutEmoji=function(t){var e=i(t);return e?e.filter(function(t){return!r(t)}):e},n.onlyEmoji=function(t){var e=i(t);return e?e.filter(function(t){return r(t)}):e}},{"./lib/console-format.js":16,"./lib/is-emoji.js":17,"./parsers/unicode-and-emoji.js":19}],16:[function(t,e,n){"use strict";var r=t("./is-emoji.js"),i=t("../parsers/unicode-and-emoji.js").parse;e.exports=function(t){var e="";return i(t).forEach(function(t){e+=r(t)?t+" ":t}),e}},{"../parsers/unicode-and-emoji.js":19,"./is-emoji.js":17}],17:[function(t,e,n){"use strict";var r=t("../parsers/emoji.js").Emoji;e.exports=function(t){return r.parse(t).status}},{"../parsers/emoji.js":18}],18:[function(t,e,n){"use strict";var r=t("parsimmon"),i=t("lodash.flattendeep"),o=n.OptionalVariationSelector=r.regex(/[\uFE0E\uFE0F]{0,1}/).desc("an optional variation selector (\\uFE0E or \\uFE0F)"),a=r.seq(r.regex(/[0-9#*]/),o,r.string("")).desc("a keycap emoji"),s=r.regex(/\uD83C[\uDDE6-\uDDFF]/).times(2).desc("a flag emoji"),c=r.string("").desc("zero-width joiner (\\u200D)"),u=r.regex(/(\uD83C[\uDFFB-\uDFFF]){0,1}/).desc("an optional Fitzpatrick modifier"),l=r.alt(r.regex(/[\u203C-\u3299]/),r.regex(/[\u2702-\u27B0]/),s,r.regex(/\uD83C[\uDC04-\uDFFF]/),r.regex(/\uD83D[\uDC00-\uDFFF]/),r.regex(/\uD83E[\uDC00-\uDFFF]/),r.string(""),r.string("")),d=r.seq(l,o,r.seq(c,l,o).times(1,3)),f=n.Emoji=r.seq(r.alt(d,r.seq(l,o),a),u).map(function(t){return i(t).join("")});n.parseOne=function(t){var e=f.parse(t);return!!e.status&&e.value},n.parse=function(t){var e=f.many().parse(t);return!!e.status&&e.value}},{"lodash.flattendeep":31,parsimmon:36}],19:[function(t,e,n){"use strict";var r=t("./emoji.js").Emoji,i=t("parsimmon"),o=t("lodash.flattendeep"),a=i.regex(/[\uD800-\uDBFF][\uDC00-\uDFFF]/),s=n.Unicode=i.alt(r,i.regex(/[\u0000-\uD799]/),a);n.parseOne=function(t){var e=s.parse(t);return!!e.status&&o(e.value).join("")},n.parse=function(t){var e=s.many().parse(t);return!!e.status&&e.value.map(function(t){return o(t).join("")})}},{"./emoji.js":18,"lodash.flattendeep":31,parsimmon:36}],20:[function(e,n,r){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||t}function o(t){return"function"==typeof t}function a(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function c(t){return void 0===t}n.exports=i,i.EventEmitter=i,i.prototype._events=t,i.prototype._maxListeners=t,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!a(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,n,r,i,a,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(n=this._events[t],c(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(s(n))for(i=Array.prototype.slice.call(arguments,1),r=(u=n.slice()).length,a=0;a<r;a++)u[a].apply(this,i);return!0},i.prototype.addListener=function(t,e){var n;if(!o(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,o(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned&&(n=c(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!o(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},i.prototype.removeListener=function(t,e){var n,r,i,a;if(!o(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],i=n.length,r=-1,n===e||o(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(a=i;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],o(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?o(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(o(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},{}],21:[function(e,n,r){(function(e){"use strict";!function(e){function i(e){var n=arguments.length>1&&arguments[1]!==t?arguments[1]:{},r=[],i=0,c=void 0,u=void 0,l=void 0,d=void 0,f=void 0,h=void 0,p=void 0,m=void 0,g=void 0,v=void 0,_=void 0,b=void 0,y=void 0,w=void 0;if(isNaN(e))throw new Error("Invalid arguments");return l=!0===n.bits,_=!0===n.unix,u=n.base||2,v=n.round!==t?n.round:_?1:2,b=n.spacer!==t?n.spacer:_?"":" ",w=n.symbols||n.suffixes||{},y=2===u?n.standard||"jedec":"jedec",g=n.output||"string",f=!0===n.fullform,h=n.fullforms instanceof Array?n.fullforms:[],c=n.exponent!==t?n.exponent:-1,m=Number(e),p=m<0,d=u>2?1e3:1024,p&&(m=-m),(-1===c||isNaN(c))&&(c=Math.floor(Math.log(m)/Math.log(d)))<0&&(c=0),c>8&&(c=8),0===m?(r[0]=0,r[1]=_?"":a[y][l?"bits":"bytes"][c]):(i=m/(2===u?Math.pow(2,10*c):Math.pow(1e3,c)),l&&(i*=8)>=d&&c<8&&(i/=d,c++),r[0]=Number(i.toFixed(c>0?v:0)),r[1]=10===u&&1===c?l?"kb":"kB":a[y][l?"bits":"bytes"][c],_&&(r[1]="jedec"===y?r[1].charAt(0):c>0?r[1].replace(/B$/,""):r[1],o.test(r[1])&&(r[0]=Math.floor(r[0]),r[1]=""))),p&&(r[0]=-r[0]),r[1]=w[r[1]]||r[1],"array"===g?r:"exponent"===g?c:"object"===g?{value:r[0],suffix:r[1],symbol:r[1]}:(f&&(r[1]=h[c]?h[c]:s[y][c]+(l?"bit":"byte")+(1===r[0]?"":"s")),r.join(b))}var o=/^(b|B)$/,a={iec:{bits:["b","Kib","Mib","Gib","Tib","Pib","Eib","Zib","Yib"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},s={iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]};i.partial=function(t){return function(e){return i(e,t)}},void 0!==r?n.exports=i:"function"==typeof define&&define.amd?define(function(){return i}):e.filesize=i}("undefined"!=typeof window?window:e)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],22:[function(t,e,n){e.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},{}],23:[function(t,e,n){e.exports=function(t,e){for(var n=-1,r=t.length;++n<r&&!1!==e(t[n],n,t););return t}},{}],24:[function(t,e,n){var r=t("lodash._basecopy"),i=t("lodash.keys");e.exports=function(t,e){return null==e?t:r(e,i(e),t)}},{"lodash._basecopy":26,"lodash.keys":34}],25:[function(e,n,r){(function(r){function i(e,n,r,a,p,g,_){var b;if(r&&(b=p?r(e,a,p):r(e)),b!==t)return b;if(!l(e))return e;var w=m(e);if(w){if(b=s(e),!n)return d(e,b)}else{var O=U.call(e),T=O==y;if(O!=S&&O!=v&&(!T||p))return z[O]?u(e,O,n):p?e:{};if(b=c(T?{}:e),!n)return h(b,e)}g||(g=[]),_||(_=[]);for(var C=g.length;C--;)if(g[C]==e)return _[C];return g.push(e),_.push(b),(w?f:o)(e,function(t,o){b[o]=i(t,n,r,o,e,g,_)}),b}function o(t,e){return p(t,e,g)}function a(t){var e=new B(t.byteLength);return new H(e).set(new H(t)),e}function s(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&L.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function c(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=Object),new e}function u(t,e,n){var r=t.constructor;switch(e){case C:return a(t);case _:case b:return new r(+t);case x:case E:case A:case I:case R:case N:case k:case j:case M:var i=t.buffer;return new r(n?a(i):i,t.byteOffset,t.length);case w:case T:return new r(t);case O:var o=new r(t.source,D.exec(t));o.lastIndex=t.lastIndex}return o}function l(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var d=e("lodash._arraycopy"),f=e("lodash._arrayeach"),h=e("lodash._baseassign"),p=e("lodash._basefor"),m=e("lodash.isarray"),g=e("lodash.keys"),v="[object Arguments]",_="[object Boolean]",b="[object Date]",y="[object Function]",w="[object Number]",S="[object Object]",O="[object RegExp]",T="[object String]",C="[object ArrayBuffer]",x="[object Float32Array]",E="[object Float64Array]",A="[object Int8Array]",I="[object Int16Array]",R="[object Int32Array]",N="[object Uint8Array]",k="[object Uint8ClampedArray]",j="[object Uint16Array]",M="[object Uint32Array]",D=/\w*$/,z={};z[v]=z["[object Array]"]=z[C]=z[_]=z[b]=z[x]=z[E]=z[A]=z[I]=z[R]=z[w]=z[S]=z[O]=z[T]=z[N]=z[k]=z[j]=z[M]=!0,z["[object Error]"]=z[y]=z["[object Map]"]=z["[object Set]"]=z["[object WeakMap]"]=!1;var P=Object.prototype,L=P.hasOwnProperty,U=P.toString,B=r.ArrayBuffer,H=r.Uint8Array;n.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash._arraycopy":22,"lodash._arrayeach":23,"lodash._baseassign":24,"lodash._basefor":27,"lodash.isarray":33,"lodash.keys":34}],26:[function(t,e,n){e.exports=function(t,e,n){n||(n={});for(var r=-1,i=e.length;++r<i;){var o=e[r];n[o]=t[o]}return n}},{}],27:[function(t,e,n){var r=function(t){return function(e,n,r){for(var i=-1,o=Object(e),a=r(e),s=a.length;s--;){var c=a[t?s:++i];if(!1===n(o[c],c,o))break}return e}}();e.exports=r},{}],28:[function(e,n,r){function i(t){return t}n.exports=function(e,n,r){if("function"!=typeof e)return i;if(n===t)return e;switch(r){case 1:return function(t){return e.call(n,t)};case 3:return function(t,r,i){return e.call(n,t,r,i)};case 4:return function(t,r,i,o){return e.call(n,t,r,i,o)};case 5:return function(t,r,i,o,a){return e.call(n,t,r,i,o,a)}}return function(){return e.apply(n,arguments)}}},{}],29:[function(e,n,r){function i(t){return!!t&&"object"==typeof t}function o(t){return a(t)&&h.call(t)==c}function a(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function s(t){return null!=t&&(o(t)?p.test(d.call(t)):i(t)&&u.test(t))}var c="[object Function]",u=/^\[object .+?Constructor\]$/,l=Object.prototype,d=Function.prototype.toString,f=l.hasOwnProperty,h=l.toString,p=RegExp("^"+d.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");n.exports=function(e,n){var r=null==e?t:e[n];return s(r)?r:t}},{}],30:[function(t,e,n){var r=t("lodash._baseclone"),i=t("lodash._bindcallback");e.exports=function(t,e,n){return"function"==typeof e?r(t,!0,i(e,n,3)):r(t,!0)}},{"lodash._baseclone":25,"lodash._bindcallback":28}],31:[function(e,n,r){(function(e){function r(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function i(t,e,n,a,s){var c=-1,u=t.length;for(n||(n=o),s||(s=[]);++c<u;){var l=t[c];e>0&&n(l)?e>1?i(l,e-1,n,a,s):r(s,l):a||(s[s.length]=l)}return s}function o(t){return E(t)||a(t)||!!(x&&t&&t[x])}function a(t){return c(t)&&S.call(t,"callee")&&(!C.call(t,"callee")||O.call(t)==m)}function s(t){return null!=t&&l(t.length)&&!u(t)}function c(t){return f(t)&&s(t)}function u(t){var e=d(t)?O.call(t):"";return e==g||e==v}function l(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=p}function d(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function f(t){return!!t&&"object"==typeof t}var h=1/0,p=9007199254740991,m="[object Arguments]",g="[object Function]",v="[object GeneratorFunction]",_="object"==typeof e&&e&&e.Object===Object&&e,b="object"==typeof self&&self&&self.Object===Object&&self,y=_||b||Function("return this")(),w=Object.prototype,S=w.hasOwnProperty,O=w.toString,T=y.Symbol,C=w.propertyIsEnumerable,x=T?T.isConcatSpreadable:t,E=Array.isArray;n.exports=function(t){return(t?t.length:0)?i(t,h):[]}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],32:[function(t,e,n){function r(t){return null!=t&&a(t.length)&&!o(t)}function i(t){return c(t)&&r(t)}function o(t){var e=s(t)?m.call(t):"";return e==d||e==f}function a(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=u}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function c(t){return!!t&&"object"==typeof t}var u=9007199254740991,l="[object Arguments]",d="[object Function]",f="[object GeneratorFunction]",h=Object.prototype,p=h.hasOwnProperty,m=h.toString,g=h.propertyIsEnumerable;e.exports=function(t){return i(t)&&p.call(t,"callee")&&(!g.call(t,"callee")||m.call(t)==l)}},{}],33:[function(e,n,r){function i(t){return!!t&&"object"==typeof t}function o(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=g}function a(t){return s(t)&&p.call(t)==u}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function c(t){return null!=t&&(a(t)?m.test(f.call(t)):i(t)&&l.test(t))}var u="[object Function]",l=/^\[object .+?Constructor\]$/,d=Object.prototype,f=Function.prototype.toString,h=d.hasOwnProperty,p=d.toString,m=RegExp("^"+f.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),g=9007199254740991,v=function(e,n){var r=null==e?t:e[n];return c(r)?r:t}(Array,"isArray")||function(t){return i(t)&&o(t.length)&&"[object Array]"==p.call(t)};n.exports=v},{}],34:[function(e,n,r){function i(t){return null!=t&&a(v(t))}function o(t,e){return t="number"==typeof t||h.test(t)?+t:-1,e=null==e?g:e,t>-1&&t%1==0&&t<e}function a(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=g}function s(t){for(var e=u(t),n=e.length,r=n&&t.length,i=!!r&&a(r)&&(f(t)||d(t)),s=-1,c=[];++s<n;){var l=e[s];(i&&o(l,r)||p.call(t,l))&&c.push(l)}return c}function c(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function u(t){if(null==t)return[];c(t)||(t=Object(t));var e=t.length;e=e&&a(e)&&(f(t)||d(t))&&e||0;for(var n=t.constructor,r=-1,i="function"==typeof n&&n.prototype===t,s=Array(e),u=e>0;++r<e;)s[r]=r+"";for(var l in t)u&&o(l,e)||"constructor"==l&&(i||!p.call(t,l))||s.push(l);return s}var l=e("lodash._getnative"),d=e("lodash.isarguments"),f=e("lodash.isarray"),h=/^\d+$/,p=Object.prototype.hasOwnProperty,m=l(Object,"keys"),g=9007199254740991,v=function(e){return function(n){return null==n?t:n[e]}}("length"),_=m?function(e){var n=null==e?t:e.constructor;return"function"==typeof n&&n.prototype===e||"function"!=typeof e&&i(e)?s(e):c(e)?m(e):[]}:s;n.exports=_},{"lodash._getnative":29,"lodash.isarguments":32,"lodash.isarray":33}],35:[function(t,e,n){(function(t){(function(){function r(t,e){return t.set(e[0],e[1]),t}function i(t,e){return t.add(e),t}function o(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function a(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var a=t[i];e(r,a,n(a),t)}return r}function s(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function c(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function u(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function l(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function d(t,e){return!!(null==t?0:t.length)&&S(t,e,0)>-1}function f(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function h(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function p(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function m(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function g(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function v(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function _(t){return t.split("")}function b(t){return t.match(Le)||[]}function y(t,e,n){var r;return n(t,function(t,n,i){if(e(t,n,i))return r=n,!1}),r}function w(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function S(t,e,n){return e===e?X(t,e,n):w(t,T,n)}function O(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function T(t){return t!==t}function C(t,e){var n=null==t?0:t.length;return n?R(t,e)/n:jt}function x(t){return function(e){return null==e?nt:e[t]}}function E(t){return function(e){return null==t?nt:t[e]}}function A(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function I(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function R(t,e){for(var n,r=-1,i=t.length;++r<i;){var o=e(t[r]);o!==nt&&(n=n===nt?o:n+o)}return n}function N(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function k(t,e){return h(e,function(e){return[e,t[e]]})}function j(t){return function(e){return t(e)}}function M(t,e){return h(e,function(e){return t[e]})}function D(t,e){return t.has(e)}function z(t,e){for(var n=-1,r=t.length;++n<r&&S(e,t[n],0)>-1;);return n}function P(t,e){for(var n=t.length;n--&&S(e,t[n],0)>-1;);return n}function L(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}function U(t){return"\\"+Cn[t]}function B(t,e){return null==t?nt:t[e]}function H(t){return gn.test(t)}function F(t){return vn.test(t)}function q(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function $(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function V(t,e){return function(n){return t(e(n))}}function G(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n];a!==e&&a!==ct||(t[n]=ct,o[i++]=n)}return o}function J(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function W(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function X(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function Y(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}function Q(t){return H(t)?K(t):Fn(t)}function Z(t){return H(t)?tt(t):_(t)}function K(t){for(var e=pn.lastIndex=0;pn.test(t);)++e;return e}function tt(t){return t.match(pn)||[]}function et(t){return t.match(mn)||[]}var nt,rt=200,it="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",ot="Expected a function",at="__lodash_hash_undefined__",st=500,ct="__lodash_placeholder__",ut=1,lt=2,dt=4,ft=1,ht=2,pt=1,mt=2,gt=4,vt=8,_t=16,bt=32,yt=64,wt=128,St=256,Ot=512,Tt=30,Ct="...",xt=800,Et=16,At=1,It=2,Rt=1/0,Nt=9007199254740991,kt=1.7976931348623157e308,jt=NaN,Mt=4294967295,Dt=Mt-1,zt=Mt>>>1,Pt=[["ary",wt],["bind",pt],["bindKey",mt],["curry",vt],["curryRight",_t],["flip",Ot],["partial",bt],["partialRight",yt],["rearg",St]],Lt="[object Arguments]",Ut="[object Array]",Bt="[object AsyncFunction]",Ht="[object Boolean]",Ft="[object Date]",qt="[object DOMException]",$t="[object Error]",Vt="[object Function]",Gt="[object GeneratorFunction]",Jt="[object Map]",Wt="[object Number]",Xt="[object Null]",Yt="[object Object]",Qt="[object Proxy]",Zt="[object RegExp]",Kt="[object Set]",te="[object String]",ee="[object Symbol]",ne="[object Undefined]",re="[object WeakMap]",ie="[object WeakSet]",oe="[object ArrayBuffer]",ae="[object DataView]",se="[object Float32Array]",ce="[object Float64Array]",ue="[object Int8Array]",le="[object Int16Array]",de="[object Int32Array]",fe="[object Uint8Array]",he="[object Uint8ClampedArray]",pe="[object Uint16Array]",me="[object Uint32Array]",ge=/\b__p \+= '';/g,ve=/\b(__p \+=) '' \+/g,_e=/(__e\(.*?\)|\b__t\)) \+\n'';/g,be=/&(?:amp|lt|gt|quot|#39);/g,ye=/[&<>"']/g,we=RegExp(be.source),Se=RegExp(ye.source),Oe=/<%-([\s\S]+?)%>/g,Te=/<%([\s\S]+?)%>/g,Ce=/<%=([\s\S]+?)%>/g,xe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ee=/^\w*$/,Ae=/^\./,Ie=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Re=/[\\^$.*+?()[\]{}|]/g,Ne=RegExp(Re.source),ke=/^\s+|\s+$/g,je=/^\s+/,Me=/\s+$/,De=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ze=/\{\n\/\* \[wrapped with (.+)\] \*/,Pe=/,? & /,Le=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ue=/\\(\\)?/g,Be=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,He=/\w*$/,Fe=/^[-+]0x[0-9a-f]+$/i,qe=/^0b[01]+$/i,$e=/^\[object .+?Constructor\]$/,Ve=/^0o[0-7]+$/i,Ge=/^(?:0|[1-9]\d*)$/,Je=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,We=/($^)/,Xe=/['\n\r\u2028\u2029\\]/g,Ye="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Qe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ze="["+Qe+"]",Ke="["+Ye+"]",tn="[a-z\\xdf-\\xf6\\xf8-\\xff]",en="[^\\ud800-\\udfff"+Qe+"\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",nn="\\ud83c[\\udffb-\\udfff]",rn="(?:\\ud83c[\\udde6-\\uddff]){2}",on="[\\ud800-\\udbff][\\udc00-\\udfff]",an="[A-Z\\xc0-\\xd6\\xd8-\\xde]",sn="(?:"+tn+"|"+en+")",cn="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",un="[\\ufe0e\\ufe0f]?"+cn+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",rn,on].join("|")+")[\\ufe0e\\ufe0f]?"+cn+")*"),ln="(?:"+["[\\u2700-\\u27bf]",rn,on].join("|")+")"+un,dn="(?:"+["[^\\ud800-\\udfff]"+Ke+"?",Ke,rn,on,"[\\ud800-\\udfff]"].join("|")+")",fn=RegExp("[']","g"),hn=RegExp(Ke,"g"),pn=RegExp(nn+"(?="+nn+")|"+dn+un,"g"),mn=RegExp([an+"?"+tn+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[Ze,an,"$"].join("|")+")","(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[Ze,an+sn,"$"].join("|")+")",an+"?"+sn+"+(?:['](?:d|ll|m|re|s|t|ve))?",an+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)","\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)","\\d+",ln].join("|"),"g"),gn=RegExp("[\\u200d\\ud800-\\udfff"+Ye+"\\ufe0e\\ufe0f]"),vn=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,_n=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],bn=-1,yn={};yn[se]=yn[ce]=yn[ue]=yn[le]=yn[de]=yn[fe]=yn[he]=yn[pe]=yn[me]=!0,yn[Lt]=yn[Ut]=yn[oe]=yn[Ht]=yn[ae]=yn[Ft]=yn[$t]=yn[Vt]=yn[Jt]=yn[Wt]=yn[Yt]=yn[Zt]=yn[Kt]=yn[te]=yn[re]=!1;var wn={};wn[Lt]=wn[Ut]=wn[oe]=wn[ae]=wn[Ht]=wn[Ft]=wn[se]=wn[ce]=wn[ue]=wn[le]=wn[de]=wn[Jt]=wn[Wt]=wn[Yt]=wn[Zt]=wn[Kt]=wn[te]=wn[ee]=wn[fe]=wn[he]=wn[pe]=wn[me]=!0,wn[$t]=wn[Vt]=wn[re]=!1;var Sn={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"},On={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Tn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Cn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},xn=parseFloat,En=parseInt,An="object"==typeof t&&t&&t.Object===Object&&t,In="object"==typeof self&&self&&self.Object===Object&&self,Rn=An||In||Function("return this")(),Nn="object"==typeof n&&n&&!n.nodeType&&n,kn=Nn&&"object"==typeof e&&e&&!e.nodeType&&e,jn=kn&&kn.exports===Nn,Mn=jn&&An.process,Dn=function(){try{return Mn&&Mn.binding&&Mn.binding("util")}catch(t){}}(),zn=Dn&&Dn.isArrayBuffer,Pn=Dn&&Dn.isDate,Ln=Dn&&Dn.isMap,Un=Dn&&Dn.isRegExp,Bn=Dn&&Dn.isSet,Hn=Dn&&Dn.isTypedArray,Fn=x("length"),qn=E(Sn),$n=E(On),Vn=E(Tn),Gn=function t(e){function n(t){if(ea(t)&&!$c(t)&&!(t instanceof X)){if(t instanceof E)return t;if($a.call(t,"__wrapped__"))return Co(t)}return new E(t)}function _(){}function E(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=nt}function X(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Mt,this.__views__=[]}function K(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function tt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Le(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Ye(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Le;++e<n;)this.add(t[e])}function Qe(t){var e=this.__data__=new tt(t);this.size=e.size}function Ze(t,e){var n=$c(t),r=!n&&qc(t),i=!n&&!r&&Gc(t),o=!n&&!r&&!i&&Qc(t),a=n||r||i||o,s=a?N(t.length,Pa):[],c=s.length;for(var u in t)!e&&!$a.call(t,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ro(u,c))||s.push(u);return s}function Ke(t){var e=t.length;return e?t[Sr(0,e-1)]:nt}function tn(t,e){return wo(ai(t),dn(e,0,t.length))}function en(t){return wo(ai(t))}function nn(t,e,n){(n===nt||Jo(t[e],n))&&(n!==nt||e in t)||un(t,e,n)}function rn(t,e,n){var r=t[e];$a.call(t,e)&&Jo(r,n)&&(n!==nt||e in t)||un(t,e,n)}function on(t,e){for(var n=t.length;n--;)if(Jo(t[n][0],e))return n;return-1}function an(t,e,n,r){return Fs(t,function(t,i,o){e(r,t,n(t),o)}),r}function sn(t,e){return t&&si(e,ma(e),t)}function cn(t,e){return t&&si(e,ga(e),t)}function un(t,e,n){"__proto__"==e&&cs?cs(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ln(t,e){for(var n=-1,r=e.length,i=Ra(r),o=null==t;++n<r;)i[n]=o?nt:ha(t,e[n]);return i}function dn(t,e,n){return t===t&&(n!==nt&&(t=t<=n?t:n),e!==nt&&(t=t>=e?t:e)),t}function pn(t,e,n,r,i,o){var a,c=e&ut,u=e&lt,l=e&dt;if(n&&(a=i?n(t,r,i,o):n(t)),a!==nt)return a;if(!ta(t))return t;var d=$c(t);if(d){if(a=Zi(t),!c)return ai(t,a)}else{var f=tc(t),h=f==Vt||f==Gt;if(Gc(t))return Wr(t,c);if(f==Yt||f==Lt||h&&!i){if(a=u||h?{}:Ki(t),!c)return u?ui(t,cn(a,t)):ci(t,sn(a,t))}else{if(!wn[f])return i?t:{};a=to(t,f,pn,c)}}o||(o=new Qe);var p=o.get(t);if(p)return p;o.set(t,a);var m=l?u?Hi:Bi:u?ga:ma,g=d?nt:m(t);return s(g||t,function(r,i){g&&(r=t[i=r]),rn(a,i,pn(r,e,n,i,t,o))}),a}function mn(t){var e=ma(t);return function(n){return gn(n,t,e)}}function gn(t,e,n){var r=n.length;if(null==t)return!r;for(t=Da(t);r--;){var i=n[r],o=e[i],a=t[i];if(a===nt&&!(i in t)||!o(a))return!1}return!0}function vn(t,e,n){if("function"!=typeof t)throw new La(ot);return rc(function(){t.apply(nt,n)},e)}function Sn(t,e,n,r){var i=-1,o=d,a=!0,s=t.length,c=[],u=e.length;if(!s)return c;n&&(e=h(e,j(n))),r?(o=f,a=!1):e.length>=rt&&(o=D,a=!1,e=new Ye(e));t:for(;++i<s;){var l=t[i],p=null==n?l:n(l);if(l=r||0!==l?l:0,a&&p===p){for(var m=u;m--;)if(e[m]===p)continue t;c.push(l)}else o(e,p,r)||c.push(l)}return c}function On(t,e){var n=!0;return Fs(t,function(t,r,i){return n=!!e(t,r,i)}),n}function Tn(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],a=e(o);if(null!=a&&(s===nt?a===a&&!oa(a):n(a,s)))var s=a,c=o}return c}function Cn(t,e,n,r){var i=t.length;for((n=ca(n))<0&&(n=-n>i?0:i+n),(r=r===nt||r>i?i:ca(r))<0&&(r+=i),r=n>r?0:ua(r);n<r;)t[n++]=e;return t}function An(t,e){var n=[];return Fs(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function In(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=no),i||(i=[]);++o<a;){var s=t[o];e>0&&n(s)?e>1?In(s,e-1,n,r,i):p(i,s):r||(i[i.length]=s)}return i}function Nn(t,e){return t&&$s(t,e,ma)}function kn(t,e){return t&&Vs(t,e,ma)}function Mn(t,e){return l(e,function(e){return Qo(t[e])})}function Dn(t,e){for(var n=0,r=(e=Gr(e,t)).length;null!=t&&n<r;)t=t[So(e[n++])];return n&&n==r?t:nt}function Fn(t,e,n){var r=e(t);return $c(t)?r:p(r,n(t))}function Jn(t){return null==t?t===nt?ne:Xt:ss&&ss in Da(t)?Wi(t):mo(t)}function Wn(t,e){return t>e}function Xn(t,e){return null!=t&&$a.call(t,e)}function Yn(t,e){return null!=t&&e in Da(t)}function Qn(t,e,n){return t>=ys(e,n)&&t<bs(e,n)}function Zn(t,e,n){for(var r=n?f:d,i=t[0].length,o=t.length,a=o,s=Ra(o),c=1/0,u=[];a--;){var l=t[a];a&&e&&(l=h(l,j(e))),c=ys(l.length,c),s[a]=!n&&(e||i>=120&&l.length>=120)?new Ye(a&&l):nt}l=t[0];var p=-1,m=s[0];t:for(;++p<i&&u.length<c;){var g=l[p],v=e?e(g):g;if(g=n||0!==g?g:0,!(m?D(m,v):r(u,v,n))){for(a=o;--a;){var _=s[a];if(!(_?D(_,v):r(t[a],v,n)))continue t}m&&m.push(v),u.push(g)}}return u}function Kn(t,e,n,r){return Nn(t,function(t,i,o){e(r,n(t),i,o)}),r}function tr(t,e,n){var r=null==(t=vo(t,e=Gr(e,t)))?t:t[So(Ro(e))];return null==r?nt:o(r,t,n)}function er(t){return ea(t)&&Jn(t)==Lt}function nr(t,e,n,r,i){return t===e||(null==t||null==e||!ea(t)&&!ea(e)?t!==t&&e!==e:rr(t,e,n,r,nr,i))}function rr(t,e,n,r,i,o){var a=$c(t),s=$c(e),c=a?Ut:tc(t),u=s?Ut:tc(e),l=(c=c==Lt?Yt:c)==Yt,d=(u=u==Lt?Yt:u)==Yt,f=c==u;if(f&&Gc(t)){if(!Gc(e))return!1;a=!0,l=!1}if(f&&!l)return o||(o=new Qe),a||Qc(t)?zi(t,e,n,r,i,o):Pi(t,e,c,n,r,i,o);if(!(n&ft)){var h=l&&$a.call(t,"__wrapped__"),p=d&&$a.call(e,"__wrapped__");if(h||p){var m=h?t.value():t,g=p?e.value():e;return o||(o=new Qe),i(m,g,n,r,o)}}return!!f&&(o||(o=new Qe),Li(t,e,n,r,i,o))}function ir(t,e,n,r){var i=n.length,o=i,a=!r;if(null==t)return!o;for(t=Da(t);i--;){var s=n[i];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<o;){var c=(s=n[i])[0],u=t[c],l=s[1];if(a&&s[2]){if(u===nt&&!(c in t))return!1}else{var d=new Qe;if(r)var f=r(u,l,c,t,e,d);if(!(f===nt?nr(l,u,ft|ht,r,d):f))return!1}}return!0}function or(t){return!(!ta(t)||co(t))&&(Qo(t)?Ya:$e).test(Oo(t))}function ar(t){return"function"==typeof t?t:null==t?Oa:"object"==typeof t?$c(t)?fr(t[0],t[1]):dr(t):Ea(t)}function sr(t){if(!uo(t))return _s(t);var e=[];for(var n in Da(t))$a.call(t,n)&&"constructor"!=n&&e.push(n);return e}function cr(t){if(!ta(t))return po(t);var e=uo(t),n=[];for(var r in t)("constructor"!=r||!e&&$a.call(t,r))&&n.push(r);return n}function ur(t,e){return t<e}function lr(t,e){var n=-1,r=Wo(t)?Ra(t.length):[];return Fs(t,function(t,i,o){r[++n]=e(t,i,o)}),r}function dr(t){var e=Gi(t);return 1==e.length&&e[0][2]?fo(e[0][0],e[0][1]):function(n){return n===t||ir(n,t,e)}}function fr(t,e){return oo(t)&&lo(e)?fo(So(t),e):function(n){var r=ha(n,t);return r===nt&&r===e?pa(n,t):nr(e,r,ft|ht)}}function hr(t,e,n,r,i){t!==e&&$s(e,function(o,a){if(ta(o))i||(i=new Qe),pr(t,e,a,n,hr,r,i);else{var s=r?r(t[a],o,a+"",t,e,i):nt;s===nt&&(s=o),nn(t,a,s)}},ga)}function pr(t,e,n,r,i,o,a){var s=t[n],c=e[n],u=a.get(c);if(u)nn(t,n,u);else{var l=o?o(s,c,n+"",t,e,a):nt,d=l===nt;if(d){var f=$c(c),h=!f&&Gc(c),p=!f&&!h&&Qc(c);l=c,f||h||p?$c(s)?l=s:Xo(s)?l=ai(s):h?(d=!1,l=Wr(c,!0)):p?(d=!1,l=ei(c,!0)):l=[]:ra(c)||qc(c)?(l=s,qc(s)?l=da(s):(!ta(s)||r&&Qo(s))&&(l=Ki(c))):d=!1}d&&(a.set(c,l),i(l,c,r,o,a),a.delete(c)),nn(t,n,l)}}function mr(t,e){var n=t.length;if(n)return e+=e<0?n:0,ro(e,n)?t[e]:nt}function gr(t,e,n){var r=-1;return e=h(e.length?e:[Oa],j($i())),I(lr(t,function(t,n,i){return{criteria:h(e,function(e){return e(t)}),index:++r,value:t}}),function(t,e){return ri(t,e,n)})}function vr(t,e){return _r(t,e,function(e,n){return pa(t,n)})}function _r(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var a=e[r],s=Dn(t,a);n(s,a)&&Ar(o,Gr(a,t),s)}return o}function br(t){return function(e){return Dn(e,t)}}function yr(t,e,n,r){var i=r?O:S,o=-1,a=e.length,s=t;for(t===e&&(e=ai(e)),n&&(s=h(t,j(n)));++o<a;)for(var c=0,u=e[o],l=n?n(u):u;(c=i(s,l,c,r))>-1;)s!==t&&is.call(s,c,1),is.call(t,c,1);return t}function wr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;ro(i)?is.call(t,i,1):Lr(t,i)}}return t}function Sr(t,e){return t+hs(Os()*(e-t+1))}function Or(t,e,n,r){for(var i=-1,o=bs(fs((e-t)/(n||1)),0),a=Ra(o);o--;)a[r?o:++i]=t,t+=n;return a}function Tr(t,e){var n="";if(!t||e<1||e>Nt)return n;do{e%2&&(n+=t),(e=hs(e/2))&&(t+=t)}while(e);return n}function Cr(t,e){return ic(go(t,e,Oa),t+"")}function xr(t){return Ke(_a(t))}function Er(t,e){var n=_a(t);return wo(n,dn(e,0,n.length))}function Ar(t,e,n,r){if(!ta(t))return t;for(var i=-1,o=(e=Gr(e,t)).length,a=o-1,s=t;null!=s&&++i<o;){var c=So(e[i]),u=n;if(i!=a){var l=s[c];(u=r?r(l,c,s):nt)===nt&&(u=ta(l)?l:ro(e[i+1])?[]:{})}rn(s,c,u),s=s[c]}return t}function Ir(t){return wo(_a(t))}function Rr(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=Ra(i);++r<i;)o[r]=t[r+e];return o}function Nr(t,e){var n;return Fs(t,function(t,r,i){return!(n=e(t,r,i))}),!!n}function kr(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e===e&&i<=zt){for(;r<i;){var o=r+i>>>1,a=t[o];null!==a&&!oa(a)&&(n?a<=e:a<e)?r=o+1:i=o}return i}return jr(t,e,Oa,n)}function jr(t,e,n,r){e=n(e);for(var i=0,o=null==t?0:t.length,a=e!==e,s=null===e,c=oa(e),u=e===nt;i<o;){var l=hs((i+o)/2),d=n(t[l]),f=d!==nt,h=null===d,p=d===d,m=oa(d);if(a)var g=r||p;else g=u?p&&(r||f):s?p&&f&&(r||!h):c?p&&f&&!h&&(r||!m):!h&&!m&&(r?d<=e:d<e);g?i=l+1:o=l}return ys(o,Dt)}function Mr(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],s=e?e(a):a;if(!n||!Jo(s,c)){var c=s;o[i++]=0===a?0:a}}return o}function Dr(t){return"number"==typeof t?t:oa(t)?jt:+t}function zr(t){if("string"==typeof t)return t;if($c(t))return h(t,zr)+"";if(oa(t))return Bs?Bs.call(t):"";var e=t+"";return"0"==e&&1/t==-Rt?"-0":e}function Pr(t,e,n){var r=-1,i=d,o=t.length,a=!0,s=[],c=s;if(n)a=!1,i=f;else if(o>=rt){var u=e?null:Ys(t);if(u)return J(u);a=!1,i=D,c=new Ye}else c=e?[]:s;t:for(;++r<o;){var l=t[r],h=e?e(l):l;if(l=n||0!==l?l:0,a&&h===h){for(var p=c.length;p--;)if(c[p]===h)continue t;e&&c.push(h),s.push(l)}else i(c,h,n)||(c!==s&&c.push(h),s.push(l))}return s}function Lr(t,e){return e=Gr(e,t),null==(t=vo(t,e))||delete t[So(Ro(e))]}function Ur(t,e,n,r){return Ar(t,e,n(Dn(t,e)),r)}function Br(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?Rr(t,r?0:o,r?o+1:i):Rr(t,r?o+1:0,r?i:o)}function Hr(t,e){var n=t;return n instanceof X&&(n=n.value()),m(e,function(t,e){return e.func.apply(e.thisArg,p([t],e.args))},n)}function Fr(t,e,n){var r=t.length;if(r<2)return r?Pr(t[0]):[];for(var i=-1,o=Ra(r);++i<r;)for(var a=t[i],s=-1;++s<r;)s!=i&&(o[i]=Sn(o[i]||a,t[s],e,n));return Pr(In(o,1),e,n)}function qr(t,e,n){for(var r=-1,i=t.length,o=e.length,a={};++r<i;){var s=r<o?e[r]:nt;n(a,t[r],s)}return a}function $r(t){return Xo(t)?t:[]}function Vr(t){return"function"==typeof t?t:Oa}function Gr(t,e){return $c(t)?t:oo(t,e)?[t]:oc(fa(t))}function Jr(t,e,n){var r=t.length;return n=n===nt?r:n,!e&&n>=r?t:Rr(t,e,n)}function Wr(t,e){if(e)return t.slice();var n=t.length,r=ts?ts(n):new t.constructor(n);return t.copy(r),r}function Xr(t){var e=new t.constructor(t.byteLength);return new Ka(e).set(new Ka(t)),e}function Yr(t,e){var n=e?Xr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}function Qr(t,e,n){return m(e?n($(t),ut):$(t),r,new t.constructor)}function Zr(t){var e=new t.constructor(t.source,He.exec(t));return e.lastIndex=t.lastIndex,e}function Kr(t,e,n){return m(e?n(J(t),ut):J(t),i,new t.constructor)}function ti(t){return Us?Da(Us.call(t)):{}}function ei(t,e){var n=e?Xr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function ni(t,e){if(t!==e){var n=t!==nt,r=null===t,i=t===t,o=oa(t),a=e!==nt,s=null===e,c=e===e,u=oa(e);if(!s&&!u&&!o&&t>e||o&&a&&c&&!s&&!u||r&&a&&c||!n&&c||!i)return 1;if(!r&&!o&&!u&&t<e||u&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!c)return-1}return 0}function ri(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,a=i.length,s=n.length;++r<a;){var c=ni(i[r],o[r]);if(c)return r>=s?c:c*("desc"==n[r]?-1:1)}return t.index-e.index}function ii(t,e,n,r){for(var i=-1,o=t.length,a=n.length,s=-1,c=e.length,u=bs(o-a,0),l=Ra(c+u),d=!r;++s<c;)l[s]=e[s];for(;++i<a;)(d||i<o)&&(l[n[i]]=t[i]);for(;u--;)l[s++]=t[i++];return l}function oi(t,e,n,r){for(var i=-1,o=t.length,a=-1,s=n.length,c=-1,u=e.length,l=bs(o-s,0),d=Ra(l+u),f=!r;++i<l;)d[i]=t[i];for(var h=i;++c<u;)d[h+c]=e[c];for(;++a<s;)(f||i<o)&&(d[h+n[a]]=t[i++]);return d}function ai(t,e){var n=-1,r=t.length;for(e||(e=Ra(r));++n<r;)e[n]=t[n];return e}function si(t,e,n,r){var i=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var s=e[o],c=r?r(n[s],t[s],s,n,t):nt;c===nt&&(c=t[s]),i?un(n,s,c):rn(n,s,c)}return n}function ci(t,e){return si(t,Zs(t),e)}function ui(t,e){return si(t,Ks(t),e)}function li(t,e){return function(n,r){var i=$c(n)?a:an,o=e?e():{};return i(n,t,$i(r,2),o)}}function di(t){return Cr(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:nt,a=i>2?n[2]:nt;for(o=t.length>3&&"function"==typeof o?(i--,o):nt,a&&io(n[0],n[1],a)&&(o=i<3?nt:o,i=1),e=Da(e);++r<i;){var s=n[r];s&&t(e,s,r,o)}return e})}function fi(t,e){return function(n,r){if(null==n)return n;if(!Wo(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=Da(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function hi(t){return function(e,n,r){for(var i=-1,o=Da(e),a=r(e),s=a.length;s--;){var c=a[t?s:++i];if(!1===n(o[c],c,o))break}return e}}function pi(t,e,n){function r(){return(this&&this!==Rn&&this instanceof r?o:t).apply(i?n:this,arguments)}var i=e&pt,o=vi(t);return r}function mi(t){return function(e){var n=H(e=fa(e))?Z(e):nt,r=n?n[0]:e.charAt(0),i=n?Jr(n,1).join(""):e.slice(1);return r[t]()+i}}function gi(t){return function(e){return m(wa(ya(e).replace(fn,"")),t,"")}}function vi(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Hs(t.prototype),r=t.apply(n,e);return ta(r)?r:n}}function _i(t,e,n){function r(){for(var a=arguments.length,s=Ra(a),c=a,u=qi(r);c--;)s[c]=arguments[c];var l=a<3&&s[0]!==u&&s[a-1]!==u?[]:G(s,u);return(a-=l.length)<n?Ii(t,e,wi,r.placeholder,nt,s,l,nt,nt,n-a):o(this&&this!==Rn&&this instanceof r?i:t,this,s)}var i=vi(t);return r}function bi(t){return function(e,n,r){var i=Da(e);if(!Wo(e)){var o=$i(n,3);e=ma(e),n=function(t){return o(i[t],t,i)}}var a=t(e,n,r);return a>-1?i[o?e[a]:a]:nt}}function yi(t){return Ui(function(e){var n=e.length,r=n,i=E.prototype.thru;for(t&&e.reverse();r--;){var o=e[r];if("function"!=typeof o)throw new La(ot);if(i&&!a&&"wrapper"==Fi(o))var a=new E([],!0)}for(r=a?r:n;++r<n;){var s=Fi(o=e[r]),c="wrapper"==s?Qs(o):nt;a=c&&so(c[0])&&c[1]==(wt|vt|bt|St)&&!c[4].length&&1==c[9]?a[Fi(c[0])].apply(a,c[3]):1==o.length&&so(o)?a[s]():a.thru(o)}return function(){var t=arguments,r=t[0];if(a&&1==t.length&&$c(r))return a.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}})}function wi(t,e,n,r,i,o,a,s,c,u){function l(){for(var v=arguments.length,_=Ra(v),b=v;b--;)_[b]=arguments[b];if(p)var y=qi(l),w=L(_,y);if(r&&(_=ii(_,r,i,p)),o&&(_=oi(_,o,a,p)),v-=w,p&&v<u){var S=G(_,y);return Ii(t,e,wi,l.placeholder,n,_,S,s,c,u-v)}var O=f?n:this,T=h?O[t]:t;return v=_.length,s?_=_o(_,s):m&&v>1&&_.reverse(),d&&c<v&&(_.length=c),this&&this!==Rn&&this instanceof l&&(T=g||vi(T)),T.apply(O,_)}var d=e&wt,f=e&pt,h=e&mt,p=e&(vt|_t),m=e&Ot,g=h?nt:vi(t);return l}function Si(t,e){return function(n,r){return Kn(n,t,e(r),{})}}function Oi(t,e){return function(n,r){var i;if(n===nt&&r===nt)return e;if(n!==nt&&(i=n),r!==nt){if(i===nt)return r;"string"==typeof n||"string"==typeof r?(n=zr(n),r=zr(r)):(n=Dr(n),r=Dr(r)),i=t(n,r)}return i}}function Ti(t){return Ui(function(e){return e=h(e,j($i())),Cr(function(n){var r=this;return t(e,function(t){return o(t,r,n)})})})}function Ci(t,e){var n=(e=e===nt?" ":zr(e)).length;if(n<2)return n?Tr(e,t):e;var r=Tr(e,fs(t/Q(e)));return H(e)?Jr(Z(r),0,t).join(""):r.slice(0,t)}function xi(t,e,n,r){function i(){for(var e=-1,c=arguments.length,u=-1,l=r.length,d=Ra(l+c),f=this&&this!==Rn&&this instanceof i?s:t;++u<l;)d[u]=r[u];for(;c--;)d[u++]=arguments[++e];return o(f,a?n:this,d)}var a=e&pt,s=vi(t);return i}function Ei(t){return function(e,n,r){return r&&"number"!=typeof r&&io(e,n,r)&&(n=r=nt),e=sa(e),n===nt?(n=e,e=0):n=sa(n),r=r===nt?e<n?1:-1:sa(r),Or(e,n,r,t)}}function Ai(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=la(e),n=la(n)),t(e,n)}}function Ii(t,e,n,r,i,o,a,s,c,u){var l=e&vt,d=l?a:nt,f=l?nt:a,h=l?o:nt,p=l?nt:o;e|=l?bt:yt,(e&=~(l?yt:bt))&gt||(e&=~(pt|mt));var m=[t,e,i,h,d,p,f,s,c,u],g=n.apply(nt,m);return so(t)&&nc(g,m),g.placeholder=r,bo(g,t,e)}function Ri(t){var e=Ma[t];return function(t,n){if(t=la(t),n=null==n?0:ys(ca(n),292)){var r=(fa(t)+"e").split("e");return+((r=(fa(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}function Ni(t){return function(e){var n=tc(e);return n==Jt?$(e):n==Kt?W(e):k(e,t(e))}}function ki(t,e,n,r,i,o,a,s){var c=e&mt;if(!c&&"function"!=typeof t)throw new La(ot);var u=r?r.length:0;if(u||(e&=~(bt|yt),r=i=nt),a=a===nt?a:bs(ca(a),0),s=s===nt?s:ca(s),u-=i?i.length:0,e&yt){var l=r,d=i;r=i=nt}var f=c?nt:Qs(t),h=[t,e,n,r,i,l,d,o,a,s];if(f&&ho(h,f),t=h[0],e=h[1],n=h[2],r=h[3],i=h[4],!(s=h[9]=h[9]===nt?c?0:t.length:bs(h[9]-u,0))&&e&(vt|_t)&&(e&=~(vt|_t)),e&&e!=pt)p=e==vt||e==_t?_i(t,e,s):e!=bt&&e!=(pt|bt)||i.length?wi.apply(nt,h):xi(t,e,n,r);else var p=pi(t,e,n);return bo((f?Gs:nc)(p,h),t,e)}function ji(t,e,n,r){return t===nt||Jo(t,Ha[n])&&!$a.call(r,n)?e:t}function Mi(t,e,n,r,i,o){return ta(t)&&ta(e)&&(o.set(e,t),hr(t,e,nt,Mi,o),o.delete(e)),t}function Di(t){return ra(t)?nt:t}function zi(t,e,n,r,i,o){var a=n&ft,s=t.length,c=e.length;if(s!=c&&!(a&&c>s))return!1;var u=o.get(t);if(u&&o.get(e))return u==e;var l=-1,d=!0,f=n&ht?new Ye:nt;for(o.set(t,e),o.set(e,t);++l<s;){var h=t[l],p=e[l];if(r)var m=a?r(p,h,l,e,t,o):r(h,p,l,t,e,o);if(m!==nt){if(m)continue;d=!1;break}if(f){if(!v(e,function(t,e){if(!D(f,e)&&(h===t||i(h,t,n,r,o)))return f.push(e)})){d=!1;break}}else if(h!==p&&!i(h,p,n,r,o)){d=!1;break}}return o.delete(t),o.delete(e),d}function Pi(t,e,n,r,i,o,a){switch(n){case ae:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case oe:return!(t.byteLength!=e.byteLength||!o(new Ka(t),new Ka(e)));case Ht:case Ft:case Wt:return Jo(+t,+e);case $t:return t.name==e.name&&t.message==e.message;case Zt:case te:return t==e+"";case Jt:var s=$;case Kt:var c=r&ft;if(s||(s=J),t.size!=e.size&&!c)return!1;var u=a.get(t);if(u)return u==e;r|=ht,a.set(t,e);var l=zi(s(t),s(e),r,i,o,a);return a.delete(t),l;case ee:if(Us)return Us.call(t)==Us.call(e)}return!1}function Li(t,e,n,r,i,o){var a=n&ft,s=Bi(t),c=s.length;if(c!=Bi(e).length&&!a)return!1;for(var u=c;u--;){var l=s[u];if(!(a?l in e:$a.call(e,l)))return!1}var d=o.get(t);if(d&&o.get(e))return d==e;var f=!0;o.set(t,e),o.set(e,t);for(var h=a;++u<c;){var p=t[l=s[u]],m=e[l];if(r)var g=a?r(m,p,l,e,t,o):r(p,m,l,t,e,o);if(!(g===nt?p===m||i(p,m,n,r,o):g)){f=!1;break}h||(h="constructor"==l)}if(f&&!h){var v=t.constructor,_=e.constructor;v!=_&&"constructor"in t&&"constructor"in e&&!("function"==typeof v&&v instanceof v&&"function"==typeof _&&_ instanceof _)&&(f=!1)}return o.delete(t),o.delete(e),f}function Ui(t){return ic(go(t,nt,Ao),t+"")}function Bi(t){return Fn(t,ma,Zs)}function Hi(t){return Fn(t,ga,Ks)}function Fi(t){for(var e=t.name+"",n=ks[e],r=$a.call(ks,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function qi(t){return($a.call(n,"placeholder")?n:t).placeholder}function $i(){var t=n.iteratee||Ta;return t=t===Ta?ar:t,arguments.length?t(arguments[0],arguments[1]):t}function Vi(t,e){var n=t.__data__;return ao(e)?n["string"==typeof e?"string":"hash"]:n.map}function Gi(t){for(var e=ma(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,lo(i)]}return e}function Ji(t,e){var n=B(t,e);return or(n)?n:nt}function Wi(t){var e=$a.call(t,ss),n=t[ss];try{t[ss]=nt;var r=!0}catch(t){}var i=Ja.call(t);return r&&(e?t[ss]=n:delete t[ss]),i}function Xi(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=ys(e,t+a);break;case"takeRight":t=bs(t,e-a)}}return{start:t,end:e}}function Yi(t){var e=t.match(ze);return e?e[1].split(Pe):[]}function Qi(t,e,n){for(var r=-1,i=(e=Gr(e,t)).length,o=!1;++r<i;){var a=So(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&Ko(i)&&ro(a,i)&&($c(t)||qc(t))}function Zi(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&$a.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function Ki(t){return"function"!=typeof t.constructor||uo(t)?{}:Hs(es(t))}function to(t,e,n,r){var i=t.constructor;switch(e){case oe:return Xr(t);case Ht:case Ft:return new i(+t);case ae:return Yr(t,r);case se:case ce:case ue:case le:case de:case fe:case he:case pe:case me:return ei(t,r);case Jt:return Qr(t,r,n);case Wt:case te:return new i(t);case Zt:return Zr(t);case Kt:return Kr(t,r,n);case ee:return ti(t)}}function eo(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(De,"{\n/* [wrapped with "+e+"] */\n")}function no(t){return $c(t)||qc(t)||!!(os&&t&&t[os])}function ro(t,e){return!!(e=null==e?Nt:e)&&("number"==typeof t||Ge.test(t))&&t>-1&&t%1==0&&t<e}function io(t,e,n){if(!ta(n))return!1;var r=typeof e;return!!("number"==r?Wo(n)&&ro(e,n.length):"string"==r&&e in n)&&Jo(n[e],t)}function oo(t,e){if($c(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!oa(t))||(Ee.test(t)||!xe.test(t)||null!=e&&t in Da(e))}function ao(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function so(t){var e=Fi(t),r=n[e];if("function"!=typeof r||!(e in X.prototype))return!1;if(t===r)return!0;var i=Qs(r);return!!i&&t===i[0]}function co(t){return!!Ga&&Ga in t}function uo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ha)}function lo(t){return t===t&&!ta(t)}function fo(t,e){return function(n){return null!=n&&(n[t]===e&&(e!==nt||t in Da(n)))}}function ho(t,e){var n=t[1],r=e[1],i=n|r,o=i<(pt|mt|wt),a=r==wt&&n==vt||r==wt&&n==St&&t[7].length<=e[8]||r==(wt|St)&&e[7].length<=e[8]&&n==vt;if(!o&&!a)return t;r&pt&&(t[2]=e[2],i|=n&pt?0:gt);var s=e[3];if(s){var c=t[3];t[3]=c?ii(c,s,e[4]):s,t[4]=c?G(t[3],ct):e[4]}return(s=e[5])&&(c=t[5],t[5]=c?oi(c,s,e[6]):s,t[6]=c?G(t[5],ct):e[6]),(s=e[7])&&(t[7]=s),r&wt&&(t[8]=null==t[8]?e[8]:ys(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}function po(t){var e=[];if(null!=t)for(var n in Da(t))e.push(n);return e}function mo(t){return Ja.call(t)}function go(t,e,n){return e=bs(e===nt?t.length-1:e,0),function(){for(var r=arguments,i=-1,a=bs(r.length-e,0),s=Ra(a);++i<a;)s[i]=r[e+i];i=-1;for(var c=Ra(e+1);++i<e;)c[i]=r[i];return c[e]=n(s),o(t,this,c)}}function vo(t,e){return e.length<2?t:Dn(t,Rr(e,0,-1))}function _o(t,e){for(var n=t.length,r=ys(e.length,n),i=ai(t);r--;){var o=e[r];t[r]=ro(o,n)?i[o]:nt}return t}function bo(t,e,n){var r=e+"";return ic(t,eo(r,To(Yi(r),n)))}function yo(t){var e=0,n=0;return function(){var r=ws(),i=Et-(r-n);if(n=r,i>0){if(++e>=xt)return arguments[0]}else e=0;return t.apply(nt,arguments)}}function wo(t,e){var n=-1,r=t.length,i=r-1;for(e=e===nt?r:e;++n<e;){var o=Sr(n,i),a=t[o];t[o]=t[n],t[n]=a}return t.length=e,t}function So(t){if("string"==typeof t||oa(t))return t;var e=t+"";return"0"==e&&1/t==-Rt?"-0":e}function Oo(t){if(null!=t){try{return qa.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function To(t,e){return s(Pt,function(n){var r="_."+n[0];e&n[1]&&!d(t,r)&&t.push(r)}),t.sort()}function Co(t){if(t instanceof X)return t.clone();var e=new E(t.__wrapped__,t.__chain__);return e.__actions__=ai(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function xo(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ca(n);return i<0&&(i=bs(r+i,0)),w(t,$i(e,3),i)}function Eo(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return n!==nt&&(i=ca(n),i=n<0?bs(r+i,0):ys(i,r-1)),w(t,$i(e,3),i,!0)}function Ao(t){return(null==t?0:t.length)?In(t,1):[]}function Io(t){return t&&t.length?t[0]:nt}function Ro(t){var e=null==t?0:t.length;return e?t[e-1]:nt}function No(t,e){return t&&t.length&&e&&e.length?yr(t,e):t}function ko(t){return null==t?t:Ts.call(t)}function jo(t){if(!t||!t.length)return[];var e=0;return t=l(t,function(t){if(Xo(t))return e=bs(t.length,e),!0}),N(e,function(e){return h(t,x(e))})}function Mo(t,e){if(!t||!t.length)return[];var n=jo(t);return null==e?n:h(n,function(t){return o(e,nt,t)})}function Do(t){var e=n(t);return e.__chain__=!0,e}function zo(t,e){return e(t)}function Po(t,e){return($c(t)?s:Fs)(t,$i(e,3))}function Lo(t,e){return($c(t)?c:qs)(t,$i(e,3))}function Uo(t,e){return($c(t)?h:lr)(t,$i(e,3))}function Bo(t,e,n){return e=n?nt:e,e=t&&null==e?t.length:e,ki(t,wt,nt,nt,nt,nt,e)}function Ho(t,e){var n;if("function"!=typeof e)throw new La(ot);return t=ca(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=nt),n}}function Fo(t,e,n){var r=ki(t,vt,nt,nt,nt,nt,nt,e=n?nt:e);return r.placeholder=Fo.placeholder,r}function qo(t,e,n){var r=ki(t,_t,nt,nt,nt,nt,nt,e=n?nt:e);return r.placeholder=qo.placeholder,r}function $o(t,e,n){function r(e){var n=l,r=d;return l=d=nt,g=e,h=t.apply(r,n)}function i(t){return g=t,p=rc(s,e),v?r(t):h}function o(t){var n=t-g,r=e-(t-m);return _?ys(r,f-n):r}function a(t){var n=t-m,r=t-g;return m===nt||n>=e||n<0||_&&r>=f}function s(){var t=kc();if(a(t))return c(t);p=rc(s,o(t))}function c(t){return p=nt,b&&l?r(t):(l=d=nt,h)}function u(){var t=kc(),n=a(t);if(l=arguments,d=this,m=t,n){if(p===nt)return i(m);if(_)return p=rc(s,e),r(m)}return p===nt&&(p=rc(s,e)),h}var l,d,f,h,p,m,g=0,v=!1,_=!1,b=!0;if("function"!=typeof t)throw new La(ot);return e=la(e)||0,ta(n)&&(v=!!n.leading,f=(_="maxWait"in n)?bs(la(n.maxWait)||0,e):f,b="trailing"in n?!!n.trailing:b),u.cancel=function(){p!==nt&&Xs(p),g=0,l=m=d=p=nt},u.flush=function(){return p===nt?h:c(kc())},u}function Vo(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new La(ot);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Vo.Cache||Le),n}function Go(t){if("function"!=typeof t)throw new La(ot);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Jo(t,e){return t===e||t!==t&&e!==e}function Wo(t){return null!=t&&Ko(t.length)&&!Qo(t)}function Xo(t){return ea(t)&&Wo(t)}function Yo(t){if(!ea(t))return!1;var e=Jn(t);return e==$t||e==qt||"string"==typeof t.message&&"string"==typeof t.name&&!ra(t)}function Qo(t){if(!ta(t))return!1;var e=Jn(t);return e==Vt||e==Gt||e==Bt||e==Qt}function Zo(t){return"number"==typeof t&&t==ca(t)}function Ko(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Nt}function ta(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ea(t){return null!=t&&"object"==typeof t}function na(t){return"number"==typeof t||ea(t)&&Jn(t)==Wt}function ra(t){if(!ea(t)||Jn(t)!=Yt)return!1;var e=es(t);if(null===e)return!0;var n=$a.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&qa.call(n)==Wa}function ia(t){return"string"==typeof t||!$c(t)&&ea(t)&&Jn(t)==te}function oa(t){return"symbol"==typeof t||ea(t)&&Jn(t)==ee}function aa(t){if(!t)return[];if(Wo(t))return ia(t)?Z(t):ai(t);if(as&&t[as])return q(t[as]());var e=tc(t);return(e==Jt?$:e==Kt?J:_a)(t)}function sa(t){return t?(t=la(t),t===Rt||t===-Rt?(t<0?-1:1)*kt:t===t?t:0):0===t?t:0}function ca(t){var e=sa(t),n=e%1;return e===e?n?e-n:e:0}function ua(t){return t?dn(ca(t),0,Mt):0}function la(t){if("number"==typeof t)return t;if(oa(t))return jt;if(ta(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=ta(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(ke,"");var n=qe.test(t);return n||Ve.test(t)?En(t.slice(2),n?2:8):Fe.test(t)?jt:+t}function da(t){return si(t,ga(t))}function fa(t){return null==t?"":zr(t)}function ha(t,e,n){var r=null==t?nt:Dn(t,e);return r===nt?n:r}function pa(t,e){return null!=t&&Qi(t,e,Yn)}function ma(t){return Wo(t)?Ze(t):sr(t)}function ga(t){return Wo(t)?Ze(t,!0):cr(t)}function va(t,e){if(null==t)return{};var n=h(Hi(t),function(t){return[t]});return e=$i(e),_r(t,n,function(t,n){return e(t,n[0])})}function _a(t){return null==t?[]:M(t,ma(t))}function ba(t){return Ou(fa(t).toLowerCase())}function ya(t){return(t=fa(t))&&t.replace(Je,qn).replace(hn,"")}function wa(t,e,n){return t=fa(t),e=n?nt:e,e===nt?F(t)?et(t):b(t):t.match(e)||[]}function Sa(t){return function(){return t}}function Oa(t){return t}function Ta(t){return ar("function"==typeof t?t:pn(t,ut))}function Ca(t,e,n){var r=ma(e),i=Mn(e,r);null!=n||ta(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=Mn(e,ma(e)));var o=!(ta(n)&&"chain"in n&&!n.chain),a=Qo(t);return s(i,function(n){var r=e[n];t[n]=r,a&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__);return(n.__actions__=ai(this.__actions__)).push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,p([this.value()],arguments))})}),t}function xa(){}function Ea(t){return oo(t)?x(So(t)):br(t)}function Aa(){return[]}function Ia(){return!1}var Ra=(e=null==e?Rn:Gn.defaults(Rn.Object(),e,Gn.pick(Rn,_n))).Array,Na=e.Date,ka=e.Error,ja=e.Function,Ma=e.Math,Da=e.Object,za=e.RegExp,Pa=e.String,La=e.TypeError,Ua=Ra.prototype,Ba=ja.prototype,Ha=Da.prototype,Fa=e["__core-js_shared__"],qa=Ba.toString,$a=Ha.hasOwnProperty,Va=0,Ga=function(){var t=/[^.]+$/.exec(Fa&&Fa.keys&&Fa.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Ja=Ha.toString,Wa=qa.call(Da),Xa=Rn._,Ya=za("^"+qa.call($a).replace(Re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Qa=jn?e.Buffer:nt,Za=e.Symbol,Ka=e.Uint8Array,ts=Qa?Qa.allocUnsafe:nt,es=V(Da.getPrototypeOf,Da),ns=Da.create,rs=Ha.propertyIsEnumerable,is=Ua.splice,os=Za?Za.isConcatSpreadable:nt,as=Za?Za.iterator:nt,ss=Za?Za.toStringTag:nt,cs=function(){try{var t=Ji(Da,"defineProperty");return t({},"",{}),t}catch(t){}}(),us=e.clearTimeout!==Rn.clearTimeout&&e.clearTimeout,ls=Na&&Na.now!==Rn.Date.now&&Na.now,ds=e.setTimeout!==Rn.setTimeout&&e.setTimeout,fs=Ma.ceil,hs=Ma.floor,ps=Da.getOwnPropertySymbols,ms=Qa?Qa.isBuffer:nt,gs=e.isFinite,vs=Ua.join,_s=V(Da.keys,Da),bs=Ma.max,ys=Ma.min,ws=Na.now,Ss=e.parseInt,Os=Ma.random,Ts=Ua.reverse,Cs=Ji(e,"DataView"),xs=Ji(e,"Map"),Es=Ji(e,"Promise"),As=Ji(e,"Set"),Is=Ji(e,"WeakMap"),Rs=Ji(Da,"create"),Ns=Is&&new Is,ks={},js=Oo(Cs),Ms=Oo(xs),Ds=Oo(Es),zs=Oo(As),Ps=Oo(Is),Ls=Za?Za.prototype:nt,Us=Ls?Ls.valueOf:nt,Bs=Ls?Ls.toString:nt,Hs=function(){function t(){}return function(e){if(!ta(e))return{};if(ns)return ns(e);t.prototype=e;var n=new t;return t.prototype=nt,n}}();n.templateSettings={escape:Oe,evaluate:Te,interpolate:Ce,variable:"",imports:{_:n}},n.prototype=_.prototype,n.prototype.constructor=n,E.prototype=Hs(_.prototype),E.prototype.constructor=E,X.prototype=Hs(_.prototype),X.prototype.constructor=X,K.prototype.clear=function(){this.__data__=Rs?Rs(null):{},this.size=0},K.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},K.prototype.get=function(t){var e=this.__data__;if(Rs){var n=e[t];return n===at?nt:n}return $a.call(e,t)?e[t]:nt},K.prototype.has=function(t){var e=this.__data__;return Rs?e[t]!==nt:$a.call(e,t)},K.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Rs&&e===nt?at:e,this},tt.prototype.clear=function(){this.__data__=[],this.size=0},tt.prototype.delete=function(t){var e=this.__data__,n=on(e,t);return!(n<0||(n==e.length-1?e.pop():is.call(e,n,1),--this.size,0))},tt.prototype.get=function(t){var e=this.__data__,n=on(e,t);return n<0?nt:e[n][1]},tt.prototype.has=function(t){return on(this.__data__,t)>-1},tt.prototype.set=function(t,e){var n=this.__data__,r=on(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Le.prototype.clear=function(){this.size=0,this.__data__={hash:new K,map:new(xs||tt),string:new K}},Le.prototype.delete=function(t){var e=Vi(this,t).delete(t);return this.size-=e?1:0,e},Le.prototype.get=function(t){return Vi(this,t).get(t)},Le.prototype.has=function(t){return Vi(this,t).has(t)},Le.prototype.set=function(t,e){var n=Vi(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Ye.prototype.add=Ye.prototype.push=function(t){return this.__data__.set(t,at),this},Ye.prototype.has=function(t){return this.__data__.has(t)},Qe.prototype.clear=function(){this.__data__=new tt,this.size=0},Qe.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Qe.prototype.get=function(t){return this.__data__.get(t)},Qe.prototype.has=function(t){return this.__data__.has(t)},Qe.prototype.set=function(t,e){var n=this.__data__;if(n instanceof tt){var r=n.__data__;if(!xs||r.length<rt-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Le(r)}return n.set(t,e),this.size=n.size,this};var Fs=fi(Nn),qs=fi(kn,!0),$s=hi(),Vs=hi(!0),Gs=Ns?function(t,e){return Ns.set(t,e),t}:Oa,Js=cs?function(t,e){return cs(t,"toString",{configurable:!0,enumerable:!1,value:Sa(e),writable:!0})}:Oa,Ws=Cr,Xs=us||function(t){return Rn.clearTimeout(t)},Ys=As&&1/J(new As([,-0]))[1]==Rt?function(t){return new As(t)}:xa,Qs=Ns?function(t){return Ns.get(t)}:xa,Zs=ps?function(t){return null==t?[]:(t=Da(t),l(ps(t),function(e){return rs.call(t,e)}))}:Aa,Ks=ps?function(t){for(var e=[];t;)p(e,Zs(t)),t=es(t);return e}:Aa,tc=Jn;(Cs&&tc(new Cs(new ArrayBuffer(1)))!=ae||xs&&tc(new xs)!=Jt||Es&&"[object Promise]"!=tc(Es.resolve())||As&&tc(new As)!=Kt||Is&&tc(new Is)!=re)&&(tc=function(t){var e=Jn(t),n=e==Yt?t.constructor:nt,r=n?Oo(n):"";if(r)switch(r){case js:return ae;case Ms:return Jt;case Ds:return"[object Promise]";case zs:return Kt;case Ps:return re}return e});var ec=Fa?Qo:Ia,nc=yo(Gs),rc=ds||function(t,e){return Rn.setTimeout(t,e)},ic=yo(Js),oc=function(t){var e=Vo(t,function(t){return n.size===st&&n.clear(),t}),n=e.cache;return e}(function(t){var e=[];return Ae.test(t)&&e.push(""),t.replace(Ie,function(t,n,r,i){e.push(r?i.replace(Ue,"$1"):n||t)}),e}),ac=Cr(function(t,e){return Xo(t)?Sn(t,In(e,1,Xo,!0)):[]}),sc=Cr(function(t,e){var n=Ro(e);return Xo(n)&&(n=nt),Xo(t)?Sn(t,In(e,1,Xo,!0),$i(n,2)):[]}),cc=Cr(function(t,e){var n=Ro(e);return Xo(n)&&(n=nt),Xo(t)?Sn(t,In(e,1,Xo,!0),nt,n):[]}),uc=Cr(function(t){var e=h(t,$r);return e.length&&e[0]===t[0]?Zn(e):[]}),lc=Cr(function(t){var e=Ro(t),n=h(t,$r);return e===Ro(n)?e=nt:n.pop(),n.length&&n[0]===t[0]?Zn(n,$i(e,2)):[]}),dc=Cr(function(t){var e=Ro(t),n=h(t,$r);return(e="function"==typeof e?e:nt)&&n.pop(),n.length&&n[0]===t[0]?Zn(n,nt,e):[]}),fc=Cr(No),hc=Ui(function(t,e){var n=null==t?0:t.length,r=ln(t,e);return wr(t,h(e,function(t){return ro(t,n)?+t:t}).sort(ni)),r}),pc=Cr(function(t){return Pr(In(t,1,Xo,!0))}),mc=Cr(function(t){var e=Ro(t);return Xo(e)&&(e=nt),Pr(In(t,1,Xo,!0),$i(e,2))}),gc=Cr(function(t){var e=Ro(t);return e="function"==typeof e?e:nt,Pr(In(t,1,Xo,!0),nt,e)}),vc=Cr(function(t,e){return Xo(t)?Sn(t,e):[]}),_c=Cr(function(t){return Fr(l(t,Xo))}),bc=Cr(function(t){var e=Ro(t);return Xo(e)&&(e=nt),Fr(l(t,Xo),$i(e,2))}),yc=Cr(function(t){var e=Ro(t);return e="function"==typeof e?e:nt,Fr(l(t,Xo),nt,e)}),wc=Cr(jo),Sc=Cr(function(t){var e=t.length,n=e>1?t[e-1]:nt;return n="function"==typeof n?(t.pop(),n):nt,Mo(t,n)}),Oc=Ui(function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,i=function(e){return ln(e,t)};return!(e>1||this.__actions__.length)&&r instanceof X&&ro(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:zo,args:[i],thisArg:nt}),new E(r,this.__chain__).thru(function(t){return e&&!t.length&&t.push(nt),t})):this.thru(i)}),Tc=li(function(t,e,n){$a.call(t,n)?++t[n]:un(t,n,1)}),Cc=bi(xo),xc=bi(Eo),Ec=li(function(t,e,n){$a.call(t,n)?t[n].push(e):un(t,n,[e])}),Ac=Cr(function(t,e,n){var r=-1,i="function"==typeof e,a=Wo(t)?Ra(t.length):[];return Fs(t,function(t){a[++r]=i?o(e,t,n):tr(t,e,n)}),a}),Ic=li(function(t,e,n){un(t,n,e)}),Rc=li(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),Nc=Cr(function(t,e){if(null==t)return[];var n=e.length;return n>1&&io(t,e[0],e[1])?e=[]:n>2&&io(e[0],e[1],e[2])&&(e=[e[0]]),gr(t,In(e,1),[])}),kc=ls||function(){return Rn.Date.now()},jc=Cr(function(t,e,n){var r=pt;if(n.length){var i=G(n,qi(jc));r|=bt}return ki(t,r,e,n,i)}),Mc=Cr(function(t,e,n){var r=pt|mt;if(n.length){var i=G(n,qi(Mc));r|=bt}return ki(e,r,t,n,i)}),Dc=Cr(function(t,e){return vn(t,1,e)}),zc=Cr(function(t,e,n){return vn(t,la(e)||0,n)});Vo.Cache=Le;var Pc=Ws(function(t,e){var n=(e=1==e.length&&$c(e[0])?h(e[0],j($i())):h(In(e,1),j($i()))).length;return Cr(function(r){for(var i=-1,a=ys(r.length,n);++i<a;)r[i]=e[i].call(this,r[i]);return o(t,this,r)})}),Lc=Cr(function(t,e){var n=G(e,qi(Lc));return ki(t,bt,nt,e,n)}),Uc=Cr(function(t,e){var n=G(e,qi(Uc));return ki(t,yt,nt,e,n)}),Bc=Ui(function(t,e){return ki(t,St,nt,nt,nt,e)}),Hc=Ai(Wn),Fc=Ai(function(t,e){return t>=e}),qc=er(function(){return arguments}())?er:function(t){return ea(t)&&$a.call(t,"callee")&&!rs.call(t,"callee")},$c=Ra.isArray,Vc=zn?j(zn):function(t){return ea(t)&&Jn(t)==oe},Gc=ms||Ia,Jc=Pn?j(Pn):function(t){return ea(t)&&Jn(t)==Ft},Wc=Ln?j(Ln):function(t){return ea(t)&&tc(t)==Jt},Xc=Un?j(Un):function(t){return ea(t)&&Jn(t)==Zt},Yc=Bn?j(Bn):function(t){return ea(t)&&tc(t)==Kt},Qc=Hn?j(Hn):function(t){return ea(t)&&Ko(t.length)&&!!yn[Jn(t)]},Zc=Ai(ur),Kc=Ai(function(t,e){return t<=e}),tu=di(function(t,e){if(uo(e)||Wo(e))si(e,ma(e),t);else for(var n in e)$a.call(e,n)&&rn(t,n,e[n])}),eu=di(function(t,e){si(e,ga(e),t)}),nu=di(function(t,e,n,r){si(e,ga(e),t,r)}),ru=di(function(t,e,n,r){si(e,ma(e),t,r)}),iu=Ui(ln),ou=Cr(function(t){return t.push(nt,ji),o(nu,nt,t)}),au=Cr(function(t){return t.push(nt,Mi),o(du,nt,t)}),su=Si(function(t,e,n){t[e]=n},Sa(Oa)),cu=Si(function(t,e,n){$a.call(t,e)?t[e].push(n):t[e]=[n]},$i),uu=Cr(tr),lu=di(function(t,e,n){hr(t,e,n)}),du=di(function(t,e,n,r){hr(t,e,n,r)}),fu=Ui(function(t,e){var n={};if(null==t)return n;var r=!1;e=h(e,function(e){return e=Gr(e,t),r||(r=e.length>1),e}),si(t,Hi(t),n),r&&(n=pn(n,ut|lt|dt,Di));for(var i=e.length;i--;)Lr(n,e[i]);return n}),hu=Ui(function(t,e){return null==t?{}:vr(t,e)}),pu=Ni(ma),mu=Ni(ga),gu=gi(function(t,e,n){return e=e.toLowerCase(),t+(n?ba(e):e)}),vu=gi(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),_u=gi(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),bu=mi("toLowerCase"),yu=gi(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),wu=gi(function(t,e,n){return t+(n?" ":"")+Ou(e)}),Su=gi(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Ou=mi("toUpperCase"),Tu=Cr(function(t,e){try{return o(t,nt,e)}catch(t){return Yo(t)?t:new ka(t)}}),Cu=Ui(function(t,e){return s(e,function(e){e=So(e),un(t,e,jc(t[e],t))}),t}),xu=yi(),Eu=yi(!0),Au=Cr(function(t,e){return function(n){return tr(n,t,e)}}),Iu=Cr(function(t,e){return function(n){return tr(t,n,e)}}),Ru=Ti(h),Nu=Ti(u),ku=Ti(v),ju=Ei(),Mu=Ei(!0),Du=Oi(function(t,e){return t+e},0),zu=Ri("ceil"),Pu=Oi(function(t,e){return t/e},1),Lu=Ri("floor"),Uu=Oi(function(t,e){return t*e},1),Bu=Ri("round"),Hu=Oi(function(t,e){return t-e},0);return n.after=function(t,e){if("function"!=typeof e)throw new La(ot);return t=ca(t),function(){if(--t<1)return e.apply(this,arguments)}},n.ary=Bo,n.assign=tu,n.assignIn=eu,n.assignInWith=nu,n.assignWith=ru,n.at=iu,n.before=Ho,n.bind=jc,n.bindAll=Cu,n.bindKey=Mc,n.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return $c(t)?t:[t]},n.chain=Do,n.chunk=function(t,e,n){e=(n?io(t,e,n):e===nt)?1:bs(ca(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var i=0,o=0,a=Ra(fs(r/e));i<r;)a[o++]=Rr(t,i,i+=e);return a},n.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},n.concat=function(){var t=arguments.length;if(!t)return[];for(var e=Ra(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return p($c(n)?ai(n):[n],In(e,1))},n.cond=function(t){var e=null==t?0:t.length,n=$i();return t=e?h(t,function(t){if("function"!=typeof t[1])throw new La(ot);return[n(t[0]),t[1]]}):[],Cr(function(n){for(var r=-1;++r<e;){var i=t[r];if(o(i[0],this,n))return o(i[1],this,n)}})},n.conforms=function(t){return mn(pn(t,ut))},n.constant=Sa,n.countBy=Tc,n.create=function(t,e){var n=Hs(t);return null==e?n:sn(n,e)},n.curry=Fo,n.curryRight=qo,n.debounce=$o,n.defaults=ou,n.defaultsDeep=au,n.defer=Dc,n.delay=zc,n.difference=ac,n.differenceBy=sc,n.differenceWith=cc,n.drop=function(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===nt?1:ca(e),Rr(t,e<0?0:e,r)):[]},n.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===nt?1:ca(e),e=r-e,Rr(t,0,e<0?0:e)):[]},n.dropRightWhile=function(t,e){return t&&t.length?Br(t,$i(e,3),!0,!0):[]},n.dropWhile=function(t,e){return t&&t.length?Br(t,$i(e,3),!0):[]},n.fill=function(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&io(t,e,n)&&(n=0,r=i),Cn(t,e,n,r)):[]},n.filter=function(t,e){return($c(t)?l:An)(t,$i(e,3))},n.flatMap=function(t,e){return In(Uo(t,e),1)},n.flatMapDeep=function(t,e){return In(Uo(t,e),Rt)},n.flatMapDepth=function(t,e,n){return n=n===nt?1:ca(n),In(Uo(t,e),n)},n.flatten=Ao,n.flattenDeep=function(t){return(null==t?0:t.length)?In(t,Rt):[]},n.flattenDepth=function(t,e){return(null==t?0:t.length)?(e=e===nt?1:ca(e),In(t,e)):[]},n.flip=function(t){return ki(t,Ot)},n.flow=xu,n.flowRight=Eu,n.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},n.functions=function(t){return null==t?[]:Mn(t,ma(t))},n.functionsIn=function(t){return null==t?[]:Mn(t,ga(t))},n.groupBy=Ec,n.initial=function(t){return(null==t?0:t.length)?Rr(t,0,-1):[]},n.intersection=uc,n.intersectionBy=lc,n.intersectionWith=dc,n.invert=su,n.invertBy=cu,n.invokeMap=Ac,n.iteratee=Ta,n.keyBy=Ic,n.keys=ma,n.keysIn=ga,n.map=Uo,n.mapKeys=function(t,e){var n={};return e=$i(e,3),Nn(t,function(t,r,i){un(n,e(t,r,i),t)}),n},n.mapValues=function(t,e){var n={};return e=$i(e,3),Nn(t,function(t,r,i){un(n,r,e(t,r,i))}),n},n.matches=function(t){return dr(pn(t,ut))},n.matchesProperty=function(t,e){return fr(t,pn(e,ut))},n.memoize=Vo,n.merge=lu,n.mergeWith=du,n.method=Au,n.methodOf=Iu,n.mixin=Ca,n.negate=Go,n.nthArg=function(t){return t=ca(t),Cr(function(e){return mr(e,t)})},n.omit=fu,n.omitBy=function(t,e){return va(t,Go($i(e)))},n.once=function(t){return Ho(2,t)},n.orderBy=function(t,e,n,r){return null==t?[]:($c(e)||(e=null==e?[]:[e]),n=r?nt:n,$c(n)||(n=null==n?[]:[n]),gr(t,e,n))},n.over=Ru,n.overArgs=Pc,n.overEvery=Nu,n.overSome=ku,n.partial=Lc,n.partialRight=Uc,n.partition=Rc,n.pick=hu,n.pickBy=va,n.property=Ea,n.propertyOf=function(t){return function(e){return null==t?nt:Dn(t,e)}},n.pull=fc,n.pullAll=No,n.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?yr(t,e,$i(n,2)):t},n.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?yr(t,e,nt,n):t},n.pullAt=hc,n.range=ju,n.rangeRight=Mu,n.rearg=Bc,n.reject=function(t,e){return($c(t)?l:An)(t,Go($i(e,3)))},n.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=$i(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return wr(t,i),n},n.rest=function(t,e){if("function"!=typeof t)throw new La(ot);return e=e===nt?e:ca(e),Cr(t,e)},n.reverse=ko,n.sampleSize=function(t,e,n){return e=(n?io(t,e,n):e===nt)?1:ca(e),($c(t)?tn:Er)(t,e)},n.set=function(t,e,n){return null==t?t:Ar(t,e,n)},n.setWith=function(t,e,n,r){return r="function"==typeof r?r:nt,null==t?t:Ar(t,e,n,r)},n.shuffle=function(t){return($c(t)?en:Ir)(t)},n.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&io(t,e,n)?(e=0,n=r):(e=null==e?0:ca(e),n=n===nt?r:ca(n)),Rr(t,e,n)):[]},n.sortBy=Nc,n.sortedUniq=function(t){return t&&t.length?Mr(t):[]},n.sortedUniqBy=function(t,e){return t&&t.length?Mr(t,$i(e,2)):[]},n.split=function(t,e,n){return n&&"number"!=typeof n&&io(t,e,n)&&(e=n=nt),(n=n===nt?Mt:n>>>0)?(t=fa(t),t&&("string"==typeof e||null!=e&&!Xc(e))&&!(e=zr(e))&&H(t)?Jr(Z(t),0,n):t.split(e,n)):[]},n.spread=function(t,e){if("function"!=typeof t)throw new La(ot);return e=null==e?0:bs(ca(e),0),Cr(function(n){var r=n[e],i=Jr(n,0,e);return r&&p(i,r),o(t,this,i)})},n.tail=function(t){var e=null==t?0:t.length;return e?Rr(t,1,e):[]},n.take=function(t,e,n){return t&&t.length?(e=n||e===nt?1:ca(e),Rr(t,0,e<0?0:e)):[]},n.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===nt?1:ca(e),e=r-e,Rr(t,e<0?0:e,r)):[]},n.takeRightWhile=function(t,e){return t&&t.length?Br(t,$i(e,3),!1,!0):[]},n.takeWhile=function(t,e){return t&&t.length?Br(t,$i(e,3)):[]},n.tap=function(t,e){return e(t),t},n.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new La(ot);return ta(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),$o(t,e,{leading:r,maxWait:e,trailing:i})},n.thru=zo,n.toArray=aa,n.toPairs=pu,n.toPairsIn=mu,n.toPath=function(t){return $c(t)?h(t,So):oa(t)?[t]:ai(oc(fa(t)))},n.toPlainObject=da,n.transform=function(t,e,n){var r=$c(t),i=r||Gc(t)||Qc(t);if(e=$i(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:ta(t)&&Qo(o)?Hs(es(t)):{}}return(i?s:Nn)(t,function(t,r,i){return e(n,t,r,i)}),n},n.unary=function(t){return Bo(t,1)},n.union=pc,n.unionBy=mc,n.unionWith=gc,n.uniq=function(t){return t&&t.length?Pr(t):[]},n.uniqBy=function(t,e){return t&&t.length?Pr(t,$i(e,2)):[]},n.uniqWith=function(t,e){return e="function"==typeof e?e:nt,t&&t.length?Pr(t,nt,e):[]},n.unset=function(t,e){return null==t||Lr(t,e)},n.unzip=jo,n.unzipWith=Mo,n.update=function(t,e,n){return null==t?t:Ur(t,e,Vr(n))},n.updateWith=function(t,e,n,r){return r="function"==typeof r?r:nt,null==t?t:Ur(t,e,Vr(n),r)},n.values=_a,n.valuesIn=function(t){return null==t?[]:M(t,ga(t))},n.without=vc,n.words=wa,n.wrap=function(t,e){return Lc(Vr(e),t)},n.xor=_c,n.xorBy=bc,n.xorWith=yc,n.zip=wc,n.zipObject=function(t,e){return qr(t||[],e||[],rn)},n.zipObjectDeep=function(t,e){return qr(t||[],e||[],Ar)},n.zipWith=Sc,n.entries=pu,n.entriesIn=mu,n.extend=eu,n.extendWith=nu,Ca(n,n),n.add=Du,n.attempt=Tu,n.camelCase=gu,n.capitalize=ba,n.ceil=zu,n.clamp=function(t,e,n){return n===nt&&(n=e,e=nt),n!==nt&&(n=(n=la(n))===n?n:0),e!==nt&&(e=(e=la(e))===e?e:0),dn(la(t),e,n)},n.clone=function(t){return pn(t,dt)},n.cloneDeep=function(t){return pn(t,ut|dt)},n.cloneDeepWith=function(t,e){return e="function"==typeof e?e:nt,pn(t,ut|dt,e)},n.cloneWith=function(t,e){return e="function"==typeof e?e:nt,pn(t,dt,e)},n.conformsTo=function(t,e){return null==e||gn(t,e,ma(e))},n.deburr=ya,n.defaultTo=function(t,e){return null==t||t!==t?e:t},n.divide=Pu,n.endsWith=function(t,e,n){t=fa(t),e=zr(e);var r=t.length,i=n=n===nt?r:dn(ca(n),0,r);return(n-=e.length)>=0&&t.slice(n,i)==e},n.eq=Jo,n.escape=function(t){return t=fa(t),t&&Se.test(t)?t.replace(ye,$n):t},n.escapeRegExp=function(t){return t=fa(t),t&&Ne.test(t)?t.replace(Re,"\\$&"):t},n.every=function(t,e,n){var r=$c(t)?u:On;return n&&io(t,e,n)&&(e=nt),r(t,$i(e,3))},n.find=Cc,n.findIndex=xo,n.findKey=function(t,e){return y(t,$i(e,3),Nn)},n.findLast=xc,n.findLastIndex=Eo,n.findLastKey=function(t,e){return y(t,$i(e,3),kn)},n.floor=Lu,n.forEach=Po,n.forEachRight=Lo,n.forIn=function(t,e){return null==t?t:$s(t,$i(e,3),ga)},n.forInRight=function(t,e){return null==t?t:Vs(t,$i(e,3),ga)},n.forOwn=function(t,e){return t&&Nn(t,$i(e,3))},n.forOwnRight=function(t,e){return t&&kn(t,$i(e,3))},n.get=ha,n.gt=Hc,n.gte=Fc,n.has=function(t,e){return null!=t&&Qi(t,e,Xn)},n.hasIn=pa,n.head=Io,n.identity=Oa,n.includes=function(t,e,n,r){t=Wo(t)?t:_a(t),n=n&&!r?ca(n):0;var i=t.length;return n<0&&(n=bs(i+n,0)),ia(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&S(t,e,n)>-1},n.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:ca(n);return i<0&&(i=bs(r+i,0)),S(t,e,i)},n.inRange=function(t,e,n){return e=sa(e),n===nt?(n=e,e=0):n=sa(n),t=la(t),Qn(t,e,n)},n.invoke=uu,n.isArguments=qc,n.isArray=$c,n.isArrayBuffer=Vc,n.isArrayLike=Wo,n.isArrayLikeObject=Xo,n.isBoolean=function(t){return!0===t||!1===t||ea(t)&&Jn(t)==Ht},n.isBuffer=Gc,n.isDate=Jc,n.isElement=function(t){return ea(t)&&1===t.nodeType&&!ra(t)},n.isEmpty=function(t){if(null==t)return!0;if(Wo(t)&&($c(t)||"string"==typeof t||"function"==typeof t.splice||Gc(t)||Qc(t)||qc(t)))return!t.length;var e=tc(t);if(e==Jt||e==Kt)return!t.size;if(uo(t))return!sr(t).length;for(var n in t)if($a.call(t,n))return!1;return!0},n.isEqual=function(t,e){return nr(t,e)},n.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:nt)?n(t,e):nt;return r===nt?nr(t,e,nt,n):!!r},n.isError=Yo,n.isFinite=function(t){return"number"==typeof t&&gs(t)},n.isFunction=Qo,n.isInteger=Zo,n.isLength=Ko,n.isMap=Wc,n.isMatch=function(t,e){return t===e||ir(t,e,Gi(e))},n.isMatchWith=function(t,e,n){return n="function"==typeof n?n:nt,ir(t,e,Gi(e),n)},n.isNaN=function(t){return na(t)&&t!=+t},n.isNative=function(t){if(ec(t))throw new ka(it);return or(t)},n.isNil=function(t){return null==t},n.isNull=function(t){return null===t},n.isNumber=na,n.isObject=ta,n.isObjectLike=ea,n.isPlainObject=ra,n.isRegExp=Xc,n.isSafeInteger=function(t){return Zo(t)&&t>=-Nt&&t<=Nt},n.isSet=Yc,n.isString=ia,n.isSymbol=oa,n.isTypedArray=Qc,n.isUndefined=function(t){return t===nt},n.isWeakMap=function(t){return ea(t)&&tc(t)==re},n.isWeakSet=function(t){return ea(t)&&Jn(t)==ie},n.join=function(t,e){return null==t?"":vs.call(t,e)},n.kebabCase=vu,n.last=Ro,n.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return n!==nt&&(i=(i=ca(n))<0?bs(r+i,0):ys(i,r-1)),e===e?Y(t,e,i):w(t,T,i,!0)},n.lowerCase=_u,n.lowerFirst=bu,n.lt=Zc,n.lte=Kc,n.max=function(t){return t&&t.length?Tn(t,Oa,Wn):nt},n.maxBy=function(t,e){return t&&t.length?Tn(t,$i(e,2),Wn):nt},n.mean=function(t){return C(t,Oa)},n.meanBy=function(t,e){return C(t,$i(e,2))},n.min=function(t){return t&&t.length?Tn(t,Oa,ur):nt},n.minBy=function(t,e){return t&&t.length?Tn(t,$i(e,2),ur):nt},n.stubArray=Aa,n.stubFalse=Ia,n.stubObject=function(){return{}},n.stubString=function(){return""},n.stubTrue=function(){return!0},n.multiply=Uu,n.nth=function(t,e){return t&&t.length?mr(t,ca(e)):nt},n.noConflict=function(){return Rn._===this&&(Rn._=Xa),this},n.noop=xa,n.now=kc,n.pad=function(t,e,n){t=fa(t);var r=(e=ca(e))?Q(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return Ci(hs(i),n)+t+Ci(fs(i),n)},n.padEnd=function(t,e,n){t=fa(t);var r=(e=ca(e))?Q(t):0;return e&&r<e?t+Ci(e-r,n):t},n.padStart=function(t,e,n){t=fa(t);var r=(e=ca(e))?Q(t):0;return e&&r<e?Ci(e-r,n)+t:t},n.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),Ss(fa(t).replace(je,""),e||0)},n.random=function(t,e,n){if(n&&"boolean"!=typeof n&&io(t,e,n)&&(e=n=nt),n===nt&&("boolean"==typeof e?(n=e,e=nt):"boolean"==typeof t&&(n=t,t=nt)),t===nt&&e===nt?(t=0,e=1):(t=sa(t),e===nt?(e=t,t=0):e=sa(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=Os();return ys(t+i*(e-t+xn("1e-"+((i+"").length-1))),e)}return Sr(t,e)},n.reduce=function(t,e,n){var r=$c(t)?m:A,i=arguments.length<3;return r(t,$i(e,4),n,i,Fs)},n.reduceRight=function(t,e,n){var r=$c(t)?g:A,i=arguments.length<3;return r(t,$i(e,4),n,i,qs)},n.repeat=function(t,e,n){return e=(n?io(t,e,n):e===nt)?1:ca(e),Tr(fa(t),e)},n.replace=function(){var t=arguments,e=fa(t[0]);return t.length<3?e:e.replace(t[1],t[2])},n.result=function(t,e,n){var r=-1,i=(e=Gr(e,t)).length;for(i||(i=1,t=nt);++r<i;){var o=null==t?nt:t[So(e[r])];o===nt&&(r=i,o=n),t=Qo(o)?o.call(t):o}return t},n.round=Bu,n.runInContext=t,n.sample=function(t){return($c(t)?Ke:xr)(t)},n.size=function(t){if(null==t)return 0;if(Wo(t))return ia(t)?Q(t):t.length;var e=tc(t);return e==Jt||e==Kt?t.size:sr(t).length},n.snakeCase=yu,n.some=function(t,e,n){var r=$c(t)?v:Nr;return n&&io(t,e,n)&&(e=nt),r(t,$i(e,3))},n.sortedIndex=function(t,e){return kr(t,e)},n.sortedIndexBy=function(t,e,n){return jr(t,e,$i(n,2))},n.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=kr(t,e);if(r<n&&Jo(t[r],e))return r}return-1},n.sortedLastIndex=function(t,e){return kr(t,e,!0)},n.sortedLastIndexBy=function(t,e,n){return jr(t,e,$i(n,2),!0)},n.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=kr(t,e,!0)-1;if(Jo(t[n],e))return n}return-1},n.startCase=wu,n.startsWith=function(t,e,n){return t=fa(t),n=null==n?0:dn(ca(n),0,t.length),e=zr(e),t.slice(n,n+e.length)==e},n.subtract=Hu,n.sum=function(t){return t&&t.length?R(t,Oa):0},n.sumBy=function(t,e){return t&&t.length?R(t,$i(e,2)):0},n.template=function(t,e,r){var i=n.templateSettings;r&&io(t,e,r)&&(e=nt),t=fa(t),e=nu({},e,i,ji);var o,a,s=nu({},e.imports,i.imports,ji),c=ma(s),u=M(s,c),l=0,d=e.interpolate||We,f="__p += '",h=za((e.escape||We).source+"|"+d.source+"|"+(d===Ce?Be:We).source+"|"+(e.evaluate||We).source+"|$","g"),p="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++bn+"]")+"\n";t.replace(h,function(e,n,r,i,s,c){return r||(r=i),f+=t.slice(l,c).replace(Xe,U),n&&(o=!0,f+="' +\n__e("+n+") +\n'"),s&&(a=!0,f+="';\n"+s+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=c+e.length,e}),f+="';\n";var m=e.variable;m||(f="with (obj) {\n"+f+"\n}\n"),f=(a?f.replace(ge,""):f).replace(ve,"$1").replace(_e,"$1;"),f="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var g=Tu(function(){return ja(c,p+"return "+f).apply(nt,u)});if(g.source=f,Yo(g))throw g;return g},n.times=function(t,e){if((t=ca(t))<1||t>Nt)return[];var n=Mt,r=ys(t,Mt);e=$i(e),t-=Mt;for(var i=N(r,e);++n<t;)e(n);return i},n.toFinite=sa,n.toInteger=ca,n.toLength=ua,n.toLower=function(t){return fa(t).toLowerCase()},n.toNumber=la,n.toSafeInteger=function(t){return t?dn(ca(t),-Nt,Nt):0===t?t:0},n.toString=fa,n.toUpper=function(t){return fa(t).toUpperCase()},n.trim=function(t,e,n){if((t=fa(t))&&(n||e===nt))return t.replace(ke,"");if(!t||!(e=zr(e)))return t;var r=Z(t),i=Z(e);return Jr(r,z(r,i),P(r,i)+1).join("")},n.trimEnd=function(t,e,n){if((t=fa(t))&&(n||e===nt))return t.replace(Me,"");if(!t||!(e=zr(e)))return t;var r=Z(t);return Jr(r,0,P(r,Z(e))+1).join("")},n.trimStart=function(t,e,n){if((t=fa(t))&&(n||e===nt))return t.replace(je,"");if(!t||!(e=zr(e)))return t;var r=Z(t);return Jr(r,z(r,Z(e))).join("")},n.truncate=function(t,e){var n=Tt,r=Ct;if(ta(e)){var i="separator"in e?e.separator:i;n="length"in e?ca(e.length):n,r="omission"in e?zr(e.omission):r}var o=(t=fa(t)).length;if(H(t)){var a=Z(t);o=a.length}if(n>=o)return t;var s=n-Q(r);if(s<1)return r;var c=a?Jr(a,0,s).join(""):t.slice(0,s);if(i===nt)return c+r;if(a&&(s+=c.length-s),Xc(i)){if(t.slice(s).search(i)){var u,l=c;for(i.global||(i=za(i.source,fa(He.exec(i))+"g")),i.lastIndex=0;u=i.exec(l);)var d=u.index;c=c.slice(0,d===nt?s:d)}}else if(t.indexOf(zr(i),s)!=s){var f=c.lastIndexOf(i);f>-1&&(c=c.slice(0,f))}return c+r},n.unescape=function(t){return t=fa(t),t&&we.test(t)?t.replace(be,Vn):t},n.uniqueId=function(t){var e=++Va;return fa(t)+e},n.upperCase=Su,n.upperFirst=Ou,n.each=Po,n.eachRight=Lo,n.first=Io,Ca(n,function(){var t={};return Nn(n,function(e,r){$a.call(n.prototype,r)||(t[r]=e)}),t}(),{chain:!1}),n.VERSION="4.17.4",s(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){n[t].placeholder=n}),s(["drop","take"],function(t,e){X.prototype[t]=function(n){n=n===nt?1:bs(ca(n),0);var r=this.__filtered__&&!e?new X(this):this.clone();return r.__filtered__?r.__takeCount__=ys(n,r.__takeCount__):r.__views__.push({size:ys(n,Mt),type:t+(r.__dir__<0?"Right":"")}),r},X.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),s(["filter","map","takeWhile"],function(t,e){var n=e+1,r=n==At||3==n;X.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:$i(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),s(["head","last"],function(t,e){var n="take"+(e?"Right":"");X.prototype[t]=function(){return this[n](1).value()[0]}}),s(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");X.prototype[t]=function(){return this.__filtered__?new X(this):this[n](1)}}),X.prototype.compact=function(){return this.filter(Oa)},X.prototype.find=function(t){return this.filter(t).head()},X.prototype.findLast=function(t){return this.reverse().find(t)},X.prototype.invokeMap=Cr(function(t,e){return"function"==typeof t?new X(this):this.map(function(n){return tr(n,t,e)})}),X.prototype.reject=function(t){return this.filter(Go($i(t)))},X.prototype.slice=function(t,e){t=ca(t);var n=this;return n.__filtered__&&(t>0||e<0)?new X(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==nt&&(n=(e=ca(e))<0?n.dropRight(-e):n.take(e-t)),n)},X.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},X.prototype.toArray=function(){return this.take(Mt)},Nn(X.prototype,function(t,e){var r=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),o=n[i?"take"+("last"==e?"Right":""):e],a=i||/^find/.test(e);o&&(n.prototype[e]=function(){var e=this.__wrapped__,s=i?[1]:arguments,c=e instanceof X,u=s[0],l=c||$c(e),d=function(t){var e=o.apply(n,p([t],s));return i&&f?e[0]:e};l&&r&&"function"==typeof u&&1!=u.length&&(c=l=!1);var f=this.__chain__,h=!!this.__actions__.length,m=a&&!f,g=c&&!h;if(!a&&l){e=g?e:new X(this);var v=t.apply(e,s);return v.__actions__.push({func:zo,args:[d],thisArg:nt}),new E(v,f)}return m&&g?t.apply(this,s):(v=this.thru(d),m?i?v.value()[0]:v.value():v)})}),s(["pop","push","shift","sort","splice","unshift"],function(t){var e=Ua[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);n.prototype[t]=function(){var t=arguments;if(i&&!this.__chain__){var n=this.value();return e.apply($c(n)?n:[],t)}return this[r](function(n){return e.apply($c(n)?n:[],t)})}}),Nn(X.prototype,function(t,e){var r=n[e];if(r){var i=r.name+"";(ks[i]||(ks[i]=[])).push({name:e,func:r})}}),ks[wi(nt,mt).name]=[{name:"wrapper",func:nt}],X.prototype.clone=function(){var t=new X(this.__wrapped__);return t.__actions__=ai(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=ai(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=ai(this.__views__),t},X.prototype.reverse=function(){if(this.__filtered__){var t=new X(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},X.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=$c(t),r=e<0,i=n?t.length:0,o=Xi(0,i,this.__views__),a=o.start,s=o.end,c=s-a,u=r?s:a-1,l=this.__iteratees__,d=l.length,f=0,h=ys(c,this.__takeCount__);if(!n||!r&&i==c&&h==c)return Hr(t,this.__actions__);var p=[];t:for(;c--&&f<h;){for(var m=-1,g=t[u+=e];++m<d;){var v=l[m],_=v.iteratee,b=v.type,y=_(g);if(b==It)g=y;else if(!y){if(b==At)continue t;break t}}p[f++]=g}return p},n.prototype.at=Oc,n.prototype.chain=function(){return Do(this)},n.prototype.commit=function(){return new E(this.value(),this.__chain__)},n.prototype.next=function(){this.__values__===nt&&(this.__values__=aa(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?nt:this.__values__[this.__index__++]}},n.prototype.plant=function(t){for(var e,n=this;n instanceof _;){var r=Co(n);r.__index__=0,r.__values__=nt,e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e},n.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof X){var e=t;return this.__actions__.length&&(e=new X(this)),(e=e.reverse()).__actions__.push({func:zo,args:[ko],thisArg:nt}),new E(e,this.__chain__)}return this.thru(ko)},n.prototype.toJSON=n.prototype.valueOf=n.prototype.value=function(){return Hr(this.__wrapped__,this.__actions__)},n.prototype.first=n.prototype.head,as&&(n.prototype[as]=function(){return this}),n}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Rn._=Gn,define(function(){return Gn})):kn?((kn.exports=Gn)._=Gn,Nn._=Gn):Rn._=Gn}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],36:[function(e,n,r){!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof n&&n.exports?n.exports=e():t.Parsimmon=e()}(this,function(){"use strict";function e(t){if(!(this instanceof e))return new e(t);this._=t}function n(t){return t instanceof e}function r(t,e){return{status:!0,index:t,value:e,furthest:-1,expected:[]}}function i(t,e){return{status:!1,index:-1,value:null,furthest:t,expected:[e]}}function o(t,e){if(!e)return t;if(t.furthest>e.furthest)return t;var n=t.furthest===e.furthest?a(t.expected,e.expected):e.expected;return{status:t.status,index:t.index,value:t.value,furthest:e.furthest,expected:n}}function a(t,e){var n=t.length,r=e.length;if(0===n)return e;if(0===r)return t;for(var i={},o=0;o<n;o++)i[t[o]]=!0;for(var a=0;a<r;a++)i[e[a]]=!0;var s=[];for(var c in i)i.hasOwnProperty(c)&&s.push(c);return s.sort(),s}function s(t){if(!n(t))throw new Error("not a parser: "+t)}function c(t){if("number"!=typeof t)throw new Error("not a number: "+t)}function u(t){if(!(t instanceof RegExp))throw new Error("not a regexp: "+t);for(var e=y(t),n=0;n<e.length;n++){var r=e.charAt(n);if("i"!=r&&"m"!=r&&"u"!=r)throw new Error('unsupported regexp flag "'+r+'": '+t)}}function l(t){if("function"!=typeof t)throw new Error("not a function: "+t)}function d(t){if("string"!=typeof t)throw new Error("not a string: "+t)}function f(t){return 1===t.length?t[0]:"one of "+t.join(", ")}function h(t,e){var n=e.index,r=n.offset;if(r===t.length)return", got the end of the input";var i=r>0?"'...":"'",o=t.length-r>12?"...'":"'";return" at line "+n.line+" column "+n.column+", got "+i+t.slice(r,r+12)+o}function p(t,e){return"expected "+f(e.expected)+h(t,e)}function m(){for(var t=[].slice.call(arguments),n=t.length,i=0;i<n;i+=1)s(t[i]);return e(function(e,i){for(var a,s=new Array(n),c=0;c<n;c+=1){if(!(a=o(t[c]._(e,i),a)).status)return a;s[c]=a.value,i=a.index}return o(r(i,s),a)})}function g(){var t=[].slice.call(arguments);if(0===t.length)throw new Error("seqMap needs at least one argument");var e=t.pop();return l(e),m.apply(null,t).map(function(t){return e.apply(null,t)})}function v(){var t=[].slice.call(arguments),n=t.length;if(0===n)return T("zero alternates");for(var r=0;r<n;r+=1)s(t[r]);return e(function(e,n){for(var r,i=0;i<t.length;i+=1)if((r=o(t[i]._(e,n),r)).status)return r;return r})}function _(t,e){s(t),s(e);var n=e.then(t).many();return t.chain(function(t){return n.map(function(e){return[t].concat(e)})})}function b(t){d(t);var n="'"+t+"'";return e(function(e,o){var a=o+t.length,s=e.slice(o,a);return s===t?r(a,s):i(o,n)})}function y(t){var e=""+t;return e.slice(e.lastIndexOf("/")+1)}function w(t){return RegExp("^(?:"+t.source+")",y(t))}function S(t,n){u(t),arguments.length>=2?c(n):n=0;var o=w(t),a=""+t;return e(function(t,e){var s=o.exec(t.slice(e));if(s){var c=s[0],u=s[n];if(null!=u)return r(e+c.length,u)}return i(e,a)})}function O(t){return e(function(e,n){return r(n,t)})}function T(t){return e(function(e,n){return i(n,t)})}function C(t){if(n(t))return e(function(e,n){var r=t._(e,n);return r.index=n,r.value="",r});if("string"==typeof t)return C(b(t));if(t instanceof RegExp)return C(S(t));throw new Error("not a string, regexp, or parser: "+t)}function x(t){return l(t),e(function(e,n){var o=e.charAt(n);return n<e.length&&t(o)?r(n+1,o):i(n,"a character matching "+t)})}function E(t,e){var n=t.slice(0,e).split("\n");return{offset:e,line:n.length,column:n[n.length-1].length+1}}function A(){return T("fantasy-land/empty")}var I=e.prototype;I.parse=function(t){if("string"!=typeof t)throw new Error(".parse must be called with a string as its argument");var e=this.skip(k)._(t,0);return e.status?{status:!0,value:e.value}:{status:!1,index:E(t,e.furthest),expected:e.expected}},I.tryParse=function(t){var e=this.parse(t);if(e.status)return e.value;var n=p(t,e),r=new Error(n);throw r.type="ParsimmonError",r.result=e,r},I.or=function(t){return v(this,t)},I.then=function(t){if("function"==typeof t)throw new Error("chaining features of .then are no longer supported, use .chain instead");return s(t),m(this,t).map(function(t){return t[1]})},I.many=function(){var n=this;return e(function(e,i){for(var a=[],s=t;;){if(!(s=o(n._(e,i),s)).status)return o(r(i,a),s);i=s.index,a.push(s.value)}})},I.times=function(n,i){var a=this;return arguments.length<2&&(i=n),c(n),c(i),e(function(e,s){for(var c=[],u=t,l=t,d=0;d<n;d+=1){if(u=a._(e,s),l=o(u,l),!u.status)return l;s=u.index,c.push(u.value)}for(;d<i&&(u=a._(e,s),l=o(u,l),u.status);d+=1)s=u.index,c.push(u.value);return o(r(s,c),l)})},I.result=function(t){return this.map(function(){return t})},I.atMost=function(t){return this.times(0,t)},I.atLeast=function(t){return g(this.times(t),this.many(),function(t,e){return t.concat(e)})},I.map=function(t){l(t);var n=this;return e(function(e,i){var a=n._(e,i);return a.status?o(r(a.index,t(a.value)),a):a})},I["fantasy-land/map"]=I.map,I.skip=function(t){return m(this,t).map(function(t){return t[0]})},I.mark=function(){return g(j,this,j,function(t,e,n){return{start:t,value:e,end:n}})},I.lookahead=function(t){return this.skip(C(t))},I.desc=function(t){var n=this;return e(function(e,r){var i=n._(e,r);return i.status||(i.expected=[t]),i})},I.fallback=function(t){return this.or(O(t))};var R=e(function(t,e){return e>=t.length?i(e,"any character"):r(e+1,t.charAt(e))}),N=e(function(t,e){return r(t.length,t.slice(e))}),k=e(function(t,e){return e<t.length?i(e,"EOF"):r(e,null)}),j=e(function(t,e){return r(e,E(t,e))});I.concat=I.or,I["fantasy-land/concat"]=I.concat,I.empty=A,I["fantasy-land/empty"]=I.empty,I.of=O,I["fantasy-land/of"]=I.of,I.ap=function(t){return g(t,this,function(t,e){return t(e)})},I["fantasy-land/ap"]=I.ap,I.chain=function(t){var n=this;return e(function(e,r){var i=n._(e,r);return i.status?o(t(i.value)._(e,i.index),i):i})},I["fantasy-land/chain"]=I.chain;var M=S(/[0-9]/).desc("a digit"),D=S(/[0-9]*/).desc("optional digits"),z=S(/[a-z]/i).desc("a letter"),P=S(/[a-z]*/i).desc("optional letters"),L=S(/\s*/).desc("optional whitespace"),U=S(/\s+/).desc("whitespace");return e.all=N,e.alt=v,e.any=R,e.custom=function(t){return e(t(r,i))},e.digit=M,e.digits=D,e.eof=k,e.fail=T,e.formatError=p,e.index=j,e.isParser=n,e.lazy=function(n,r){arguments.length<2&&(r=n,n=t);var i=e(function(t,e){return i._=r()._,i._(t,e)});return n?i.desc(n):i},e.letter=z,e.letters=P,e.lookahead=C,e.makeFailure=i,e.makeSuccess=r,e.noneOf=function(t){return x(function(e){return t.indexOf(e)<0})},e.oneOf=function(t){return x(function(e){return t.indexOf(e)>=0})},e.optWhitespace=L,e.Parser=e,e.regex=S,e.regexp=S,e.sepBy=function(t,e){return _(t,e).or(O([]))},e.sepBy1=_,e.seq=m,e.seqMap=g,e.string=b,e.succeed=O,e.takeWhile=function(t){return l(t),e(function(e,n){for(var i=n;i<e.length&&t(e.charAt(i));)i++;return r(i,e.slice(n,i))})},e.test=x,e.whitespace=U,e.empty=A,e["fantasy-land/empty"]=A,e.of=O,e["fantasy-land/of"]=O,e})},{}],37:[function(e,n,r){(function(e){"use strict";!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof r?n.exports=e():t.store=e()}(this,function(){var n,r={},i="undefined"!=typeof window?window:e,o=i.document,a="localStorage";if(r.disabled=!1,r.version="1.3.20",r.set=function(t,e){},r.get=function(t,e){},r.has=function(e){return r.get(e)!==t},r.remove=function(t){},r.clear=function(){},r.transact=function(t,e,n){null==n&&(n=e,e=null),null==e&&(e={});var i=r.get(t,e);n(i),r.set(t,i)},r.getAll=function(){},r.forEach=function(){},r.serialize=function(t){return JSON.stringify(t)},r.deserialize=function(e){if("string"!=typeof e)return t;try{return JSON.parse(e)}catch(n){return e||t}},function(){try{return a in i&&i[a]}catch(t){return!1}}())n=i[a],r.set=function(e,i){return i===t?r.remove(e):(n.setItem(e,r.serialize(i)),i)},r.get=function(e,i){var o=r.deserialize(n.getItem(e));return o===t?i:o},r.remove=function(t){n.removeItem(t)},r.clear=function(){n.clear()},r.getAll=function(){var t={};return r.forEach(function(e,n){t[e]=n}),t},r.forEach=function(t){for(var e=0;e<n.length;e++){var i=n.key(e);t(i,r.get(i))}};else if(o&&o.documentElement.addBehavior){var s,c;try{(c=new ActiveXObject("htmlfile")).open(),c.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),c.close(),s=c.w.frames[0].document,n=s.createElement("div")}catch(t){n=o.createElement("div"),s=o.body}var u=function(t){return function(){var e=Array.prototype.slice.call(arguments,0);e.unshift(n),s.appendChild(n),n.addBehavior("#default#userData"),n.load(a);var i=t.apply(r,e);return s.removeChild(n),i}},l=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),d=function(t){return t.replace(/^d/,"___$&").replace(l,"___")};r.set=u(function(e,n,i){return n=d(n),i===t?r.remove(n):(e.setAttribute(n,r.serialize(i)),e.save(a),i)}),r.get=u(function(e,n,i){n=d(n);var o=r.deserialize(e.getAttribute(n));return o===t?i:o}),r.remove=u(function(t,e){e=d(e),t.removeAttribute(e),t.save(a)}),r.clear=u(function(t){var e=t.XMLDocument.documentElement.attributes;t.load(a);for(var n=e.length-1;n>=0;n--)t.removeAttribute(e[n].name);t.save(a)}),r.getAll=function(t){var e={};return r.forEach(function(t,n){e[t]=n}),e},r.forEach=u(function(t,e){for(var n,i=t.XMLDocument.documentElement.attributes,o=0;n=i[o];++o)e(n.name,r.deserialize(t.getAttribute(n.name)))})}try{var f="__storejs__";r.set(f,f),r.get(f)!=f&&(r.disabled=!0),r.remove(f)}catch(t){r.disabled=!0}return r.enabled=!r.disabled,r})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],38:[function(t,e,n){!function(t,r){"use strict";var i="model",o="name",a="type",s="vendor",c="version",u="mobile",l="tablet",d={extend:function(t,e){var n={};for(var r in t)e[r]&&e[r].length%2==0?n[r]=e[r].concat(t[r]):n[r]=t[r];return n},has:function(t,e){return"string"==typeof t&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()},major:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},f={rgx:function(t,e){for(var n,r,i,o,a,s,c=0;c<e.length&&!a;){var u=e[c],l=e[c+1];for(n=r=0;n<u.length&&!a;)if(a=u[n++].exec(t))for(i=0;i<l.length;i++)s=a[++r],"object"==typeof(o=l[i])&&o.length>0?2==o.length?"function"==typeof o[1]?this[o[0]]=o[1].call(this,s):this[o[0]]=o[1]:3==o.length?"function"!=typeof o[1]||o[1].exec&&o[1].test?this[o[0]]=s?s.replace(o[1],o[2]):void 0:this[o[0]]=s?o[1].call(this,s,o[2]):void 0:4==o.length&&(this[o[0]]=s?o[3].call(this,s.replace(o[1],o[2])):void 0):this[o]=s||void 0;c+=2}},str:function(t,e){for(var n in e)if("object"==typeof e[n]&&e[n].length>0){for(var r=0;r<e[n].length;r++)if(d.has(e[n][r],t))return"?"===n?void 0:n}else if(d.has(e[n],t))return"?"===n?void 0:n;return t}},h={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},p={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[o,c],[/(opios)[\/\s]+([\w\.]+)/i],[[o,"Opera Mini"],c],[/\s(opr)\/([\w\.]+)/i],[[o,"Opera"],c],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser)\/([\w\.-]+)/i],[o,c],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[o,"IE"],c],[/(edge)\/((\d+)?[\w\.]+)/i],[o,c],[/(yabrowser)\/([\w\.]+)/i],[[o,"Yandex"],c],[/(puffin)\/([\w\.]+)/i],[[o,"Puffin"],c],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[o,"UCBrowser"],c],[/(comodo_dragon)\/([\w\.]+)/i],[[o,/_/g," "],c],[/(micromessenger)\/([\w\.]+)/i],[[o,"WeChat"],c],[/(QQ)\/([\d\.]+)/i],[o,c],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[o,c],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[c,[o,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[c,[o,"Facebook"]],[/(headlesschrome) ([\w\.]+)/i],[c,[o,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[o,/(.+)/,"$1 WebView"],c],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[o,/(.+(?:g|us))(.+)/,"$1 $2"],c],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[c,[o,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[o,c],[/(dolfin)\/([\w\.]+)/i],[[o,"Dolphin"],c],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[o,"Chrome"],c],[/(coast)\/([\w\.]+)/i],[[o,"Opera Coast"],c],[/fxios\/([\w\.-]+)/i],[c,[o,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[c,[o,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[c,o],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[o,[c,f.str,h.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[o,c],[/(navigator|netscape)\/([\w\.-]+)/i],[[o,"Netscape"],c],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[o,c]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",d.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",d.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",d.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[i,s,[a,l]],[/applecoremedia\/[\w\.]+ \((ipad)/],[i,[s,"Apple"],[a,l]],[/(apple\s{0,1}tv)/i],[[i,"Apple TV"],[s,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[s,i,[a,l]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[i,[s,"Amazon"],[a,l]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[i,f.str,h.device.amazon.model],[s,"Amazon"],[a,u]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[i,s,[a,u]],[/\((ip[honed|\s\w*]+);/i],[i,[s,"Apple"],[a,u]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[s,i,[a,u]],[/\(bb10;\s(\w+)/i],[i,[s,"BlackBerry"],[a,u]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[i,[s,"Asus"],[a,l]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[s,"Sony"],[i,"Xperia Tablet"],[a,l]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[i,[s,"Sony"],[a,u]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[s,i,[a,"console"]],[/android.+;\s(shield)\sbuild/i],[i,[s,"Nvidia"],[a,"console"]],[/(playstation\s[34portablevi]+)/i],[i,[s,"Sony"],[a,"console"]],[/(sprint\s(\w+))/i],[[s,f.str,h.device.sprint.vendor],[i,f.str,h.device.sprint.model],[a,u]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[s,i,[a,l]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[s,[i,/_/g," "],[a,u]],[/(nexus\s9)/i],[i,[s,"HTC"],[a,l]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[i,[s,"Huawei"],[a,u]],[/(microsoft);\s(lumia[\s\w]+)/i],[s,i,[a,u]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[i,[s,"Microsoft"],[a,"console"]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[s,"Microsoft"],[a,u]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[i,[s,"Motorola"],[a,u]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[i,[s,"Motorola"],[a,l]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[s,d.trim],[i,d.trim],[a,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[i,/^/,"SmartTV"],[s,"Samsung"],[a,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[i,[s,"Sharp"],[a,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[s,"Samsung"],i,[a,l]],[/smart-tv.+(samsung)/i],[s,[a,"smarttv"],i],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[s,"Samsung"],i,[a,u]],[/sie-(\w+)*/i],[i,[s,"Siemens"],[a,u]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[s,"Nokia"],i,[a,u]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[i,[s,"Acer"],[a,l]],[/android.+([vl]k\-?\d{3})\s+build/i],[i,[s,"LG"],[a,l]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[s,"LG"],i,[a,l]],[/(lg) netcast\.tv/i],[s,i,[a,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i,/android.+lg(\-?[\d\w]+)\s+build/i],[i,[s,"LG"],[a,u]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[i,[s,"Lenovo"],[a,l]],[/linux;.+((jolla));/i],[s,i,[a,u]],[/((pebble))app\/[\d\.]+\s/i],[s,i,[a,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[s,i,[a,u]],[/crkey/i],[[i,"Chromecast"],[s,"Google"]],[/android.+;\s(glass)\s\d/i],[i,[s,"Google"],[a,"wearable"]],[/android.+;\s(pixel c)\s/i],[i,[s,"Google"],[a,l]],[/android.+;\s(pixel xl|pixel)\s/i],[i,[s,"Google"],[a,u]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[i,/_/g," "],[s,"Xiaomi"],[a,u]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[i,[s,"Meizu"],[a,l]],[/android.+a000(1)\s+build/i],[i,[s,"OnePlus"],[a,u]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[i,[s,"RCA"],[a,l]],[/android.+[;\/]\s*(Venue[\d\s]*)\s+build/i],[i,[s,"Dell"],[a,l]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[i,[s,"Verizon"],[a,l]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[s,"Barnes & Noble"],i,[a,l]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[i,[s,"NuVision"],[a,l]],[/android.+[;\/]\s*(zte)?.+(k\d{2})\s+build/i],[[s,"ZTE"],i,[a,l]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[i,[s,"Swiss"],[a,u]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[i,[s,"Swiss"],[a,l]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[i,[s,"Zeki"],[a,l]],[/(android).+[;\/]\s+([YR]\d{2}x?.*)\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(.+)\s+build/i],[[s,"Dragon Touch"],i,[a,l]],[/android.+[;\/]\s*(NS-?.+)\s+build/i],[i,[s,"Insignia"],[a,l]],[/android.+[;\/]\s*((NX|Next)-?.+)\s+build/i],[i,[s,"NextBook"],[a,l]],[/android.+[;\/]\s*(Xtreme\_?)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[s,"Voice"],i,[a,u]],[/android.+[;\/]\s*(LVTEL\-?)?(V1[12])\s+build/i],[[s,"LvTel"],i,[a,u]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[i,[s,"Envizen"],[a,l]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(.*\b)\s+build/i],[s,i,[a,l]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[i,[s,"MachSpeed"],[a,l]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[s,i,[a,l]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[i,[s,"Rotor"],[a,l]],[/android.+(KS(.+))\s+build/i],[i,[s,"Amazon"],[a,l]],[/android.+(Gigaset)[\s\-]+(Q.+)\s+build/i],[s,i,[a,l]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[a,d.lowerize],s,i],[/(android.+)[;\/].+build/i],[i,[s,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[c,[o,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[o,c],[/rv\:([\w\.]+).*(gecko)/i],[c,o]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[o,c],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[o,[c,f.str,h.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[o,"Windows"],[c,f.str,h.os.windows.version]],[/\((bb)(10);/i],[[o,"BlackBerry"],c],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[o,c],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[o,"Symbian"],c],[/\((series40);/i],[o],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[o,"Firefox OS"],c],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[o,c],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[o,"Chromium OS"],c],[/(sunos)\s?([\w\.]+\d)*/i],[[o,"Solaris"],c],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[o,c],[/(haiku)\s(\w+)/i],[o,c],[/cfnetwork\/.+darwin/i,/ip[honead]+(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[c,/_/g,"."],[o,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[o,"Mac OS"],[c,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[o,c]]},m=function(t,e){this[o]=t,this[c]=e},g=function(t){this.architecture=t},v=function(t,e,n){this[s]=t,this[i]=e,this[a]=n},_=m,b=m,y=function(e,n){if("object"==typeof e&&(n=e,e=void 0),!(this instanceof y))return new y(e,n).getResult();var r=e||(t&&t.navigator&&t.navigator.userAgent?t.navigator.userAgent:""),i=n?d.extend(p,n):p,o=new m,a=new g,s=new v,c=new _,u=new b;return this.getBrowser=function(){return f.rgx.call(o,r,i.browser),o.major=d.major(o.version),o},this.getCPU=function(){return f.rgx.call(a,r,i.cpu),a},this.getDevice=function(){return f.rgx.call(s,r,i.device),s},this.getEngine=function(){return f.rgx.call(c,r,i.engine),c},this.getOS=function(){return f.rgx.call(u,r,i.os),u},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(t){return r=t,o=new m,a=new g,s=new v,c=new _,u=new b,this},this};y.VERSION="0.7.14",y.BROWSER={NAME:o,MAJOR:"major",VERSION:c},y.CPU={ARCHITECTURE:"architecture"},y.DEVICE={MODEL:i,VENDOR:s,TYPE:a,CONSOLE:"console",MOBILE:u,SMARTTV:"smarttv",TABLET:l,WEARABLE:"wearable",EMBEDDED:"embedded"},y.ENGINE={NAME:o,VERSION:c},y.OS={NAME:o,VERSION:c},void 0!==n?(void 0!==e&&e.exports&&(n=e.exports=y),n.UAParser=y):"function"==typeof define&&define.amd?define(function(){return y}):t&&(t.UAParser=y);var w=t&&(t.jQuery||t.Zepto);if(void 0!==w){var S=new y;w.ua=S.getResult(),w.ua.get=function(){return S.getUA()},w.ua.set=function(t){S.setUA(t);var e=S.getResult();for(var n in e)w.ua[n]=e[n]}}}("object"==typeof window?window:this)},{}],39:[function(t,e,n){!function(t){var e={max:0,changeHandler:function(){},className:"",maxReachedClassName:"",maxReachedText:""};t.fn.charcount=function(n){var r,i,o,a,s=this,c=+(n=t.extend({},e,n)).max,u=function(t){var e=t?s.val():"",u=r!==e,l=e.length===c;if(u&&(r=e,i.text(c-e.length).removeClass(n.maxReachedClassName),o.hide(),!a)){var d=s.width();d>0&&(s.width(d-i.outerWidth()-5),a=!0)}u&&l?(i.addClass(n.maxReachedClassName),o.enable()):l&&(o.show(),o.disable())};return c>0&&(s.attr("maxlength",c),i=t('<div class="'+n.className+'" title="'+n.maxReachedText+'"/>').appendTo(s.parent()),o=i.tipsy({trigger:"manual",gravity:"se",offset:4,opacity:.95}).tipsy(!0),u(),s.bind("keydown change paste input propertychange",u)),s}}(iAdvize.$)},{}],40:[function(t,e,n){!function(t){function e(){}function n(t){a=[t]}function r(t,e,n){return t&&t.apply&&t.apply(e.context||e,n)}function i(t){return/\?/.test(t)?"&":"?"}function o(o){function h(t){X++||(Y(),$&&(x[G]={s:[t]}),B&&(t=B.apply(o,[t])),r(P,o,[t,w,o]),r(U,o,[o,w]))}function N(t){X++||(Y(),$&&t!=S&&(x[G]=t),r(L,o,[o,t]),r(U,o,[o,t]))}var k,j,M,D,z,P=(o=t.extend({},A,o)).success,L=o.error,U=o.complete,B=o.dataFilter,H=o.callbackParameter,F=o.callback,q=o.cache,$=o.pageCache,V=o.charset,G=o.url,J=o.data,W=o.timeout,X=0,Y=e;return T&&T(function(t){t.done(P).fail(L),P=t.resolve,L=t.reject}).promise(o),o.abort=function(){!X++&&Y()},!1===r(o.beforeSend,o,[o])||X?o:(G=G||u,J=J?"string"==typeof J?J:t.param(J,o.traditional):u,G+=J?i(G)+J:u,H&&(G+=i(G)+encodeURIComponent(H)+"=?"),!q&&!$&&(G+=i(G)+"_"+(new Date).getTime()+"="),G=G.replace(/=\?(&|$)/,"="+F+"$1"),$&&(k=x[G])?k.s?h(k.s[0]):N(k):(O[F]=n,M=t(y)[0],M.id=f+E++,V&&(M[c]=V),I&&I.version()<11.6?(D=t(y)[0]).text="document.getElementById('"+M.id+"')."+m+"()":M[s]=s,R&&(M.htmlFor=M.id,M.event=p),M[g]=M[m]=M[v]=function(t){if(!M[_]||!/i/.test(M[_])){try{M[p]&&M[p]()}catch(t){}t=a,a=0,t?h(t[0]):N(l)}},M.src=G,Y=function(t){z&&clearTimeout(z),M[v]=M[g]=M[m]=null,C[b](M),D&&C[b](D)},C[d](M,j=C.firstChild),D&&C[d](D,j),z=W>0&&setTimeout(function(){N(S)},W)),o)}var a,s="async",c="charset",u="",l="error",d="insertBefore",f="_jqjsp",h="on",p="onclick",m=h+l,g="onload",v="onreadystatechange",_="readyState",b="removeChild",y="<script>",w="success",S="timeout",O=window,T=t.Deferred,C=t("head")[0]||document.documentElement,x={},E=0,A={callback:f,url:location.href},I=O.opera,R=!!t("<div>").html("\x3c!--[if IE]><i><![endif]--\x3e").find("i").length;o.setup=function(e){t.extend(A,e)},t.jsonp=o}(iAdvize.$)},{}],41:[function(t,e,n){!function(t){function e(t,e){return"function"==typeof t?t.call(e):t}function n(e,n){this.$element=t(e),this.options=n,this.enabled=!0,this.fixTitle()}n.prototype={show:function(){var n=this.getTitle();if(n&&this.enabled){var r=this.tip();r.find(".tipsy-inner")[this.options.html?"html":"text"](n),r[0].className="tipsy",r.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(this.$element.offsetParent());var i,o=t.extend({},this.$element.position(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),a=r[0].offsetWidth,s=r[0].offsetHeight,c=e(this.options.gravity,this.$element[0]);switch(c.charAt(0)){case"n":i={top:o.top+o.height+this.options.offset,left:o.left+o.width/2-a/2};break;case"s":i={top:o.top-s-this.options.offset,left:o.left+o.width/2-a/2};break;case"e":i={top:o.top+o.height/2-s/2,left:o.left-a-this.options.offset};break;case"w":i={top:o.top+o.height/2-s/2,left:o.left+o.width+this.options.offset}}2==c.length&&("w"==c.charAt(1)?i.left=o.left+o.width/2-15:i.left=o.left+o.width/2-a+15),r.css(i).addClass("tipsy-"+c),r.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+c.charAt(0),this.options.className&&r.addClass(e(this.options.className,this.$element[0])),this.options.fade?r.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):r.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){t(this).remove()}):this.tip().remove()},fixTitle:function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("original-title"))&&t.attr("original-title",t.attr("title")||"").removeAttr("title")},getTitle:function(){var t,e=this.$element,n=this.options;return this.fixTitle(),"string"==typeof n.title?t=e.attr("title"==n.title?"original-title":n.title):"function"==typeof n.title&&(t=n.title.call(e[0])),(t=(""+t).replace(/(^\s*|\s*$)/,""))||n.fallback},tip:function(){return this.$tip||(this.$tip=t('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>')),this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},t.fn.tipsy=function(e){function r(r){var i=t.data(r,"tipsy");return i||(i=new n(r,t.fn.tipsy.elementOptions(r,e)),t.data(r,"tipsy",i)),i}if(!0===e)return this.data("tipsy");if("string"==typeof e){var i=this.data("tipsy");return i&&i[e](),this}if((e=t.extend({},t.fn.tipsy.defaults,e)).live||this.each(function(){r(this)}),"manual"!=e.trigger){var o=e.live?"live":"bind",a="hover"==e.trigger?"mouseenter":"focus",s="hover"==e.trigger?"mouseleave":"blur";this[o](a,function(){var t=r(this);t.hoverState="in",0==e.delayIn?t.show():(t.fixTitle(),setTimeout(function(){"in"==t.hoverState&&t.show()},e.delayIn))})[o](s,function(){var t=r(this);t.hoverState="out",0==e.delayOut?t.hide():setTimeout(function(){"out"==t.hoverState&&t.hide()},e.delayOut)})}return this},t.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,opacity:.8,title:"title",trigger:"hover"},t.fn.tipsy.elementOptions=function(e,n){return t.metadata?t.extend({},n,t(e).metadata()):n},t.fn.tipsy.autoNS=function(){return t(this).offset().top>t(document).scrollTop()+t(window).height()/2?"s":"n"},t.fn.tipsy.autoWE=function(){return t(this).offset().left>t(document).scrollLeft()+t(window).width()/2?"e":"w"},t.fn.tipsy.autoBounds=function(e,n){return function(){var r={ns:n[0],ew:n.length>1&&n[1]},i=t(document).scrollTop()+e,o=t(document).scrollLeft()+e,a=t(this);return a.offset().top<i&&(r.ns="n"),a.offset().left<o&&(r.ew="w"),t(window).width()+t(document).scrollLeft()-a.offset().left<e&&(r.ew="e"),t(window).height()+t(document).scrollTop()-a.offset().top<e&&(r.ns="s"),r.ns+(r.ew?r.ew:"")}}}(iAdvize.$)},{}],42:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=r(t("./modules/messenger-tag")),o=r(t("./modules/conversation")),a=iAdvize.$,s="undefined"!=typeof idzCustomData?idzCustomData:{},c=a('<div id="idz-root"></div>').appendTo("body").get(0),u=(0,i.default)(a,iAdvize,s),l=(0,o.default)(c,a,iAdvize,iAdvize.flags,iAdvize.JSONStore,u);t("./modules/targeting/src")(a,iAdvize,l,u)},{"./modules/conversation":45,"./modules/messenger-tag":89,"./modules/targeting/src":101}],43:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t){return{hasContactOngoing:function(){return t.chat&&(2==t.chat.status||3==t.chat.status&&t.chat.history_id>0)}}}},{}],44:[function(e,n,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default=function(e,n,r,i){var o=null,a=!!r.get("isMessengerChatboxOpen"),s={create:function(t){var e=!1;this.observer=new MutationObserver(function(t){t.forEach(function(t){e?"IFRAME"===t.target.tagName&&"style"===t.attributeName&&(a="inline"===t.target.style.display&&"360pt"===t.target.style.height,r.set("isMessengerChatboxOpen",a)):"fb-xfbml-state"===t.attributeName&&"rendered"===t.target.getAttribute("fb-xfbml-state")&&(e=!0)})}),this.observer.observe(t,{subtree:!0,attributes:!0})},destroy:function(){this.observer.disconnect()}},c={chatbox:{render:function(a){var c=arguments.length>1&&arguments[1]!==t?arguments[1]:"";if(o)throw new Error("A messenger chatbox is already rendered");r.set("messengerChatboxPageId",a),o=n('<div class="fb-customerchat" page_id="'+a+'" ref="'+c+'"></div>').appendTo(e),s.create(o.get(0)),i.renderTagElement(o.get(0))},destroy:function(){n("#fb-root .fb_dialog").remove(),o.remove(),s.destroy(),o=null}},hasContactOngoing:function(){return a}};return a&&c.chatbox.render(r.get("messengerChatboxPageId")),c}},{}],45:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e,n,r,c,u){var l=(0,o.default)(c,r),d={legacy:(0,a.default)(n),messenger:(0,s.default)(t,e,l,u)};return{hasContactOngoing:function(){return(0,i.some)((0,i.values)(d),function(t){return t.hasContactOngoing()})},getEngine:function(t){return(0,i.omit)(d,"legacy")[t]}}};var i=t("lodash"),o=r(t("./stateStore")),a=r(t("./channels/legacy")),s=r(t("./channels/messenger"))},{"./channels/legacy":43,"./channels/messenger":44,"./stateStore":46,lodash:35}],46:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("lodash");n.default=function(t,e){var n=(0,r.clone)(e);return{get:function(t){return(0,r.get)(n,t)},set:function(e,i){n[e]=i,t.saveData((0,r.pick)(n,e))}}}},{lodash:35}],47:[function(t,e,n){var r=new(0,t("events").EventEmitter),i=t("./events.enum");iAdvize.define("eventManager",function(t,e){return r.events=i,r}),e.exports=r},{"./events.enum":48,events:20}],48:[function(t,e,n){e.exports={chatButtonDisplayed:"ChatButtonDisplayed",callButtonDisplayed:"CallButtonDisplayed",callMeetingConfirmed:"CallMeetingConfirmed",videoButtonDisplayed:"VideoButtonDisplayed",OnXmppConnectionConnected:"xmpp.connection.connected",OnConversationVisioRequested:"conversations.visio.requested",OnConversationVisioClosed:"conversations.visio.closed",OnConversationVisioRefused:"conversations.visio.refused",OnConversationVisioTimeout:"conversations.visio.timeout",OnConversationVisioClose:"conversations.visio.close",OnConversationVisioRoutingDone:"conversations.visio.routingDone",OnXmppOOBReceived:"xmpp.message.oob.received",OnXmppConnectionDisconnected:"xmpp.connection.disconnected",OnXmppReconnectionFailed:"xmpp.reconnection.failed",OnConversationChatFileSelected:"conversation.chat.file.selected",OnConversationChatUploadAborted:"conversation.chat.upload.aborted"}},{}],49:[function(t,e,n){"use strict";var r=iAdvize.require("eventManager");r.on("targeting.rule.presence.updated",function(t){iAdvize.callbacks.onTargetingRuleTriggered(t)}),r.on("call.popin.open",function(){iAdvize.callbacks.onVisitorCallboxDisplayed()})},{}],50:[function(t,e,n){!function(t){function e(){}var n=t.callbacks={onScriptLoaded:e,onInvitationDisplayed:e,onChatDisplayed:e,onChatHidden:e,onChatButtonDisplayed:e,onCallButtonDisplayed:e,onVideoButtonDisplayed:e,onChatStarted:e,onChatEnded:e,onCallStarted:e,onCallEnded:e,onStatusChanged:e,onCallStatusChanged:e,onRuleStarted:e,onCookieSaved:e,onMessageReceived:e,onMessageSent:e,onAlertReceived:e,onOperatorWriting:e,onOperatorStopWriting:e,onVisitorWriting:e,onVisitorStopWriting:e,onOfferReceived:e,onLinkReceived:e,onCobrowsingRequested:e,onCobrowsingAccepted:e,onCobrowsingRefused:e,onCobrowsingStopped:e,onSatisfactionDisplayed:e,onSatisfactionAnswered:e,onVisitorTransferred:e,onVisitorCallboxDisplayed:e,onTargetingRuleTriggered:e},r={onInvitation:"onInvitationDisplayed",onC2cStatusChanged:"onCallStatusChanged",onOperatorMsg:"onMessageReceived",onVisitorMsg:"onMessageSent"};if("undefined"!=typeof iAdvizeCallbacks){var i=iAdvizeCallbacks;for(var o in i)"function"==typeof i[o]&&(n[o in r?r[o]:o]=function(t){return function(){try{i[t].apply(this,arguments)}catch(t){}}}(o))}}(iAdvize)},{}],51:[function(t,e,n){function r(t,e){return["sid="+e.website_id,"u="+e.vuid,"data="+encodeURIComponent(JSON.stringify(t)),"callback=?"].join("&")}function i(){}var o=t("lodash");e.exports=function(t,e){var n={},a={};n.onSave=function(t){this.saveData(t)},n.save=function(n){var o=n;o||(o=a,a={}),t.getJSON(e.chaturl+"rpc/jsonstore.php?"+r(o,e),i)};var s=o.debounce(n.save,1600);return n.saveData=function(t){o.each(t,function(t,e){a[e]=t}),s()},n}},{lodash:35}],52:[function(t,e,n){!function(t){var e=null,n=t.chaturl+"popout.php?idzchat&sid="+t.website_id;t.PopOut={popChatOut:function(r){var i="resizable=no, location=no, status=no, menubar=no";(r=r||{}).template&&(n+="&tpl="+r.template),r.width?i+=", width="+r.width:i+=", width=565",r.height?i+=", height="+r.height:i+=", height=325",r.top&&(i+=", top="+r.top),r.left&&(i+=", left="+r.left),t.Templates.hideUI(),e=window.open(n,"idzchat",i),window.focus&&e&&e.focus()}}}(iAdvize)},{}],53:[function(e,n,r){iAdvize.Store=function(){function e(t){return JSON.stringify(t)}function n(e){var n;if("string"!=typeof e)return t;try{n=JSON.parse(e)}catch(t){}return n}var r={},i={};return r.set=function(){},r.get=function(){},r.remove=function(){},r.clear=function(){},window.sessionStorage?(r.set=function(t,n){try{window.sessionStorage.setItem(t,e(n))}catch(t){}},r.get=function(t){return n(window.sessionStorage.getItem(t))},r.remove=function(t){window.sessionStorage.removeItem(t)},r.clear=function(){window.sessionStorage.clear()}):(r.get=function(t){return i[t]},r.set=function(t,e){return i[t]=e},r.remove=function(t){delete i[t]},r.clear=function(){for(var t in i)delete i[t]}),r.addToItem=function(t,e){var n=r.get(t);n=n?n+e:e,r.set(t,n)},r.incrementItem=function(t){this.addToItem(t,1)},r.decrementItem=function(t){this.addToItem(t,-1)},r}()},{}],54:[function(t,e,n){e.exports=function(t,e){e.util={detectDoctype:function(){var t=/\s+(X?HTML)\s+([\d\.]+)\s*([^\/]+)*\//gi,e=0;if(void 0!==document.namespaces){if(8!=document.all[0].nodeType)return null;t.exec(document.all[0].nodeValue),-1!=document.all[0].nodeValue.indexOf("loose")&&(e=1)}else{if(null==document.doctype)return null;t.exec(document.doctype.publicId),document.doctype.systemId&&-1!=document.doctype.systemId.indexOf("loose")&&(e=1)}return{xhtml:RegExp.$1,version:RegExp.$2,importance:RegExp.$3,loose:e}},get_body:function(){var t=document.getElementsByTagName("html")||"",e=null;t.length<1?(e=document.createElement("html"),document.appendChild(e)):e=t[0];var n=null;return(t=document.getElementsByTagName("body")||"").length>0?n=document.getElementsByTagName("body").item(0):(n=document.createElement("body"),e.appendChild(n)),n},get_head:function(){var t=document.getElementsByTagName("html"),e=null;t.length<1?(e=document.createElement("html"),document.appendChild(e)):e=t[0];var n=null;return(t=document.getElementsByTagName("head")).length>0?n=document.getElementsByTagName("head").item(0):(n=document.createElement("head"),e.appendChild(n)),n},load_js:function(t,e){var n=this.get_head(),r=document.createElement("script");r.async=!0,r.setAttribute("language","javascript"),r.setAttribute("type","text/javascript"),r.setAttribute("src",t),n.insertBefore(r,n.firstChild);r.onload=r.onreadystatechange=function(){this.readyState&&"complete"!==this.readyState&&"loaded"!==this.readyState||e()}},load_css:function(t){var e=this.get_head(),n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",t),e.appendChild(n)},addScript:function(t,e){var n=new Date,r=document.getElementById(t);null!==r&&r.parentNode.removeChild(r);var i=this.get_head(),o=document.createElement("script");o.id=t,o.type="text/javascript",o.async=!0,o.src=e+"&random="+n.getTime(),i.insertBefore(o,i.firstChild);o.onload=o.onreadystatechange=function(){!this.readyState||"complete"===this.readyState||this.readyState}},delScript:function(t){var e=document.getElementById(t);null!==e&&e.parentNode.removeChild(e)},addEvent:function(t,e,n,r){return t.addEventListener?(t.addEventListener(e,n,r),!0):t.attachEvent?t.attachEvent("on"+e,n):void 0},removeEvent:function(t,e,n,r){return t.removeEventListener?(t.removeEventListener(e,n,r),!0):t.detachEvent?t.detachEvent("on"+e,n):void 0},setCookie:function(t,e){var n=new Date;n.setTime(n.getTime()+6e4),document.cookie=t+"="+e+"; expires="+n.toGMTString()},getCookie:function(t){var e=document.cookie.indexOf(t+"="),n=e+t.length+1;if(!e&&t!=document.cookie.substring(0,t.length))return null;if(-1==e)return null;var r=document.cookie.indexOf(";",n);return-1==r&&(r=document.cookie.length),unescape(document.cookie.substring(n,r))},delCookie:function(t){var e=new Date;e.setTime(e.getTime()-6e4),document.cookie=t+"= ; expires="+e.toGMTString()},nl2br:function(t){return(t+"").replace(/([^>]?)(\r\n|\n\r|\n|\r)/g,"$1<br/>")},htmlspecialchars:function(t){return"string"==typeof t&&(t=(t=(t=(t=(t=(t=t.replace(/&/g,"&amp;")).replace(/"/g,"&quot;")).replace(/'/g,"&#039;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/\\/g,"&#92;")),t},htmlSimpleEscape:function(t){return"string"==typeof t&&(t=(t=t.replace(/</g,"&lt;")).replace(/>/g,"&gt;")),t},long2ip:function(t){var e=!1;return!isNaN(t)&&(t>=0||t<=4294967295)&&(e=Math.floor(t/Math.pow(256,3))+"."+Math.floor(t%Math.pow(256,3)/Math.pow(256,2))+"."+Math.floor(t%Math.pow(256,3)%Math.pow(256,2)/Math.pow(256,1))+"."+Math.floor(t%Math.pow(256,3)%Math.pow(256,2)%Math.pow(256,1)/Math.pow(256,0))),e},sec2minsec:function(t){var e=Math.floor(t/60),n=t%60;return e<10&&(e="0"+e),n<10&&(n="0"+n),e+":"+n},getDebounce:function(t,e){var n=null,r=[],i=function(){e(r),r=[],n=null};return function(){n&&(clearTimeout(n),n=null),r.push(arguments),n=setTimeout(i,t)}},proxy:function(t,e){return outfunc=function(){return t.apply(e||this,arguments)},outfunc},runOnce:function(t,e){var n=null,r=!1;return function(){!1===r&&(r=!0,e(arguments)),n||(n=setTimeout(function(){r=!1,n=null},t))}},retry:function(t,n,r,i,o){var a=o||e.$.Deferred();return--t,n.apply(r,i).done(function(t){a.resolve(t)}).fail(function(){t?e.util.retry(t,n,r,i,a):a.reject()}),a.promise()},string:{padLeft:function(t,e,n){for(var r=t;r.length<n;)r=e+r;return r}},date:{getMonthName:function(t){if(!t)return"";switch(t.getMonth()){case 0:return e.T("january");case 1:return e.T("february");case 2:return e.T("march");case 3:return e.T("april");case 4:return e.T("may");case 5:return e.T("june");case 6:return e.T("july");case 7:return e.T("august");case 8:return e.T("september");case 9:return e.T("october");case 10:return e.T("november");case 11:return e.T("december");default:return""}},getDayName:function(t){if(!t)return"";switch(t.getDay()){case 0:return e.T("sunday");case 1:return e.T("monday");case 2:return e.T("tuesday");case 3:return e.T("wednesday");case 4:return e.T("thursday");case 5:return e.T("friday");case 6:return e.T("saturday");default:return""}},formatDate:function(t,n){var r=this.getMonthName(t),i=this.getDayName(t);return n.replace(/yyyy/g,t.getFullYear()).replace(/yy/g,String(t.getFullYear()).substr(2,2)).replace(/MMM/g,r.substr(0,3).toUpperCase()).replace(/Mmm/g,r.substr(0,3)).replace(/MM\*/g,r.toUpperCase()).replace(/Mm\*/g,r).replace(/mm/g,e.util.string.padLeft(String(t.getMonth()+1),"0",2)).replace(/DDD/g,i.substr(0,3).toUpperCase()).replace(/Ddd/g,i.substr(0,3)).replace(/DD\*/g,i.toUpperCase()).replace(/Dd\*/g,i).replace(/dd/g,e.util.string.padLeft(String(t.getDate()),"0",2)).replace(/d\*/g,t.getDate()).replace(/hh/g,e.util.string.padLeft(String(t.getHours()),"0",2)).replace(/ii/g,e.util.string.padLeft(String(t.getMinutes()),"0",2))},getDateISOString:function(t){if(t.toISOString)return t.toISOString();var n=e.util.string.padLeft(String(t.getUTCMonth()+1),"0",2),r=e.util.string.padLeft(String(t.getUTCDate()),"0",2),i=e.util.string.padLeft(String(t.getUTCHours()),"0",2),o=e.util.string.padLeft(String(t.getUTCMinutes()),"0",2),a=e.util.string.padLeft(String(t.getUTCSeconds()),"0",2),s=e.util.string.padLeft(String(t.getUTCMilliseconds()),"0",3),c=t.getUTCFullYear()+"-"+n+"-"+r+"T";return c+=i+":"+o+":"+a+"."+s+"Z"}},object:{mapKey:function(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[e(r)]=t[r]);return n}},JSONStringify:function(e){for(var n="",r=["Array","Object","String"],i={},o=0;o<r.length;o++)t[r[o]].prototype.toJSON&&(i[r[o]]=t[r[o]].prototype.toJSON,delete t[r[o]].prototype.toJSON);try{n=JSON.stringify(e)}catch(t){}finally{for(var a in i)i.hasOwnProperty(a)&&(t[a].prototype.toJSON=i[a])}return n}}}},{}],55:[function(t,e,n){"use strict";e.exports=function(t,e){var n=iAdvize,r=!1,i=function(){return!!(window.File&&window.FileList&&window.FileReader)&&void 0!==window.FormData};t.on(e.OnConversationChatFileSelected,function(n){for(var r=n.target.files,i=0;i<r.length;i++){var o=r[i];o.size>3e7?t.emit(e.OnConversationChatUploadMaxSizeReached,3e7,o):/image\//.test(o.type)||/application\/pdf/.test(o.type)?t.emit(e.OnConversationChatUploadFilesChecked,o):t.emit(e.OnConversationChatUploadBadMimeType,o)}}),t.on(e.OnXmppConnectionConnected,function(){i()&&n.Templates.upload&&!r&&(n.Templates.upload.initialize(),r=!0,t.emit(e.OnConversationChatUploadInitialized))})}},{}],56:[function(t,e,n){"use strict";e.exports=function(t,e,n){var r=function(e){var n=t.$("#idz_msgmsg").get(0),r=n.selectionStart,i=[n.value.substr(0,n.selectionStart),e,n.value.substr(n.selectionStart,n.value.length-1)].join("");t.$(n).val(i).focus().trigger("change"),n.setSelectionRange(r+e.length,r+e.length)};e.on(n.OnConversationChatEmojiSelected,function(t,e){r(":"+t.shortname+":")})}},{}],57:[function(t,e,n){"use strict";var r=t("lodash");e.exports=function(t,e,n,i){var o=t.$,a=null,s=0,c=!1;1===t.preferences.mirroring_enabled&&(a=t.require("mirror"));var u=function(e){return t.operator.barejid===e&&2===t.chat.status},l=function(e,n){t.operator.nick+"@"+t.bosh_host===n&&(t.operator.is_online=e,t.operator.barejid=n,0===e&&a&&a.disable&&a.disable())};e.on(n.OnXmppRosterUserAvailable,function(e){if(u(e))return s>0?(clearTimeout(s),void(s=0)):void(c&&(t.chat.put_dialog(t.Templates.opAlert.replace(/\{MSG\}/g,t.T("OPERATEUR_RECONNECTION")).replace(/\{TIME\}/g,t.chat.getMsgTime())),c=!1))}),e.on(n.OnXmppRosterUserUnavailable,function(e){u(e)&&(s=r.delay(function(e){s=0,i.isOnline(e)||(t.chat.put_dialog(t.Templates.opAlert.replace(/\{MSG\}/g,t.T("OPERATEUR_DECONNECTION")).replace(/\{TIME\}/g,t.chat.getMsgTime())),o(".idz_writting").html(" "),c=!0)},1e4,e))}),e.on(n.OnXmppRosterUserUnavailable,r.partial(l,0)),e.on(n.OnXmppRosterUserAvailable,r.partial(l,1))}},{lodash:35}],58:[function(t,e,n){"use strict";e.exports={OnUploadMessage:"conversations.message.upload.received",OnProductMessage:"conversations.message.product.received",OnMessageWithMultipleChoicesMessage:"conversations.message.multiple-choices.received",OnTextMessage:"conversations.message.text.received",OnConversationChatFileSelected:"conversation.chat.file.selected",OnConversationChatUploadFilesChecked:"conversation.chat.files.checked",OnConversationChatUploadMaxSizeReached:"conversation.chat.file.maxSizeReached",OnConversationChatUploadBadMimeType:"conversation.chat.file.badMimeType",OnConversationChatUploadStarted:"conversation.chat.upload.started",OnConversationChatUploadProgress:"conversation.chat.upload.progress",OnConversationChatUploadCompleted:"conversation.chat.upload.completed",OnConversationChatUploadFailed:"conversation.chat.upload.failed",OnConversationChatUploadAborted:"conversation.chat.upload.aborted",OnConversationChatUploadInitialized:"conversation.chat.upload.initialized",OnConversationChatEmojiSelected:"conversation.chat.emoji.selected",OnConversationEmojisLoaded:"conversation.emojis.loaded"}},{}],59:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){t("./richContentHandler")(n,r),t("./FileUploadHandler")(n,r),t("./InputsHandler")(e,n,r),t("./OperatorPresenceHandler")(e,n,r,i)}},{"./FileUploadHandler":55,"./InputsHandler":56,"./OperatorPresenceHandler":57,"./richContentHandler":62}],60:[function(t,e,n){"use strict";var r=function(t,e){this.url=t||"",this.name=e.name||"unknown",this.mimeType=e.type||"unknown"};r.prototype.getUrl=function(){return this.url},r.prototype.getName=function(){return this.name},r.prototype.getMimeType=function(){return this.mimeType},e.exports=r},{}],61:[function(t,e,n){"use strict";var r=function(t,e){this.url=e.productUrl||"",this.title=e.title||"",this.imageUrl=e.imageUrl||"",this.priceCatalog=e.priceCatalog||"",this.pricePromotion=e.pricePromotion||"",this.isAvailable=!!e.available};r.prototype.getUrl=function(){return this.url},r.prototype.getTitle=function(){return this.title},r.prototype.getPrice=function(){return""!==this.pricePromotion?this.pricePromotion:this.priceCatalog},r.prototype.getImage=function(){return this.imageUrl},r.prototype.getPriceOriginal=function(){return""!==this.pricePromotion?this.priceCatalog:""},r.prototype.getIsAvailable=function(){return this.isAvailable},e.exports=r},{}],62:[function(t,e,n){"use strict";var r=t("./models/file"),i=t("./models/product");e.exports=function(t,e){t.on(e.OnXmppOOBReceived,function(n,o,a,s,c,u,l){switch(s){case"upload":var d=new r(c,u);t.emit(e.OnUploadMessage,n,o,a,d,l);break;case"product":var f=new i(c,u);t.emit(e.OnProductMessage,n,o,a,f,l);break;case"message-with-multiple-choices":t.emit(e.OnMessageWithMultipleChoicesMessage,n,o,a,u,l)}})}},{"./models/file":60,"./models/product":61}],63:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("@iadvize/front-emojis-service")({baseUrl:e.static_url+"images/emojis",blackList:["reversed-hand-with-middle-finger-extended","registered-sign","copyright-sign","trade-mark-sign"]});return e.$.get(i.getJSONUrl("apple"),function(t){i.setEmojis("apple",t),n.emit(r.OnConversationEmojisLoaded)}),e.define("emojis-service",function(){return i}),i}},{"@iadvize/front-emojis-service":6}],64:[function(t,e,n){"use strict";var r=t("lodash").assign;e.exports=r(t("./xmpp/events"),t("./conversations/events"))},{"./conversations/events":58,"./xmpp/events":80,lodash:35}],65:[function(t,e,n){"use strict";function r(t,e){this.stack=(new Error).stack,this.message=t||"An error as occured",this.name="UploadError",this.statusCode=e}function i(t){this.stack=(new Error).stack,this.message=t||"Upload aborted",this.name="AbortUploadError"}function o(t,e){this.stack=(new Error).stack,this.message=t||"An error as occured",this.name="HttpError",this.statusCode=e}function a(t){this.stack=(new Error).stack,this.message=t||"Request aborted",this.name="AbortedRequestError"}(r.prototype=Object.create(Error.prototype)).constructor=r,(i.prototype=Object.create(Error.prototype)).constructor=i,(o.prototype=Object.create(Error.prototype)).constructor=o,(a.prototype=Object.create(Error.prototype)).constructor=a,e.exports={HttpError:o,AbortedRequestError:a,UploadError:r,AbortUploadError:i}},{}],66:[function(t,e,n){"use strict";var r=t("lodash");e.exports=function(e){var n={},i=t("./errors"),o=function(t,n,o,a){function s(t,e){return t.abort=e,t.then=r.wrap(t.then.bind(t),function(t,n,r){return s(t(n,r),e)}),t}var c=e.Deferred(),u=!1,l=r.noop;return a=a||{},o=r.assign({dataType:"json",contentType:"application/json",data:a,type:n,url:t,beforeSend:function(t,e){return l=t.abort,!u}},o),e.ajax(o).then(function(t){c.resolve(t)},function(t){var e=new i.HttpError(""+t.statusText,t.status||0);0===t.status&&"abort"===t.statusText&&(e=new i.AbortedRequestError("Aborted")),c.reject(e)}),s(c.promise(),function(){u=!0,l()})};return r.forEach(["get","post","put","delete"],function(t){n[t]=function(e,n,r){return o(e,t.toUpperCase(),n,r)}}),n}},{"./errors":65,lodash:35}],67:[function(t,e,n){"use strict";e.exports=function(e){var n=e.$,r=t("./httpService")(n);return{httpService:r,uploadService:t("./uploadService")(n,r)}}},{"./httpService":66,"./uploadService":68}],68:[function(t,e,n){"use strict";var r=t("lodash").assign;e.exports=function(e,n){var i={},o=t("./errors"),a=function(t){throw"AbortedRequestError"===t.name?new o.AbortUploadError(t.message):new o.UploadError(t.message,t.statusCode)};return i.upload=function(t,i,o,s){s=s||{};var c=r({data:t,processData:!1,contentType:t.type,cache:!1,dataType:"xml",xhr:function(){var t=e.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",function(t){if(o){var e=parseInt(t.loaded/t.total*100,10);o(e)}},!1),t}},s);return n.put(i,c).fail(a)},i}},{"./errors":65,lodash:35}],69:[function(t,e,n){"use strict";!function(e){var n=e.require("eventManager"),r=t("./events"),i=t("./http")(e),o=t("./logmatic")(e);e.JSONStore=t("./JSONStore")(e.$,e);var a=t("./xmpp")(n,r,o,e,i.uploadService),s=t("./emojis")(e,n,r);t("./conversations")(e,n,r,a.roster),t("./templates")(n,r,e,s),t("./Util")(window,e)}(iAdvize)},{"./JSONStore":51,"./Util":54,"./conversations":59,"./emojis":63,"./events":64,"./http":67,"./logmatic":70,"./templates":73,"./xmpp":88}],70:[function(t,e,n){"use strict";var r=t("lodash");e.exports=function(t){function e(e,n,r,a){if(!t.PROD)return console.error(n,e,r,a);i.push({desc:e,err:JSON.stringify(n),msg:r,extras:JSON.stringify(a)}),o()}function n(e,n,r){if(!t.PROD)return console.log(e,n,r);i.push({desc:e,msg:n,extras:JSON.stringify(r)}),o()}var i=[],o=r.debounce(function(){t.$.ajax({type:"POST",contentType:"application/json; charset=UTF-8",url:t.chaturl+"rpc/mail_error.php",data:JSON.stringify(i),processData:!1,complete:function(){}}),i=[]},15e3,{leading:!1,trailing:!0});return t.define("logger",function(){return{error:e,info:n}}),{error:e,info:n}}},{lodash:35}],71:[function(t,e,n){var r=iAdvize,i=r.require("eventManager"),o={record:function(t,e){try{if("gtm"===r.preferences.plugins.GOOGLEANALYTICS_PLUGIN){var n=r.preferences.plugins.GOOGLEANALYTICS_GTM_NAME;window[n].push({category:"iAdvize",action:t,label:e,event:"iAdvize"})}"ga"===r.preferences.plugins.GOOGLEANALYTICS_PLUGIN&&_gaq.push(["_trackEvent","iAdvize",t,e]),"gau"===r.preferences.plugins.GOOGLEANALYTICS_PLUGIN&&ga("send","event","iAdvize",t,e)}catch(t){}},handleEvents:function(){i.on("conversation.call.started",function(){o.record("Call",r.c2coperator.pseudo)}),i.on("conversation.chat.started",function(){o.record("Chat",r.operator.pseudo)}),i.on("conversation.video.started",function(){o.record("Video",r.operator.pseudo)})}};o.handleEvents(),e.exports=o},{}],72:[function(t,e,n){var r={},i=iAdvize,o=i.$;n.setParam=function(t,e){r[t]=e},n.find=function(t,e){t=t||{};var a={findop:i.website_id,u:i.vuid,dep:i.forceDep,s:i.chat.status,o:i.forceAgent||0};o.extend(a,t,r);var s=e||o.Deferred();return document.visibilityState&&"hidden"===document.visibilityState?(setTimeout(function(){n.find(t,s)},1e3),s.promise()):(o.getJSON(i.chaturl+"rpc/"+iAdvize.pollingEndPoint+"?callback=?",a).done(i.findOpCallback).done(s.resolve).fail(function(){setTimeout(function(){n.find(t,s)},1e4)}),s.promise())};var a=0;n.oldPolling=function(){return n.find().done(function(){clearTimeout(a),a=setTimeout(function(){n.oldPolling()},3e4)})},i.AvailableOp=n},{}],73:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){return{renderingController:t("./renderingController.js")(e,n,r,i)}}},{"./renderingController.js":74}],74:[function(t,e,n){"use strict";var r=t("filesize");e.exports=function(t,e,n,i){var o=function(t){return t.length>29&&(t=t.substring(0,18-"...".length)+"..."+t.substring(t.length-11,t.length)),t},a=function(){if(n.Templates&&n.Templates.emojis){if(0!==n.$(".idzEmojisPopupToggler").length||0===Object.keys(i.getEmojis("apple",!1)).length)return;if(!n.$("#idz_msgmsg").length)return;var r=!1,o=i.getEmojis("apple",!0),a=i.getIcons(),s=n.$("#idz_chatglobal"),c=n.Templates.emojis.getEmojisPopupDOM(),u=c.find(".idzFloatingPopupArrow"),l=c.find(".idzEmojisList"),d=c.find(".idzEmojisCategories"),f=n.Templates.emojis.getTogglerDOM();for(var h in a){var p=o[h].fullName,m=o[h].emojis,g=n.Templates.emojis.getEmojisCategoryDOM(p,h),v=n.Templates.emojis.getCategoryTabDOM(h,a[h]);for(var _ in m){var b=n.Templates.emojis.getEmojiDOM(m[_].shortname);g.find(".idzEmojisCategoryEmojis").append(b),"noRecent"!==m[_].shortname&&b.on("click",function(r){var i=n.$(this).data("emoji");t.emit(e.OnConversationChatEmojiSelected,i,r),f.click()}).data("emoji",m[_])}v.on("click",function(t){var e=n.$(this).data("category");l.animate({scrollTop:n.$('.idzEmojisCategory[data-category="'+e+'"]').get(0).offsetTop},500),t.preventDefault()}),c.find(".idzEmojisList").append(g),d.append(v)}var y=d.find(".idzEmojiCategoryChar"),w=l.find(".idzEmojisCategory");y.first().addClass("selected"),l.on("scroll",function(t){var e=parseInt(l.css("padding-top"),10),r=l.get(0).scrollTop+e+1;n.$(".idzEmojiCategoryChar").removeClass("selected");for(var i=0;i<w.length;i++){var o=w[i],a={top:o.offsetTop,bottom:o.offsetTop+o.offsetHeight};r>a.top&&r<a.bottom&&n.$(y[i]).addClass("selected")}t.stopPropagation()});var S=n.$("#idz_chat_actions"),O=n.$("#idz_msgmsg");f.on("click",function(t){r=!r;var e=s.get(0).getBoundingClientRect(),i=n.$(this).get(0).getBoundingClientRect(),o=Math.abs(e.top-i.top),a=Math.abs(e.left-i.left),l=o-c.height()-10,d=e.width-c.width();c.css({bottom:"auto",right:"auto",left:d,top:l}).toggleClass("opened"),u.css({left:a-d+2}),f.toggleClass("active"),t.stopPropagation()}),s.append(c),S.prepend(f);var T=S.width();O.css({paddingRight:T,width:O.get(0).offsetWidth-T}),c.find(".idzEmojiChar").css("background-image","url("+i.getSpriteUrl("apple")+")"),n.$(document).on("click.emojis",function(t){var e=c.get(0);e&&e.contains(t.target)||!r||(t.stopPropagation(),t.preventDefault(),f.click())})}};t.on(e.OnUploadMessage,function(t,e,r,i,o){if(n.Templates.upload&&n.Templates.upload.getUploadedFileDOM){var a="",s=r||n.chat.getMsgTime();switch(e){case"operator":n.operator&&n.operator.pseudo&&(a=n.operator.pseudo);break;case"visitor":a=n.T("VOUS")}var c=n.Templates.upload.getUploadedFileDOM(a,e,s,i.getName(),i.getMimeType(),i.getUrl());c.attr("data-id",t),o?o.append(c):n.chat.putOpFile(t,c)}else n.chat.putOpMsg(t,i.getUrl(),0)}),t.on(e.OnTextMessage,function(t,e,r,i,o){switch(e){case"operator":n.chat.putOpMsg(t,i,0)}}),t.on(e.OnProductMessage,function(t,e,r,i,o){var a=r||n.chat.getMsgTime(),s="";switch(e){case"operator":n.operator&&n.operator.pseudo&&(s=n.operator.pseudo)}if(n.Templates.products&&n.Templates.products.getProductDOM){var c=n.Templates.products.getProductDOM(i.getImage(),i.getTitle(),i.getPrice(),i.getPriceOriginal(),i.getIsAvailable(),i.getUrl(),s,a,n.T("chatbox.products.link_label"));o?o.append(c):n.chat.putOpProduct(t,c)}else""!=i.getUrl()&&n.chat.putOpMsg(t,i.getUrl(),0)}),t.on(e.OnMessageWithMultipleChoicesMessage,function(t,e,r,i,o){var a=r||n.chat.getMsgTime(),s=n.operator.pseudo?n.operator.pseudo+" : ":"";if(n.Templates.messageWithMultipleChoices&&n.Templates.messageWithMultipleChoices.getDOM){var c=n.Templates.messageWithMultipleChoices.getDOM(i.message,i.choices,a,s,n.chat.getOperatorAvatarUrl());n.chat.putOpMessageWithMultipleChoices(t,c,o)}}),t.on(e.OnConversationChatUploadMaxSizeReached,function(t,e){var i=n.T("livechat.conversations.upload.fileTooBig").replace("%maxSize%",r(t)).replace("%fileName%",e.name),o=n.Templates.upload.getUploadErrorMessageDOM(i);n.chat.putOpFile("error",o)}),t.on(e.OnConversationChatUploadBadMimeType,function(t){var e=t.name+": "+n.T("livechat.conversations.upload.badType"),r=n.Templates.upload.getUploadErrorMessageDOM(e);n.chat.putOpFile("error",r)}),t.on(e.OnConversationChatUploadStarted,function(t,e){var r=n.Templates.upload.getUploadProgressDOM(o(t.name),e);n.chat.putOpFile(e,r)}),t.on(e.OnConversationChatUploadProgress,function(t,e){n.$('.idz_upload[data-id="'+e+'"]').find(".idz_progress").css("width",t+"%")}),t.on(e.OnConversationChatUploadCompleted,function(t){n.$('.idz_upload[data-id="'+t+'"]').remove()}),t.on(e.OnConversationChatUploadFailed,function(t,e){n.$('.idz_upload[data-id="'+t+'"]').addClass("idz_upload_error").html(e)}),t.on(e.OnConversationChatUploadInitialized,function(){if(n.Templates.hasUpload&&n.Templates.upload&&n.Templates.dragNDrop){var r=n.$("#idz_chatbox").find(".chatboxDropZoneContainer"),i=function(){n.$(window).focus(),r.removeClass("displayed"),r.find(".chatboxDropZone").removeClass("active")},o=n.Templates.dragNDrop.getDropZone();o.on("dragenter dragover",function(){var t=n.$(this).addClass("active").find("img");t.attr("src",t.data("src-on"))}).on("dragleave",function(){var t=n.$(this).removeClass("active").find("img");t.attr("src",t.data("src-off"))}),o.find("input").on("change",function(r){t.emit(e.OnConversationChatFileSelected,r),n.$(this).val(""),i()}),o.find(".chatFileUploader").on("click",function(t){n.$(t.target).find("input").click()});var a=o.find("img");a.attr("src",a.data("src-off")),n.$(window).on("dragenter",function(){n.$(window).focus(),r.addClass("displayed")}),n.$(window).on("mouseleave",i),r.append(o)}}),t.on(e.OnXmppConnectionConnected,a),t.on(e.OnConversationEmojisLoaded,a)}},{filesize:21}],75:[function(t,e,n){"use strict";e.exports=function(t){var e=[];return{get:function(){var n=t.Deferred();return e.push(n),n.promise()},reject:function(t){e.map(function(e){e.reject(t)}),e=[]},resolve:function(){var t=arguments;e.map(function(e){e.resolve.apply(e,t)}),e=[]}}}},{}],76:[function(t,e,n){e.exports=function(t){var e=t.split(" ");this.name=e.shift().substr(1),this.param1=e.shift()||"",this.param2=e.join(" ")}},{}],77:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=t("lodash");e.exports=function t(e){r(this,t),this.name="",this.barejid="",this.resources=[],i.assign(this,e)}},{lodash:35}],78:[function(t,e,n){function r(t){i.call(this,t);var e=this,n=o(t),r=n.find("error");this.text=r.length?r.find("text").text():[],this.fromUsername=(n.attr("from")||"").split("@")[0],this.code=parseInt(r.attr("code"),10),this.retry=0,o.each(n.find("x"),function(t,n){"https://iadvize.com/schemas/retry"===n.getAttribute("xmlns")&&(e.retry=parseInt(n.getAttribute("retry"),10))})}var i=t("./Message"),o=iAdvize.$;r.prototype=i.prototype,r.constructor=r,r.prototype.canRetry=function(){return this.retry<3},e.exports=r},{"./Message":79}],79:[function(t,e,n){function r(t){var e=o(t);this.raw=e,this.id=e.attr("id")||null,this.to=e.attr("to"),this.from=e.attr("from").toLowerCase(),this.barejid=Strophe.getBareJidFromJid(this.from),this.type=e.attr("type"),this.bodies=e.find("body"),this.body=this.bodies.length?Strophe.xmlunescape(Strophe.getText(this.bodies[0])):"",this.x=e.find("x")}var i=t("./Command"),o=iAdvize.$;r.prototype={isChat:function(){return("chat"===this.type||"groupchat"===this.type)&&this.bodies.length>0&&!this.isCommand()},isCommand:function(){return 0===this.body.indexOf("!")},getCommand:function(){return this.command||(this.command=new i(this.body))}},e.exports=r},{"./Command":76}],80:[function(t,e,n){"use strict";e.exports={OnXmppConnectionConnected:"xmpp.connection.connected",OnXmppConnectionDisconnected:"xmpp.connection.disconnected",OnXmppReconnectionFailed:"xmpp.reconnection.failed",OnXmppRoomInvitation:"xmpp.room.invited",OnXmppRoomJoined:"xmpp.room.joined",OnXmppOOBReceived:"xmpp.message.oob.received",OnXmppRosterUserAvailable:"xmpp.roster.user.available",OnXmppRosterUserUnavailable:"xmpp.roster.user.unavailable"}},{}],81:[function(t,e,n){"use strict";var r=t("@iadvize/strophe.js");window.Strophe=r.Strophe,window.$build=r.$build,window.$iq=r.$iq,window.$msg=r.$msg,window.$pres=r.$pres,t("@iadvize/strophe-muc"),t("@iadvize/strophe-receipts"),t("@iadvize/strophe-http-file-upload")(window.Strophe),t("@iadvize/strophe-outofband")(window.Strophe);var i=t("lodash");e.exports=function(t,e,n,r,o,a,s,c){var u=r.$,l=0,d=0,f=!1,h=!1,p=function(){return i.isObject(window.WebSocket)&&r.ws_enabled},m=function(){return p()&&!f?r.ws_url:r.bosh_url},g=new Strophe.Connection(m()),v=!1,_=null,b=null,y={},w={jid:null,nick:null},S=function(n){if(g.connected||v)return _.promise();_=_&&"pending"===_.state()?_:u.Deferred(),v=!0;var i={website_id:iAdvize.website_id,vuid:iAdvize.vuid};return r.popout&&(i.pop=1),u.ajax(r.chaturl+"api/connect?callback=?",{data:i,dataType:"json",timeout:5e3}).done(function(n){var r=n.nick,i=n.pass,o=n.vhost;if(""===r||""===i||""===o)return _.reject("Unable to retrieve valid credentials");g.connect(r+"@"+o+"/"+ +new Date,i,function(n){return n===Strophe.Status.ATTACHED||n===Strophe.Status.CONNECTED?(!p()||h||f||(h=!0),t.emit(e.OnXmppConnectionConnected)):n===Strophe.Status.DISCONNECTED&&t.emit(e.OnXmppConnectionDisconnected),!0})}).fail(function(){n?t.emit(e.OnXmppConnectionDisconnected):_.reject("Error while retrieving credentials")}),_.promise()},O=function(t){return function(e){var n=new s(e);return c.error("livechat.xmpp.stanza.error".replace("stanza",t),Strophe.serialize(e),n.text,{id:e.id,code:parseInt(n.code,10),rooms:g.muc.roomNames,conversationId:n.fromUsername}),!0}},T=function(t){var e=new s(t);return e.from!==r.conversationJid||406!==e.code&&404!==e.code||k(e),!0},C=function(t){var e=new s(t);return n.reject(e),e.from!==r.conversationJid||406!=e.code&&404!=e.code||!w.jid||A(w.jid,w.nick,0).catch(function(){}),!0},x=function(t){var e=new o(t);if(e.x.length>0&&"jabber:x:delay"===e.x[0].getAttribute("xmlns"))return!0;try{e.isChat()?r.chat.onMessage(e):e.isCommand()&&r.chat.onCommand(e)}catch(t){c.error("livechat.xmpp.handler.onMessage",t,e)}return!0},E=function(t){var e=u(t).attr("from").toLowerCase(),n=Strophe.getResourceFromJid(e),i=t.childNodes[0].localName;return r.chat.onChatStates(n,i),!0},A=function(r,i,o){var a=n.get(),s={seconds:o||0};w.jid=r,w.nick=i;return g.muc.join(r,i,null,null,null,null,s),g.muc.rooms[r].addHandler("presence",function(i){if(!i)return!0;var o=u(i).find("status"),a=u.map(o,function(t){return parseInt(u(t).attr("code"),10)});return!(-1!==u.inArray(110,a))||(t.emit(e.OnXmppRoomJoined),n.resolve(r),z(r),!1)}),a},I=function(t){D();var e=g.muc.roomNames.indexOf(t);delete g.muc[t],e>=0&&(g.muc.roomNames.splice(e,1),0===g.muc.roomNames.length&&(g.deleteHandler(g.muc._muc_handler),g.muc._muc_handler=null))},R=function(t){var e=u.Deferred();if(y[t.id]&&y[t.id].reject("desk.publish.error.outside",t,e.promise()),!t.canRetry())return c.error("livechat.xmpp.retry.error",t,"Max retry reached",{code:parseInt(t.code,10),rooms:g.muc.roomNames,conversationId:t.fromUsername}),e.reject("desk.publish.error.retry.max",t);var n=$msg({to:t.from,from:g.jid,type:"groupchat",id:t.id}).c("body").t(t.body).up();n.c("x",{xmlns:"https://iadvize.com/schemas/retry",retry:t.retry+1});var r=+new Date;return g.muc.rooms[t.from].addHandler("message",N(e,t.id,r,t)),g.send(n),y[t.id]=e,e.promise()},N=function(t,e,n,r){return function(o){var a=u(o).attr("id"),s=+new Date;if(a===e){r&&c.info("livechat.xmpp.retry.success","Successfully retried "+r.id,i.merge(r,{conversationId:r.fromUsername}));var l=s-n;return c.info("livechat.xmpp.message.latency","Successfully delivered in "+l+" ms",{id:e,latency:l}),t.resolve(e),!1}return!0}},k=function t(e){if(w.jid){I(e.from);var n=A(w.jid,w.nick,0);e.body&&n.done(function(){if(e.body)return R(e)}).fail(function(){t(e)})}},j=function(t){var e=new o(t);return r.chat.onMessageReceipt(e),!0},M=function(t){var e=g.getUniqueId(),n=$msg({to:t,from:g.jid,type:"groupchat",id:e}).c("ping",{xmlns:"urn:xmpp:ping"});n.up(),g.send(n)},D=function(){clearInterval(b)},z=function(t){D(),b=setInterval(function(){M(t)},6e4)};return t.on(e.OnXmppConnectionDisconnected,function(){if(v=!1,r.chat.connected=!1,++l>=5){if(p()&&(f||h)||!p())return t.emit(e.OnXmppReconnectionFailed),_.reject();f=!0,l=1,g.reset(),g=new Strophe.Connection(m())}clearTimeout(d),d=setTimeout(function(){S(!0)},l>1?3e3:2300)}),t.on(e.OnXmppConnectionConnected,function(){v=!1,_.resolve(),r.chat.connected=!0,g.addHandler(x,null,"message","chat"),g.addHandler(x,null,"message","groupchat"),g.addHandler(x,null,"message","command"),g.addHandler(O("presence"),null,"presence","error"),g.addHandler(O("message"),null,"message","error"),g.addHandler(T,null,"message","error"),g.addHandler(C,null,"presence","error"),g.addHandler(E,"http://jabber.org/protocol/chatstates","message","groupchat"),g.receipts.addReceiptHandler(j),l=0}),{sendChatState:function(t){g.connected&&g.send&&g.send($msg({to:r.conversationJid,from:g.jid,type:"groupchat",website:r.website_id}).c(t).attrs({xmlns:"http://jabber.org/protocol/chatstates"}))},getConnection:function(){return g},connect:S,room:{groupchat:function(t,e){var n=u.Deferred(),r=e||g.getUniqueId(),i=function(){var e=+new Date;g.muc.rooms[w.jid].addHandler("message",N(n,r,e)),g.muc.groupchat(w.jid,t,null,r)};return y[r]=n,g.muc.rooms[w.jid]?i():A(w.jid,w.nick,0).always(i),n.promise()},leave:function(t,e){D(),g.muc.leave(t,e),w.jid=w.nick=null},join:A}}}},{"@iadvize/strophe-http-file-upload":9,"@iadvize/strophe-muc":10,"@iadvize/strophe-outofband":11,"@iadvize/strophe-receipts":12,"@iadvize/strophe.js":13,lodash:35}],82:[function(t,e,n){"use strict";var r=t("lodash");e.exports=function(t,e,n,i){var o=n.$,a=0;return i().addHandler(function(t){return!0},Strophe.NS.MUC_USER,"message",null),{sendEngage:function(t,e,n,s,c,u,l){var d=o.Deferred(),f="!visitor_engage "+(e||""),h={id:t||a||i().getUniqueId(),to:s+"/operators",from:i().jid,type:"chat",website:c,history:u,channel:l||"chat",conversationJid:n},p=$msg(h).c("body").t(f).up().c("active",{xmlns:"http://jabber.org/protocol/chatstates"});return i().receipts.sendMessage(p,(0,r.partial)(d.resolve,t),d.reject),d.promise()},setFirstMessageId:function(t){a=t}}}},{lodash:35}],83:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){function a(t){try{var e={},n=t.childNodes[0].childNodes;return e[n[0].tagName]=n[0].textContent,e[n[1].tagName]=n[1].textContent,e.id=c(t).attr("id"),e}catch(t){throw new u(t.message)}}var s=iAdvize,c=s.$,u=t("./XmppSlotParseError"),l=t("./XmppUploadError"),d={};r().outofband.addOutOfBandHandler(function(t){var i=c(t),o=i.attr("id"),a=i.attr("from"),s=i.find("url").text(),u=i.find("desc").text();try{var l=JSON.parse(u),d=l.type,f=l.data;e.emit(n.OnXmppOOBReceived,o,"operator",null,d,s,f),r().send($iq({type:"result",id:o,to:a}).c("query",{xmlns:Strophe.NS.OUTOFBAND}))}catch(t){e.emit(n.OnTextMessage,o,"operator",s),r().send($iq({type:"error",id:o,to:a}).c("query",{xmlns:Strophe.NS.OUTOFBAND})),console.error(t)}return!0},"set"),e.on(n.OnConversationChatUploadFilesChecked,function(t){var c=t.name+0;e.emit(n.OnConversationChatUploadStarted,t,c),r().fileupload.requestSlot({name:o+"/"+t.name,size:t.size,contentType:t.type},function(o){var u=a(o);d[c]=i.upload(t,u.put,function(t){e.emit(n.OnConversationChatUploadProgress,t,c)}).then(function(){var i={type:"upload",data:{url:u.get,type:t.type,name:t.name}},o=JSON.stringify(i);e.emit(n.OnConversationChatUploadCompleted,c),e.emit(n.OnXmppOOBReceived,u.id,"visitor",null,"upload",u.get,i.data),r().outofband.sendUrl(iAdvize.operator.barejid+"/operators",u.get,o),s.chat.updateHistory(s.chat.MESSAGE_TYPES.VISITOR_RICH_CONTENT,JSON.stringify(i),u.id)}).catch(function(t){var r=s.T("livechat.conversations.upload.error");"AbortUploadError"===t.name&&(r=s.T("livechat.conversations.upload.abort")),e.emit(n.OnConversationChatUploadFailed,c,r)})},function(t){throw e.emit(n.OnConversationChatUploadFailed,c,s.T("livechat.conversations.upload.error")),new l(t.message)},1e4)}),e.on(n.OnConversationChatUploadAborted,function(t){d[t]&&d[t].abort()})}},{"./XmppSlotParseError":86,"./XmppUploadError":87}],84:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){var i=n.$;r().addHandler(function(t){var e=i(t).attr("from"),n=Strophe.getBareJidFromJid(e);return r().send($pres({to:n,type:"subscribed"})),r().send($pres({to:n,type:"subscribe"})),!0},Strophe.NS.CLIENT,"presence","subscribe",null,null),r().addHandler(function(t){var e=i(t).attr("from"),n=Strophe.getBareJidFromJid(e);return r().send($pres({to:n,type:"unsubscribed"})),r().send($pres({to:n,type:"unsubscribe"})),!0},Strophe.NS.CLIENT,"presence","unsubscribe",null,null)}},{}],85:[function(t,e,n){"use strict";var r=t("lodash");e.exports=function(t,e,n,i,o){var a=n.$,s=[],c=function(t){return r.find(s,function(e){return e.barejid===t})};return i().addHandler(function(t){var e=a(t).find("item");return r.forEach(e,function(t){var e=a(t).attr("jid"),n=Strophe.getBareJidFromJid(e);"from"===a(t).attr("subscription")&&s.push(new o({barejid:n}))}),i().send($iq({type:"result",id:a(t).attr("id")})),!0},Strophe.NS.ROSTER,"iq","set"),i().addHandler(function(t){var e=a(t).attr("from"),n=Strophe.getBareJidFromJid(e);return r.remove(s,function(t){return t.barejid===n}),!0},Strophe.NS.CLIENT,"presence","unsubscribe",null,null),i().addHandler(function(n){var i=a(n).attr("type");if(r.includes.unsubscribe,i)return!0;var o=a(n).attr("from"),s=Strophe.getBareJidFromJid(o),u=Strophe.getResourceFromJid(o),l=c(s);return!l||(0===l.resources.length&&t.emit(e.OnXmppRosterUserAvailable,s),l.resources.push(u),!0)},Strophe.NS.CLIENT,"presence",null,null,null),i().addHandler(function(n){var i=a(n).attr("from"),o=Strophe.getBareJidFromJid(i),s=Strophe.getResourceFromJid(i),u=c(o);return!u||(r.remove(u.resources,function(t){return s===t}),0===u.resources.length&&t.emit(e.OnXmppRosterUserUnavailable,o),!0)},Strophe.NS.CLIENT,"presence","unavailable",null,null),t.on(e.OnXmppConnectionConnected,function(){i().sendIQ($iq({type:"get"}).c("query",{xmlns:Strophe.NS.ROSTER}),function(t){var e=a(t).find("item");s=r.filter(e,function(t){return"both"===a(t).attr("subscription")}).map(function(t){var e=a(t).attr("jid"),n=Strophe.getBareJidFromJid(e);return new o({barejid:n})}),r.filter(e,function(t){return"from"===a(t).attr("subscription")&&"subscribe"!==a(t).attr("ask")}).forEach(function(t){var e=a(t).attr("jid");i().send($pres({to:e,type:"subscribe"}))}),n.doInit()})}),{isOnline:function(t){var e=c(t);return!!e&&e.resources.length>0}}}},{lodash:35}],86:[function(t,e,n){"use strict";function r(t){this.stack=(new Error).stack,this.message=t||"Failed to get an upload slot from Xmpp server",this.name="XmppSlotParseError"}(r.prototype=Object.create(Error.prototype)).constructor=r,e.exports=r},{}],87:[function(t,e,n){"use strict";function r(t){this.stack=(new Error).stack,this.message=t||"Failed to upload file",this.name="XmppUploadError"}(r.prototype=Object.create(Error.prototype)).constructor=r,e.exports=r},{}],88:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var a=t("./domain/Contact"),s=t("./domain/Command"),c=t("./domain/Message"),u=t("./domain/Error"),l=new(t("./DeferredManager"))(i.$),d=t("./handlers/ConnectionHandler")(e,n,l,i,c,s,u,r);t("./handlers/OutOfBandHandler")(e,n,d.getConnection,o,i.website_id),t("./handlers/PresenceHandler")(e,n,i,d.getConnection);var f=t("./handlers/RosterHandler")(e,n,i,d.getConnection,a),h=t("./handlers/InvitationHandler")(e,n,i,d.getConnection);return i.define("xmpp",function(){return{invitation:h,connect:d.connect,getConnection:d.getConnection,sendChatState:d.sendChatState,room:d.room,isOnline:f.isOnline}}),{invitation:h,connection:d,roster:f}}},{"./DeferredManager":75,"./domain/Command":76,"./domain/Contact":77,"./domain/Error":78,"./domain/Message":79,"./handlers/ConnectionHandler":81,"./handlers/InvitationHandler":82,"./handlers/OutOfBandHandler":83,"./handlers/PresenceHandler":84,"./handlers/RosterHandler":85}],89:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./messengerTagService"));n.default=function(t,e,n){var i=n.social_notification_customer_id||n.extID||n.ExtID,o=(0,r.default)(t,e.visitor.locale,e.social.url,e.social.facebook.messenger.appId,i);return e.social.facebook.messenger.renderButton=o.renderButton,o}},{"./messengerTagService":90}],90:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.default=function(t,e,n,s,c){function u(t){FB.init({appId:t||s,xfbml:!0,version:"v2.10"}),m.resolve()}function l(t){if("undefined"!=typeof FB)u(t);else if(!p){var n=e.replace("-","_"),r=void 0;(r=n.match(/([a-z]{2}$)/))&&(n=n.replace(/([a-z]{2}$)/,r[0].toUpperCase()));var o=window.fbAsyncInit||i.noop;window.fbAsyncInit=function(){o.call(this,arguments),u(t)},function(t,e,r){var i=t.getElementsByTagName(e)[0];if(!t.getElementById(r)){p=!0;var o=t.createElement(e);o.id=r,o.src="//connect.facebook.net/"+n+"/sdk/xfbml.customerchat.js",i.parentNode.insertBefore(o,i)}}(document,"script","idz-facebook-jssdk")}}function d(t){if(!(t&&t instanceof Element))throw new Error("Facebook element is not defined or invalid");m.isResolved()?FB.XFBML.parse(t):l()}function f(e,n,r){if(0===t(e).children(".idz_social_facebook_messenger_button").length){var i=t(n);i.attr(r),t(e).each(function(e,n){var r=t(n),o=i.clone();o.attr("user_ref")&&(o.attr("user_ref",o.attr("user_ref")+e),r.parents().andSelf().filter("form").each(function(e,n){t(n).one("submit",function(){return o.get(0).onsubmit()})})),r.append(o),d(o.get(0))})}}function h(e,r,i){if(!e)return t.Deferred().reject(new Error("Page id isn't defined"));if(!r)return t.Deferred().reject(new Error("Customer id isn't defined"));var o=a[i];if(!o)return t.Deferred().reject(new Error("Unsupported request for button type"));var s=n+"/facebook/messenger/pages/%PAGE_ID%/customers/%CUSTOMER_ID%/buttons/%BUTTON_URI%".replace("%PAGE_ID%",e).replace("%CUSTOMER_ID%",r).replace("%BUTTON_URI%",o);return t.ajax({url:s,type:"GET",crossDomain:!0})}var p=!1,m=new t.Deferred;return m.isResolved=function(){return"resolved"===this.state},{renderButton:function(e,n,a,u,l,d,p){u=!u||u instanceof Object?c:u;var m=Array.prototype.slice.call(arguments);p=m[m.length-1]instanceof Function?m.pop():function(){};var g=t.extend({color:"string"==typeof l?l:"blue",size:"string"==typeof d?d:"large"},"object"===r(m[m.length-1])?m.pop():{});if(o[n]){var v=o[n].replace(/%APP_ID%/g,s).replace(/%PAGE_ID%/g,a).replace(/%ORIGIN%/g,window.location.origin);-1!==v.indexOf("%STATE_VALUE%")?h(a,u,n).done(function(t){"object"===(void 0===t?"undefined":r(t))&&t.state&&t.userRef?(v=v.replace(/%STATE_VALUE%/g,t.state).replace(/%USER_REF%/g,t.userRef),f(e,v,g),p(null,t.alreadyOptin)):p(new Error("Error while getting messenger button state"))}).fail(function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=(0,i.find)(e,function(t){return t instanceof Error});p(r||new Error("An error occured while building messenger button"))}):(f(e,v,g),p())}else p(new Error("The messenger button type does not exist"))},renderTagElement:d}};var i=t("lodash"),o={"fb-send-to-messenger":'<div class="fb-send-to-messenger idz_social_facebook_messenger_button" messenger_app_id="%APP_ID%" page_id="%PAGE_ID%" data-ref="%STATE_VALUE%"></div>',"fb-messenger-checkbox":"<div class=\"fb-messenger-checkbox idz_social_facebook_messenger_button\" origin=\"%ORIGIN%\" page_id=\"%PAGE_ID%\" messenger_app_id=\"%APP_ID%\" data-ref=\"%STATE_VALUE%\" user_ref=\"%USER_REF%\" prechecked=\"false\" allow_login=\"true\" onsubmit=\"FB.AppEvents.logEvent('MessengerCheckboxUserConfirmation', null, {'app_id':'%APP_ID%', 'page_id':'%PAGE_ID%', 'ref':'%STATE_VALUE%', 'user_ref':iAdvize.$(this).attr('user_ref')})\"></div>","fb-messengermessageus":'<div class="fb-messengermessageus idz_social_facebook_messenger_button" messenger_app_id="%APP_ID%" page_id="%PAGE_ID%"></div>'},a={"fb-send-to-messenger":"sendToMessenger","fb-messenger-checkbox":"checkbox"}},{lodash:35}],91:[function(t,e,n){var r=t("ua-parser-js"),i=t("lodash"),o=(new r).getResult();e.exports=function(t){return{browser:i.get(o,"browser.name")||"unknown",version:parseInt(i.get(o,"browser.major"))||"unknown",OS:i.get(o,"os.name")||"unknown",deviceType:function(e){return e===r.DEVICE.MOBILE?t.MOBILE:e===r.DEVICE.TABLET?t.TABLET:t.DESKTOP}(i.get(o,"device.type"))}}},{lodash:35,"ua-parser-js":38}],92:[function(e,n,r){!function(e){var n=[],r=!1,i=!1,o=function(){!function(){for(var t=n.length,e=0;e<t;e++){var o=n[e][1]();n[e][0]!==o&&(n[e][0]=o,n[e][2](o))}i?r=!1:setTimeout(arguments.callee,850)}(),r=!0},a={add:function(e,a,s){for(var c in n)if(n[c][3]==s)return;var u=[t,e,a,s];n.push(u),!1===r&&(i=!1,o())},start:function(){i=!1,!1===r&&o()},clear:function(){n=[],i=!0},stop:function(){i=!0}};e.Watcher=a}(iAdvize)},{}],93:[function(t,e,n){function r(t){return o[t]instanceof i||(o[t]=new i(t)),o[t]}var i=t("./model/channel"),o={};n.chat=r("chat"),n.call=r("call"),n.visio=r("visio"),n.all=r("all"),n.getChannel=r},{"./model/channel":102}],94:[function(t,e,n){e.exports=function(){return{MOBILE:"mobile",TABLET:"tablet",DESKTOP:"desktop"}}},{}],95:[function(t,e,n){"use strict";e.exports={TargetingRuleTriggered:"targeting.rule.triggered",TargetingRulePresenceUpdated:"targeting.rule.presence.updated",TargetingEngineRan:"targeting.engine.ran",UserNavigated:"used.navigated",TargetingEngineCheckAvailability:"targeting.engine.checkAvailability"}},{}],96:[function(t,e,n){"use strict";var r=t("lodash");e.exports=function(t,e){function n(e,n,i){var o={rule:i},a=r.find(e,{id:i.id+""});return"interaction"===i.type&&a?(o.availability=a.availability,"call"!==i.channel.type&&"all"!==i.channel.type||(o.availability.call.available=o.availability.call.available||t.callOffline.enabled&&t.callOffline.available),n.push(o)):"qualification"===i.type&&n.push(o),n}function i(t,e){return r.reduce(t,r.partial(n,e),[])}return{getRulesAvailabilities:function(t){var n=r.filter(t,{type:"interaction"});return e.checkRulesAvailability(n).then(r.partial(i,t))},reduceRulesToAvailabilities:i}}},{lodash:35}],97:[function(e,n,r){"use strict";var i=function(){function e(e,n){var r=[],i=!0,o=!1,a=t;try{for(var s,c=e[Symbol.iterator]();!(i=(s=c.next()).done)&&(r.push(s.value),!n||r.length!==n);i=!0);}catch(t){o=!0,a=t}finally{try{!i&&c.return&&c.return()}finally{if(o)throw a}}return r}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("lodash");n.exports=function(e,n,r){function a(t){e.opOffline=t.chat.available?0:1,e.c2cOffline=t.call.available||e.callMeeting.available&&e.callMeeting.enabled?0:1,e.c2vOffline=t.video.available?0:1,e.callInstant&&(e.callInstant.available=t.call.available),e.opBusy=t.chat.busy?1:0}function s(t){e.callbacks.onRuleStarted({id:t.id,label:t.label}),e.flags.message=e.T("LA_REGLE")+" "+t.label+" "+e.T("VIENT_ETRE_EXECUTEE"),e.flags.proactif_alert="!proactif "+t.label,e.proactif_now=1,e.flags.proactif_activatedId=t.id,t.displayed=!0,e.ProActif.saveData()}function c(t){return(0,o.values)((0,o.groupBy)(t,function(t){var e=t.action;return t.rule.id+"-"+e.type})).map(function(t){return(0,o.find)(t,function(t){var e=t.action,n=t.availability;return e.isExecuted()&&!e.shouldCancel(n)||e.shouldExecute(n)})}).filter(function(t){return!(0,o.isUndefined)(t)})}function u(t){var e=(0,o.partition)(t,function(t){return null===t.action.getContainerId()}),n=i(e,2),r=n[0],a=n[1],s=(0,o.values)((0,o.groupBy)(a,function(t){return t.action.getContainerId()})).map(function(t){return t[t.length-1]});return(0,o.union)(r,s)}return{executeInteractionRules:function(){var e=arguments.length>0&&arguments[0]!==t?arguments[0]:[],l=n.Deferred(),d=e.filter(function(t){return"interaction"===t.rule.type}),f=(0,o.flatten)(d.map(function(t){var e=t.rule,n=t.availability;return(e.actions||[]).map(function(t){return{action:t,availability:n,rule:e}})})),h=(0,o.partition)(f,function(t){return t.action.isVisible()}),p=i(h,2),m=p[0];p[1].filter(function(t){var e=t.action,n=t.availability;return e.shouldExecute(n)}).forEach(function(t){var e=t.action,n=t.availability;return e.execute(n)});var g=m.filter(function(t){return t.action.isExecuted()}),v=c(m),_=v.filter(function(t){var e=t.action,n=t.availability;return e.shouldExecute(n)}),b=u(v);return(0,o.difference)(g,b).forEach(function(t){return t.action.cancel()}),b.filter(function(t){var e=t.action,n=t.availability;return e.shouldExecute(n)}).forEach(function(t){var e=t.action,n=t.availability;r&&a(n),e.execute(n)}),(0,o.values)((0,o.groupBy)(_,"rule.id")).forEach(function(t){return s(i(t,1)[0].rule)}),l.resolve(e.map(function(t){return t.rule})),l.promise()},executeQualificationRule:function(t,e){(t.actions||[]).filter(function(t){return t.shouldExecute(e)}).forEach(function(t){return t.execute(e)})}}}},{lodash:35}],98:[function(t,e,n){"use strict";var r=t("lodash");e.exports=function(t,e){function n(t){var e=t.rule,n=t.availability,r={id:e.id,type:e.type,exec:e.shouldIncrementExecutionCount()?1:0,dis:e.shouldIncrementDisplayCount(n)?1:0};return n&&(r.chatoff=n.chat.available?0:1,r.calloff=n.call.available?0:1,r.busy=n.chat.busy?1:0),r}function i(e){return{s:t.website_id,u:t.vuid,rules:r.map(e,n)}}function o(){return"ha"===t.platform&&"833"===t.website_id}function a(){return"ha"===t.platform&&155===t.client_id||"sd"===t.platform&&8925===t.client_id}var s=t.chaturl+"rpc/proactif_count.php";return{sendProactifCount:function(n){var r=e.Deferred();if(2===t.chat.status||!o()&&!a())return r.resolve(n),r.promise();var c={url:s,data:i(n),type:"post"};return e.ajax(c),r.resolve(n),r.promise()}}}},{lodash:35}],99:[function(t,e,n){"use strict";var r=t("lodash");e.exports=function(t,e,n,i){function o(){return{chat:{available:!t.opOffline,busy:!!t.opBusy},call:{available:!t.c2cOffline},video:{available:!t.c2vOffline}}}function a(r){var o=e.Deferred();return 2!=t.chat.status&&(i||r)?(t.forceDep=r,n.find({forceDep:r}).done(function(){o.resolve()})):o.resolve(),o.promise()}function s(t){return r.map(t,function(t){var e={rule:t};return"interaction"===t.type&&(e.availability=o()),e})}function c(t){var e=r.slice(t);return r.get(r.chain(e).reverse().find(function(t){return"interaction"===t.type&&t.skill}).value(),"skill.id")}return{getRulesAvailabilities:function(t){var n=e.Deferred();return r.some(t,{type:"interaction"})?a(c(t)).then(function(){n.resolve(s(t))}):n.resolve(s(t)),n.promise()},getFirstEligibleSkillIdForRules:c}}},{lodash:35}],100:[function(t,e,n){"use strict";var r=t("lodash");e.exports=function(t,e,n,i){function o(t){var e=t.rule,n=t.availability;return{id:e.id,isVisibleAndAvailable:e.hasActionRequiringDisplay(n),canBeDisplayed:e.hasActionRequiringDisplay(n),shouldIncrementDisplayCount:e.shouldIncrementDisplayCount(n),shouldIncrementMissedDisplayCount:e.shouldIncrementMissedDisplayCount(n),availability:n}}function a(t,e){var n=e.rule;return"qualification"===n.type?(t.qualificationRules.push(n.id),t):(n.shouldIncrementExecutionCount()&&t.interactionRules.push(o(e)),t)}function s(e){var n=r.reduce(e,a,{qualificationRules:[],interactionRules:[]});return{visitor:{id:t.vuid,websiteId:+t.website_id,sessionId:t.vStats.sessionId},qualificationRules:n.qualificationRules,interactionRules:n.interactionRules}}function c(n){var i=e.Deferred();if(!t.targetedVisitors||!t.targetedVisitors.enabled)return i.resolve([]),i.promise();var o=s(n);if(0===o.interactionRules.length&&0===o.qualificationRules.length)return i.resolve([]),i.promise();var a={url:u,data:t.util.JSONStringify(o),contentType:"application/json",processData:!1,type:"post",success:function(t){i.resolve(r.map(t.authorizedRules))},error:function(){i.resolve([])}};return e.ajax(a),i.promise()}var u=t.targetedVisitors.url+"triggered-rules?platform="+t.platform;return{getRulesOpportunities:function(o){var a=e.Deferred();return 2===t.chat.status?(a.resolve(o),a.promise()):(c(o).then(function(t){var e=r.reject(o,function(e){var o=e.rule,a=e.availability,s=r.includes(t,o.id),c=o.hasActionRequiringDisplay(a);return"interaction"!==o.type||!s&&c||n.emit(i.TargetingRulePresenceUpdated,o,a),c&&!s});a.resolve(e)}),a.promise())}}}},{lodash:35}],101:[function(t,e,n){"use strict";var r=t("lodash"),i=t("./events"),o=t("lodash.clonedeep");e.exports=function(e,n,a,s){function c(t){return!t||!e("#idzc2c").is(":visible")&&(t.executed=!0,void("qualification"===t.type?(j.executeQualificationRule(t,{}),u(t)):h(t).then(u)))}function u(t){M.setRule(t.id,t),M.setStatus(t.id,"pending"),D()}function l(t){if(t)return t.executed=!1,t.displayed=!1,r.forEach(t.actions,function(t){t.cancel()}),t}function d(t){var n=e.Deferred();return C.emit(i.TargetingRuleTriggered,t),n.resolve(t),n.promise()}function f(){return!/(ip-label|WatchMouse)/.test(navigator.userAgent)}function h(t){var r=e.Deferred();return!a.hasContactOngoing()&&t.checkHash&&n.vStats.merpHash?b.find({h:n.vStats.merpHash}).done(function(e){e.merpData?(n.forceAgent=e.merpData.operatorId,0==e.opOffline?r.resolve(t):(n.setStatus(),r.reject(t))):r.reject(t)}).fail(function(){r.reject(t)}):r.resolve(t),r.promise()}function p(t){if("all"===t.type)return p(y.chat),void p(y.call);var e={chat:"",call:"c2c_",visio:"visio_"}[t.type];n.preferences["param_"+e+"connectedwidget"]=0,n.preferences["param_"+e+"noconnectedwidget"]=0,n.setStatus()}function m(t){var e=0;return"qualification"===t.type&&--e,t.channel&&"all"===t.channel.type&&++e,e}var g=t("./deviceType")(),v=t("./DeviceInformationExtractor")(g),_=t("./vStats")(n,e,v),b=t("../../livechat/src/polling"),y=t("./channels");t("./Watcher");var w={},S=t("./model/rule/condition")(n.vStats,w,n),O=window.iAdvizeCallbacks&&(window.iAdvizeCallbacks.onStatusChanged||window.iAdvizeCallbacks.onCallStatusChanged||window.iAdvizeCallbacks.onTargetingRuleTriggered),T=n.routing&&n.routing.enabled||!O,C=n.require("eventManager"),x=t("./visitor")(n.vStats,n.JSONStore),E=t("./model/rule")(n,C,y,x,a),A=t("./handlers/OldAvailabilityHandler")(n,n.$,b,T),I=!1;if(!n.vStats.merpHash&&n.routing&&n.routing.enabled){var R=t("./routingService")(n,n.$,b,A.getFirstEligibleSkillIdForRules);A=t("./handlers/AvailabilityHandler")(n,R),I=!0}var N=t("./handlers/OpportunityHandler")(n,n.$,C,i),k=t("./handlers/GeniusTargetingHandler")(n,n.$),j=t("./handlers/ExecutionHandler")(n,n.$,I),M={data:{rules:{},status:{}},setStatus:function(t,e){this.data.status[t]=e},getTriggeredRules:function(){var t=this.data;return r.chain(this.data.status).pickBy(function(t){return"pending"===t}).forEach(function(e,n){t.status[n]="done"}).keys().map(function(e){return t.rules[e]}).value()},setRule:function(t,e){this.data.rules[t]=e},clean:function(){this.data.rules={},this.data.status={}}};C.on("rule.action.executed.button",p);var D=r.debounce(function(){var t=M.getTriggeredRules();0!==t.length&&A.getRulesAvailabilities(t).then(N.getRulesOpportunities).then(k.sendProactifCount).then(j.executeInteractionRules).then(function(t){r.some(t,"displayed")&&C.emit(i.TargetingEngineCheckAvailability),r.forEach(t,d)})},2e3),z=n.ProActif={_datas:[],vStatsI:w,run:function(t){if(!f())return!0;if(void 0!==window.idzCustomData)for(var e in idzCustomData)idzCustomData.hasOwnProperty(e)&&void 0!==idzCustomData[e]&&null!==idzCustomData[e]&&n.vStats.val(e,idzCustomData[e]);if(a.hasContactOngoing())return!0;var i=this._datas;i=t?r.filter(i,function(e){return e.id==t}):r.sortBy(i,m);for(var o=0;o<i.length;o++){var s=i[o];this.areRuleConditionsMet(s)?c(s):s.executed&&(s=l(s))}return i},reRun:function(){if(!a.hasContactOngoing()){var t=r.filter(z._datas,"displayed");r.isEmpty(t)||A.getRulesAvailabilities(t).then(j.executeInteractionRules).then(function(){C.emit(i.TargetingEngineCheckAvailability)})}},areRuleConditionsMet:function(t){var e=r.chain(t.conditions).filter("criteria").forEach(function(e){var n=e.criteria;void 0!==e.getValue()&&"merpLink"===n.field&&(t.checkHash=!0)}).map(r.partial(this.isRuleConditionMet,r,t.id)).value();return r.every(e)},isRuleConditionMet:function(t,e){if(void 0!==t.getValue()){if(t.tRefreshData instanceof Function&&t.tRefreshData(),t.isMet())return!0;t.tIsFalse instanceof Function&&t.tIsFalse(e)}return!1},fireRule:c,saveData:function(){f()&&setTimeout(function(){n.JSONStore.saveData({proactif_activated:n.flags.proactif_activated,proactif_showchatbar:n.flags.proactif_showchatbar,proactif_message:n.util.htmlspecialchars(n.flags.proactif_message),message:n.util.htmlspecialchars(n.flags.message),proactif_invit:n.flags.proactif_invit,proactif_activatedId:n.flags.proactif_activatedId,proactif_alert:n.flags.proactif_alert,phoneDisplayed:n.flags.phoneDisplayed})},400)},watchCustomData:function(t,r,i,o,a){n.Watcher.add(function(){var n=e(t).text()||e(t).val();return n&&"INTEGER"==i&&"count"!==o&&(n=parseInt(n.replace(/,/g,".").replace(/[^\d.]+/g,""),10)),n&&"FLOAT"==i&&"count"!==o&&(n=parseFloat(n.replace(/,/g,".").replace(/[^\d.]+/g,""),10)),n},function(t){var e=n.vStats[r],s=n.Store.get(r);if("count"!=o&&void 0===s&&(s=t),"current"==o)void 0!==t?n.vStats[r]=t:delete n.vStats[r];else if("max"==o)void 0!==t&&t>=s&&(s=t,n.Store.set(r,s)),void 0!==s&&(n.vStats[r]=s);else if(void 0!==t&&"min"==o)void 0!==t&&t<=s&&(s=t,n.Store.set(r,s)),void 0!==s&&(n.vStats[r]=s);else if("count"==o){if(a){var c=!1;"STRING"!=i&&t==a?c=!0:"STRING"==i&&void 0!==t&&-1!=t.indexOf(a)&&(c=!0),c&&(s=s||0,s++,n.Store.set(r,s))}n.vStats[r]=s||0}n.vStats[r]!=e&&setTimeout(function(){n.ProActif.run()},200)},r)},setData:function(t){t&&(this._datas=r.map(t,function(t){var e=new E(t);return e.conditions=r.map(e.targetingConditions,function(t){var e=t.targetingConditionCriteria||t.visitorAttribute;if(t.criteria=e,e&&t.visitorAttribute&&(e.field="ext_"+e.field),r.isString(t.value)&&-1!==t.value.indexOf("IDZ_CDATA_")){t.isValCustom=!0;var n=JSON.parse(t.value.substr(10));t.valField="ext_"+n.field,t.valPath=n.path,t.valBaseType=n.basetype,t.valValType=n.valtype,""!=t.valPath&&z.watchCustomData(t.valPath,t.valField,t.valBaseType,t.valValType)}return t=S(t),e&&e.path&&""!=e.path&&z.watchCustomData(e.path,e.field,t.getBaseType(),e.valueType,e.value),t}),e}))},match:function(t){C.on(i.TargetingRuleTriggered,t)}};z.setData(n.proactifData),C.emit(i.TargetingLoaded,o({list:z._datas}));var P=t("./replayTargeting")(n,C,i,function(){M.clean(),r.forEach(n.ProActif._datas,function(t){"qualification"===t.type&&t.executed&&l(t)});var t=n.ProActif.run();t instanceof Array&&C.emit(i.TargetingEngineRan,t)},_);P.launch(),n.navigate=P.navigate,C.on(i.TargetingEngineCheckAvailability,r.debounce(z.reRun,3e4))}},{"../../livechat/src/polling":72,"./DeviceInformationExtractor":91,"./Watcher":92,"./channels":93,"./deviceType":94,"./events":95,"./handlers/AvailabilityHandler":96,"./handlers/ExecutionHandler":97,"./handlers/GeniusTargetingHandler":98,"./handlers/OldAvailabilityHandler":99,"./handlers/OpportunityHandler":100,"./model/rule":118,"./model/rule/condition":115,"./replayTargeting":119,"./routingService":120,"./vStats":121,"./visitor":122,lodash:35,"lodash.clonedeep":30}],102:[function(t,e,n){"use strict";function r(t){"both"===t&&(t="all"),this.type=t}var i={chat:function(t){return t.chat.available},call:function(t){return t.call.available},visio:function(t){return t.video.available},all:function(t){return i.chat(t)||i.call(t)},"social-facebook-messenger-messageUs":function(){return!0},"social-facebook-messenger-sendToMessenger":function(){return!0},"social-facebook-messenger-chatbox":function(){return!0},"social-sms-desktop":function(){return!0},"social-sms-mobile":function(){return!0},"social-whatsapp-desktop":function(){return!0},"social-whatsapp-mobile":function(){return!0},none:function(){return!1}},o={chat:function(t){return t.chat.busy},call:function(t){return t.call.busy},visio:function(t){return t.video.busy},all:function(t){return o.chat(t)||o.call(t)},none:function(){return!1}},a=r.prototype;a.isAvailable=function(t){return!!(i[this.type]||i.none)(t)},a.isBusy=function(t){return!!(o[this.type]||o.none)(t)},e.exports=r},{}],103:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={BOTTOM_CORNER:"bottomCorner",MODAL:"modal"};n.default=r},{}],104:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("lodash"),a=function(){function t(e){r(this,t),this.executed=!1,(0,o.assign)(this,e)}return i(t,[{key:"getContainerId",value:function(){return null}},{key:"execute",value:function(){this.executed=!0,this.recordExecution()}},{key:"recordExecution",value:function(){}},{key:"cancel",value:function(){this.executed=!1}},{key:"isAvailable",value:function(){return!0}},{key:"isExecuted",value:function(){return this.executed}},{key:"isVisible",value:function(){return this.visible}},{key:"shouldIncrementExecutionCount",value:function(){return!0}},{key:"canBeDisplayed",value:function(t){return this.isAvailable(t)&&this.isVisible()}},{key:"shouldExecute",value:function(t){return!this.isExecuted()&&this.isAvailable(t)}},{key:"shouldCancel",value:function(t){return this.isExecuted()&&!this.isAvailable(t)}}],[{key:"canHandle",value:function(t){return!1}}]),t}();a.prototype.visible=!1,n.default=a},{lodash:35}],105:[function(e,n,r){function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function e(n,r,i){null===n&&(n=Function.prototype);var o=Object.getOwnPropertyDescriptor(n,r);if(o===t){var a=Object.getPrototypeOf(n);return null===a?t:e(a,r,i)}if("value"in o)return o.value;var s=o.get;return s===t?t:s.call(i)},l=i(e("classnames")),d=e("../../../../../../../sreact"),f=i(e("./AbstractAction")),h=i(e("../ActionContainers"));r.default=function(t,e,n){var r=function(r){function i(t){o(this,i);var e=a(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.channel=n.getChannel(e.data.button.type),e}return s(i,r),c(i,[{key:"getContainerId",value:function(){return h.default.BOTTOM_CORNER}},{key:"isAvailable",value:function(e){var n=this.data.button;return!("call"!==n.type&&"both"!==n.type||!t.callMeeting.available||!t.callMeeting.enabled)||this.channel.isAvailable(e)}},{key:"execute",value:function(){u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"execute",this).call(this),t.floatingWidget.switchWidget(this.data.button,this.getComponent),e.emit("rule.action.executed.button",this.channel)}},{key:"cancel",value:function(){u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"cancel",this).call(this),t.floatingWidget.destroy(this.data.button)}},{key:"getComponent",value:function(t,e,n,r,i,o,a,s,c,u,f,h,p,m,g,v,_,b){var y=i+"images/livechat/blank.gif",w=(0,l.default)("type_"+e,{type_avatar:252==n}),S=(0,d.html)("img",{class:"idz_btnimg",src:s,style:{border:"none"},id:"idz_btnimgoff",name:"offline",border:"0",alt:""}),O=(0,d.html)("img",{class:"idz_blankimg",name:"offline_ie",border:"0",alt:"",src:y,style:{border:"none"}});if("both"===e){var T=(0,l.default)(w,{type_custom:c});return(0,d.html)(d.Fragment,null,(0,d.html)("div",{class:"idz_t_close",title:t}),(0,d.html)("div",{id:"idz_fonline",class:T,style:{display:"none"}},(0,d.html)("div",{class:"idz_t_btn"},c?(0,d.html)(d.Fragment,null,(0,d.html)("a",{href:"javascript:void(0)",class:"idz_btn_on_call",style:{display:"none"}},(0,d.html)("img",{border:"0",alt:"",src:_})),(0,d.html)("a",{href:"javascript:void(0)",class:"idz_btn_on_chat",style:{display:"none"}},(0,d.html)("img",{border:"0",alt:"",src:b})),(0,d.html)("br",null)):(0,d.html)(d.Fragment,null,(0,d.html)("a",{href:"javascript:void(0)",class:"idz_btn_on idz_btn_on_call",style:{display:"none",color:u,"font-size":h+"px","font-family":m+" sans-serif"}},g),(0,d.html)("a",{href:"javascript:void(0)",class:"idz_btn_on idz_btn_on_chat",style:{display:"none",color:u,"font-size":f+"px","font-family":p+" sans-serif"}},v))),(0,d.html)("img",{class:"idz_btnimg",id:"idz_btnimgon",name:"online",border:"0",alt:"",src:r,style:{border:"none"}}),(0,d.html)("img",{class:"idz_blankimg",name:"online_ie",border:"0",alt:"",src:y,style:{border:"none"}})),(0,d.html)("div",{id:"idz_foffline",class:w,style:{display:"none"}},a?(0,d.html)("a",{href:"javascript:void(0);",OnClick:"window.location.href='"+a+"'"},S,O):(0,d.html)("a",{href:"javascript:void(0);"},S,O)))}return(0,d.html)(d.Fragment,null,(0,d.html)("div",{class:"idz_t_close",title:t}),(0,d.html)("div",{id:"idz_fonline",class:w,style:{display:"none"}},(0,d.html)("a",{href:"javascript:void(0);"},(0,d.html)("img",{class:"idz_btnimg",id:"idz_btnimgon",name:"online",border:"0",alt:"",src:r,style:{border:"none"}}),(0,d.html)("img",{class:"idz_blankimg",name:"online_ie",border:"0",alt:"",src:y,style:{border:"none"}}))),(0,d.html)("div",{id:"idz_foffline",class:w,style:{display:"none"}},o?(0,d.html)("a",{href:a,target:"_blank"},S):a?(0,d.html)("a",{href:"javascript:void(0);",OnClick:"window.location.href='"+a+"'"},S,O):(0,d.html)("a",{href:"javascript:void(0);"},S,O)))}}],[{key:"canHandle",value:function(t){return"button"===t.type}}]),i}(f.default);return r.prototype.visible=!0,r}},{"../../../../../../../sreact":123,"../ActionContainers":103,"./AbstractAction":104,classnames:14}],106:[function(e,n,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function e(n,r,i){null===n&&(n=Function.prototype);var o=Object.getOwnPropertyDescriptor(n,r);if(o===t){var a=Object.getPrototypeOf(n);return null===a?t:e(a,r,i)}if("value"in o)return o.value;var s=o.get;return s===t?t:s.call(i)},l=i(e("./AbstractAction")),d=i(e("../ActionContainers"));r.default=function(t,e,n){var r=function(e){function r(){return o(this,r),a(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return s(r,e),c(r,[{key:"getContainerId",value:function(){return d.default.BOTTOM_CORNER}},{key:"isAvailable",value:function(t){return n.chat.isAvailable(t)}},{key:"execute",value:function(){u(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"execute",this).call(this),t.Templates.showUI()}}],[{key:"canHandle",value:function(t){return"chatbox"===t.type}}]),r}(l.default);return r.prototype.visible=!0,r}},{"../ActionContainers":103,"./AbstractAction":104}],107:[function(e,n,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function e(n,r,i){null===n&&(n=Function.prototype);var o=Object.getOwnPropertyDescriptor(n,r);if(o===t){var a=Object.getPrototypeOf(n);return null===a?t:e(a,r,i)}if("value"in o)return o.value;var s=o.get;return s===t?t:s.call(i)},u=e("lodash"),l=function(t){return t&&t.__esModule?t:{default:t}}(e("./AbstractAction"));r.default=function(t,e,n,r){var d={chat:function(){return t.chat.onClickChatWidget()},call:function(){return t.chat.onClickC2cWidget()},video:function(){return n.emit(n.events.OnConversationVisioRequested)}},f=function(t){function l(t){i(this,l);var n=o(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,t));return n.channel=r.getChannel(n.data.button.type),e(n.data.button.onlineCssSelector).click(function(){return(0,u.get)(d,n.channel.type,u.noop)(),!1}),n}return a(l,t),s(l,[{key:"isAvailable",value:function(t){return this.channel.isAvailable(t)}},{key:"shouldExecute",value:function(){return!0}},{key:"shouldCancel",value:function(){return!1}},{key:"execute",value:function(t){c(l.prototype.__proto__||Object.getPrototypeOf(l.prototype),"execute",this).call(this),n.emit("rule.action.executed.button",this.channel);var r=this.data.button;e(r.onlineCssSelector).hide(),e(r.busyCssSelector).hide(),e(r.offlineCssSelector).hide(),this.isAvailable(t)?e(r.onlineCssSelector).show():this.channel.isBusy(t)?e(r.busyCssSelector).show():e(r.offlineCssSelector).show()}}],[{key:"canHandle",value:function(t){return"fixed_buttons"===t.type}}]),l}(l.default);return f.prototype.visible=!0,f}},{"./AbstractAction":104,lodash:35}],108:[function(e,n,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function e(n,r,i){null===n&&(n=Function.prototype);var o=Object.getOwnPropertyDescriptor(n,r);if(o===t){var a=Object.getPrototypeOf(n);return null===a?t:e(a,r,i)}if("value"in o)return o.value;var s=o.get;return s===t?t:s.call(i)},l=i(e("./AbstractAction")),d=i(e("../ActionContainers"));r.default=function(t,e,n){var r=function(e){function r(){return o(this,r),a(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return s(r,e),c(r,[{key:"isAvailable",value:function(e){var r=this.data.invitation,i=n.getChannel(r.type);return 2!=t.chat.status&&(null==t.flags.proactif_invit||-1===t.flags.proactif_invit.indexOf(r.id))&&i.isAvailable(e)}},{key:"getContainerId",value:function(){return d.default.MODAL}},{key:"execute",value:function(){u(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"execute",this).call(this);var e=this.data.invitation;t.chat.loadInvitation(e.id)}},{key:"recordExecution",value:function(){var e=this.data.invitation;t.flags.proactif_invit=t.flags.proactif_invit||"",t.flags.proactif_invit+=e.id+","}},{key:"shouldIncrementExecutionCount",value:function(){return null==t.flags.proactif_invit||-1===t.flags.proactif_invit.indexOf(this.data.invitation.id)}}],[{key:"canHandle",value:function(t){return"invitation"===t.type}}]),r}(l.default);return r.prototype.visible=!0,r}},{"../ActionContainers":103,"./AbstractAction":104}],109:[function(e,n,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function e(n,r,i){null===n&&(n=Function.prototype);var o=Object.getOwnPropertyDescriptor(n,r);if(o===t){var a=Object.getPrototypeOf(n);return null===a?t:e(a,r,i)}if("value"in o)return o.value;var s=o.get;return s===t?t:s.call(i)},l=i(e("./AbstractAction")),d=i(e("../ActionContainers"));r.default=function(t,e,n){var r=function(e){function r(){return o(this,r),a(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return s(r,e),c(r,[{key:"isAvailable",value:function(e){return n.chat.isAvailable(e)&&2!=t.chat.status&&null==t.flags.proactif_message&&1!=t.opBusy}},{key:"getContainerId",value:function(){return d.default.BOTTOM_CORNER}},{key:"execute",value:function(){u(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"execute",this).call(this),t.chat.putOpMsg(null,this.data.text,0)}},{key:"recordExecution",value:function(){t.flags.proactif_message=t.flags.proactif_message||""}},{key:"shouldIncrementExecutionCount",value:function(){return null==t.flags.proactif_message}}],[{key:"canHandle",value:function(t){return"message"===t.type}}]),r}(l.default);return r.prototype.visible=!0,r}},{"../ActionContainers":103,"./AbstractAction":104}],110:[function(e,n,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function e(n,r,i){null===n&&(n=Function.prototype);var o=Object.getOwnPropertyDescriptor(n,r);if(o===t){var a=Object.getPrototypeOf(n);return null===a?t:e(a,r,i)}if("value"in o)return o.value;var s=o.get;return s===t?t:s.call(i)},l=i(e("./AbstractAction")),d=i(e("../ActionContainers"));r.default=function(t,e,n,r){var i=function(t){function i(t){o(this,i);var e=a(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.channel=n.getChannel(e.data.button.type),e}return s(i,t),c(i,[{key:"getContainerId",value:function(){return d.default.BOTTOM_CORNER}},{key:"isAvailable",value:function(t){return this.channel.isAvailable(t)}},{key:"execute",value:function(){u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"execute",this).call(this),r.getEngine("messenger").chatbox.render(this.data.button.btnpageid),e.emit("rule.action.executed.button",this.channel)}},{key:"cancel",value:function(){u(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"cancel",this).call(this),r.getEngine("messenger").chatbox.destroy()}}],[{key:"canHandle",value:function(t){return"button"===t.type&&"social-facebook-messenger-chatbox"===t.data.button.type}}]),i}(l.default);return i.prototype.visible=!0,i}},{"../ActionContainers":103,"./AbstractAction":104}],111:[function(e,n,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function e(n,r,i){null===n&&(n=Function.prototype);var o=Object.getOwnPropertyDescriptor(n,r);if(o===t){var a=Object.getPrototypeOf(n);return null===a?t:e(a,r,i)}if("value"in o)return o.value;var s=o.get;return s===t?t:s.call(i)},u=function(t){return t&&t.__esModule?t:{default:t}}(e("./AbstractAction"));r.default=function(t){var e=function(e){function n(){return i(this,n),o(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return a(n,e),s(n,[{key:"execute",value:function(){c(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"execute",this).call(this);var e=this.data.visitorAttribute;if(e){var r=e.field,i=+t.getAttribute(r,0),o=this.visitorAttributeModifier(i,this.data.value);t.setAttribute(r,o).persist()}}}]),n}(u.default);return{IncreaseVisitorAttributeAction:function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),s(e,[{key:"visitorAttributeModifier",value:function(t,e){return t+e}}],[{key:"canHandle",value:function(t){return"increase_visitor_attribute"===t.type}}]),e}(e),DecreaseVisitorAttributeAction:function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),s(e,[{key:"visitorAttributeModifier",value:function(t,e){return t-e}}],[{key:"canHandle",value:function(t){return"decrease_visitor_attribute"===t.type}}]),e}(e),ModifyVisitorAttributeAction:function(t){function e(){return i(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,t),s(e,[{key:"visitorAttributeModifier",value:function(t,e){return e}}],[{key:"canHandle",value:function(t){return"modify_visitor_attribute"===t.type}}]),e}(e)}}},{"./AbstractAction":104}],112:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var i=r(t("./VisitorAttributeActions")),o=r(t("./MessengerChatboxButtonAction")),a=r(t("./ButtonAction")),s=r(t("./InvitationAction")),c=r(t("./ChatboxAction")),u=r(t("./MessageAction")),l=r(t("./FixedButtonAction"));n.default=function(t,e,n,r,d){var f=(0,i.default)(r);return{IncreaseVisitorAttributeAction:f.IncreaseVisitorAttributeAction,DecreaseVisitorAttributeAction:f.DecreaseVisitorAttributeAction,ModifyVisitorAttributeAction:f.ModifyVisitorAttributeAction,MessengerChatboxButtonAction:(0,o.default)(t,e,n,d),ButtonAction:(0,a.default)(t,e,n),InvitationAction:(0,s.default)(t,e,n),ChatboxAction:(0,c.default)(t,e,n),MessageAction:(0,u.default)(t,e,n),FixedButtonAction:(0,l.default)(t,t.$,e,n)}}},{"./ButtonAction":105,"./ChatboxAction":106,"./FixedButtonAction":107,"./InvitationAction":108,"./MessageAction":109,"./MessengerChatboxButtonAction":110,"./VisitorAttributeActions":111}],113:[function(t,e,n){"use strict";var r=t("lodash"),i=function(t){return t&&t.__esModule?t:{default:t}}(t("./actions"));e.exports=function(t,e,n,o,a){var s=(0,i.default)(t,e,n,o,a);return function(t){var e=(0,r.find)(s,function(e){return e.canHandle(t)});if(!e)throw new Error("Unknown targeting rule action type "+t.type);return new e(t)}}},{"./actions":112,lodash:35}],114:[function(t,e,n){"use strict";var r=t("lodash"),i=t("./operators");e.exports=function(t){function e(t){r.assign(this,t),this.types=[]}return e.prototype.super=function(){return Object.getPrototypeOf(this)},e.prototype.sanitizeValue=function(t){return null===t||void 0===t?t:(""+t).toLowerCase()},e.prototype.getValue=function(){return this.sanitizeValue(t[this.criteria.field])},e.prototype.getTestValue=function(){return this.sanitizeValue(this.isValCustom?t[this.valField]:this.value)},e.prototype.isMet=function(){var t=r.get(i,this.logicalOperator);if(!t)throw new Error("The operator "+this.logicalOperator+" isn't recognized");return t(this.getValue(),this.getTestValue())},e.prototype.getType=function(){return r.last(this.types)},e.prototype.getBaseType=function(){return r.head(this.types)},e}},{"./operators":116,lodash:35}],115:[function(t,e,n){"use strict";var r=t("lodash");e.exports=function(e,n,i){var o=t("./Condition")(e),a=t("./types")(o,e,n,i);return function(t){var e=t.criteria||{},n=e.type;return e.valueType&&"count"===e.valueType&&(n="INTEGER"),new(r.get(a,n,o))(t)}}},{"./Condition":114,"./types":117,lodash:35}],116:[function(t,e,n){"use strict";var r=t("lodash");e.exports=r.assign({is:function(t,e){return t==e},"is not":function(t,e){return t!=e},contains:function(t,e){return-1!==t.indexOf(e)},"not contains":function(t,e){return-1===t.indexOf(e)},"ends with":function(t,e){return r.endsWith(t,e)},"begins with":function(t,e){return r.startsWith(t,e)},regex:function(t,e){return new RegExp(e).test(t)},"not regex":function(t,e){return!new RegExp(e).test(t)},equal:function(t,e){return t==e},"less than":function(t,e){return t<e},"more than":function(t,e){return t>e},"less than or equal":function(t,e){return t<=e},"more than or equal":function(t,e){return t>=e}},{is:function(t,e){return t==e},notIs:function(t,e){return t!=e},contains:function(t,e){return-1!==t.indexOf(e)},notContains:function(t,e){return-1===t.indexOf(e)},endsWith:function(t,e){return r.endsWith(t,e)},beginsWith:function(t,e){return r.startsWith(t,e)},regex:function(t,e){return new RegExp(e).test(t)},notRegex:function(t,e){return!new RegExp(e).test(t)},equal:function(t,e){return t==e},lowerThan:function(t,e){return t<e},greaterThan:function(t,e){return t>e},lowerOrEqualThan:function(t,e){return t<=e},greaterOrEqualThan:function(t,e){return t>=e}})},{lodash:35}],117:[function(e,n,r){"use strict";var i=e("lodash");n.exports=function(e,n,r,o){function a(n){function r(t){c.call(this,t),this.types.push(n),r.prototype.tInit instanceof Function&&r.prototype.tInit.call(this)}var o=arguments.length>1&&arguments[1]!==t?arguments[1]:{},a=arguments.length>2&&arguments[2]!==t?arguments[2]:null,c=i.get(s,a,e);r.prototype=i.create(c.prototype,o),r.prototype.constructor=r,s[n]=r}var s={};return a("BOOL",{sanitizeValue:function(t){return i.isString(t)?"true"===t||"1"===t:!!t}}),a("INTEGER",{sanitizeValue:function(t){return null===t||void 0===t?t:parseInt(t,10)}}),a("FLOAT",{sanitizeValue:function(t){return null===t||void 0===t?t:parseFloat(t)}}),a("STRING"),a("TIME",{_tTimeBegin:0,_timeOut:null,tInit:function(){this.value*=60;var t=this.criteria.field;r[t]||(r[t]=!0,n[t]=60*n[t]||0),this._tTimeBegin=new Date},tRefreshData:function(){var t=new Date;this.value-=Math.ceil((t.getTime()-this._tTimeBegin.getTime())/1e3),this._tTimeBegin=t},tIsFalse:function(t){this.tRefreshData();var e=1e3+1e3*(this.value-n[this.criteria.field]);"equal"===this.logicalOperator&&(this.logicalOperator="more than or equal"),"less than"===this.logicalOperator&&(e-=2e3),clearTimeout(this._timeOut),this._timeOut=setTimeout(function(){o.ProActif.run(t)},Math.abs(e))}},"INTEGER"),a("ACTIVITY",{_timeOut:null,tInit:function(){var t=this.criteria.field;this.value*=60,n[t]=n[t]||0},tRefreshData:function(){var t=new Date,e=Math.ceil((t.getTime()-n.lastMove)/1e3);n.activeSince=e>5?n.activeSince:t.getTime(),n[this.criteria.field]=Math.ceil((t.getTime()-n.activeSince)/1e3)},tIsFalse:function(t){var e=1e3+1e3*(this.value-n[this.criteria.field]);"equal"===this.logicalOperator&&(this.logicalOperator="more than or equal"),"less than"===this.logicalOperator&&(e-=2e3),clearTimeout(this._timeOut),this._timeOut=setTimeout(function(){o.ProActif.run(t)},Math.abs(e))}},"FLOAT"),a("HTML",null,"STRING"),a("IHTML",null,"INTEGER"),a("FHTML",null,"FLOAT"),a("COUNTRY",null,"STRING"),a("TOWN",null,"STRING"),a("REFERRER",null,"STRING"),a("LANG",null,"STRING"),a("DAY",null,"INTEGER"),a("HOUR",null,"INTEGER"),a("DEVICE",null,"STRING"),s}},{lodash:35}],118:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=t("lodash");e.exports=function(e,n,a,s,c){var u=t("./action")(e,n,a,s,c);return function(){function t(e){r(this,t),o.assign(this,e),e.channel&&(this.channel=a.getChannel(e.channel)),e.targetingActions&&(this.actions=e.targetingActions.map(u))}return i(t,[{key:"hasButtonAction",value:function(){return o.some(this.actions,{type:"button"})}},{key:"hasActionRequiringDisplay",value:function(t){return o.some(this.actions,function(e){return e.canBeDisplayed(t)})}},{key:"shouldIncrementDisplayCount",value:function(t){return o.chain(this.actions).groupBy("type").map(function(t){return o.head(t)}).some(function(e){return e.canBeDisplayed(t)}).value()}},{key:"shouldIncrementMissedDisplayCount",value:function(t){return!this.hasActionRequiringDisplay(t)&&o.some(this.actions,function(t){return t.isVisible()})}},{key:"shouldIncrementExecutionCount",value:function(){return o.some(this.actions,function(t){return t.shouldIncrementExecutionCount()})}}]),t}()}},{"./action":113,lodash:35}],119:[function(t,e,n){var r=t("lodash").throttle,i=t("lodash");e.exports=function(t,e,n,o,a){function s(e){a.refresh(e),2==t.chat.status&&t.chat.sendPresence("dnd"),o()}function c(t){var e=document.location.href;f!==e&&(u(e),f=e),setTimeout(c,t)}function u(t){"string"==typeof t?l(function(){e.emit(h,t)}):console.warn("navigate first argument must be a string")}function l(e){var n=t.chaturl+"rpc/maintainVisitorState.php?s="+t.website_id+"&u="+t.vuid+"&lang="+t.curlang;t.$.ajax(n,{dataType:"jsonp",complete:function(){t.config&&(t.flags=t.config.flags,t.vProf=t.config.vProf,a.resetFlags(t.flags),a.resetProfile(t.vProf),delete t.config),e()}})}function d(e){2!=t.chat.status&&i.chain(e).filter({executed:!0}).isEmpty().value()&&t.Templates.hideUI()}var f=document.location.href,h=n.UserNavigated;return{launch:function(t){c(t||50),e.on(h,s),e.on(n.TargetingEngineRan,d)},stop:function(){e.off(h,s)},navigate:r(u,1e3,{trailing:!0,leading:!1})}}},{lodash:35}],120:[function(t,e,n){"use strict";var r=t("lodash");e.exports=function(t,e,n,i){function o(t){return{id:t.id,availability:t.attributes}}function a(t){return r.map(t,o)}function s(t,n){e.ajax({url:t,method:"GET",error:function(){return n.resolve([])},success:function(t){return n.resolve(a(t.data))}})}var c=!1,u=function(e){return t.routing.url+"targeting-rules/available?platform="+t.platform+"&lang="+t.curlang+"&ids[]="+e.join("&ids[]=")};return{checkRulesAvailability:function o(a,l){var d=l||e.Deferred();if(0===a.length)return d.resolve([]),d.promise();if(document.visibilityState&&"hidden"===document.visibilityState)return setTimeout(function(){o(a,d)},1e3),d.promise();var f=r.chain(a).filter({type:"interaction"}).map("id").value(),h=u(f);return c?s(h,d):(c=!0,t.forceDep=i(a),n.find().done(function(){s(h,d)})),d.promise()}}}},{lodash:35}],121:[function(e,n,r){n.exports=function(e,n,r){var i=e.vStats={val:function(t,e){return this["ext_"+t]=e,this},getValue:function(t){return this["ext_"+t]},customData:function(){var t={};for(var e in this)null!==this[e]&&"function"!=typeof this[e]&&-1!==e.indexOf("ext_")&&(t[e.substr(4).replace(/_/g," ")]=this[e]);return JSON.stringify(t)},getProfile:function(){var t={};for(var e in this)null!==this[e]&&"function"!=typeof this[e]&&-1===e.indexOf("ext_")&&("navTime"===e&&(this[e]=1e3*Math.round(+new Date/1e3-this.connectionTime),this[e]<0&&(this[e]=3e3)),t[e]=this[e]);return JSON.stringify(t)}},o=function(t){if(t){i.history_id=+t.history_id;for(var e in t)if(t.hasOwnProperty(e)&&"va_"===e.substring(0,3)){var n=e.substring(3),r=t[e];i.val(n,r)}i.transactionProbability=t.transactionProbability,i.isLastEventProbability=t.isLastEventProbability,i.addCartProbability=t.addCartProbability,i.chatAcceptedProbability=t.chatAcceptedProbability}},a=function(t){for(var e in t)t.hasOwnProperty(e)&&(i[e]=t[e])},s=function(o){if(i.actualURI=decodeURI(document.location.href),i.referrer_lastPage=document.referrer,o?(i.referrer_lastPage=i.actualScreen,i.actualScreen=o):i.actualScreen=i.actualURI,i.actualURI.search(/idz-[a-z0-9]{5}$/)>0&&(i.merpLink=!0,i.merpHash=i.actualURI.substr(i.actualURI.indexOf("idz-"))),i.winWidth=n(window).width(),i.winHeight=n(window).height(),i.browserInfo=r.browser+" "+r.version,i.deviceInfo=r.OS,i.userAgent=navigator.userAgent,i.deviceType=r.deviceType,i.vuid=e.vuid,void 0!==window.idzCustomData){for(var a in idzCustomData)null!==idzCustomData[a]&&"undefined"!==idzCustomData[a]&&i.val(a,idzCustomData[a]);var s=idzCustomData.custProfile||"",c=idzCustomData.extID||"";ue=idzCustomData.cust_email||idzCustomData.user_email||"",""===s&&""===c&&""===ue||e.JSONStore.saveData({custProfile:s,extID:c,email:ue})}try{for(var u=0,l=e.insiteCD.length;u<l;u++){var d=e.insiteCD[u],f=n(d.path).text()||n(d.path).val();f&&"INTEGER"===d.type&&(f=parseInt(f.replace(/,/g,".").replace(/[^\d.]+/g,""),10)),f&&"FLOAT"===d.type&&(f=parseFloat(f.replace(/,/g,".").replace(/[^\d.]+/g,""),10));var h=e.Store.get("ext_"+d.field);if("count"!==d.valtype&&"prev"!==d.valtype&&h===t&&(h=f),"current"===d.valtype)f!==t?i["ext_"+d.field]=f:delete i["ext_"+d.field];else if("prev"===d.valtype)h!==t&&(i["ext_"+d.field]=h),f!==t&&(h=f,e.Store.set("ext_"+d.field,h));else if("max"===d.valtype)f!==t&&f>=h&&(h=f,e.Store.set("ext_"+d.field,h)),h!==t&&(i["ext_"+d.field]=h);else if(f!==t&&"min"===d.valtype)f!==t&&f<=h&&(h=f,e.Store.set("ext_"+d.field,h)),h!==t&&(i["ext_"+d.field]=h);else if("count"===d.valtype){if(d.val){var p=!1;"STRING"!==d.type&&f==d.val?p=!0:"STRING"===d.type&&f&&-1!==f.indexOf(d.val)&&(p=!0),p&&(h=h||0,h++,e.Store.set("ext_"+d.field,h))}i["ext_"+d.field]=h||0}}}catch(t){console&&console.log&&console.log(t)}};return a(e.vProf),i.lang=e.curlang,i.activeSince=i.lastMove=(new Date).getTime(),i.history_id=0,o(e.flags),s(),{refresh:s,resetFlags:o,resetProfile:a}}},{}],122:[function(e,n,r){n.exports=function(e,n){return{getAttribute:function(n,r){var i=e.getValue(n);return i===t?r:i},setAttribute:function(t,r){return e.val(t,r),{persist:function(){var e={};e["va_"+t]=r,n.saveData(e)}}}}}},{}],123:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0});var r=function(t,e){for(var n in t)e(t[n],n)},i=function(t,e){var n=[];for(var r in t)n.push(e(t[r],r));return n},o=function(t){return i(t,function(t,e){return e+": "+t+";"}).join(" ")},a=function(t,e){r(e,function(e,n){"style"!==n?"onClick"!==n?!0!==e?t.setAttribute(n,e):t.setAttribute(n,""):t.addEventListener("click",e):t.setAttribute(n,o(e))})},s={A:["href"],APPLET:["codebase"],AREA:["href"],BASE:["href"],BLOCKQUOTE:["cite"],BODY:["background"],DEL:["cite"],FORM:["action"],FRAME:["longdesc","src"],HEAD:["profile"],IFRAME:["longdesc","src"],IMG:["longdesc","src","usemap"],INPUT:["src","usemap","formaction"],INS:["cite"],LINK:["href"],OBJECT:["classid","codebase","data","usemap"],Q:["cite"],SCRIPT:["src"],AUDIO:["src"],BUTTON:["formaction"],COMMAND:["icon"],EMBED:["src"],HTML:["manifest"],SOURCE:["src"],TRACK:["src"],VIDEO:["poster","src"]},c=function(t){return{renderAsString:function(){var e=t.tagName===u?t.innerHTML:t.outerHTML,n=s[t.tagName];return n?n.reduce(function(t,e){return t.replace(new RegExp(e+'=".+?"',"g"),function(t){return t.replace(/&amp;/g,"&")})},e):e},render:function(){if(t.tagName===u){for(var e=[],n=0;n<t.childNodes.length;n++)e.push(t.childNodes[n]);return e}return t}}},u=(n.html=function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=document.createElement(t);return a(o,e||{}),r.forEach(function(t){if("string"!=typeof t){if(t){var e=t.render();if(e instanceof Array)return void e.forEach(function(t){return o.appendChild(t)});o.appendChild(e)}}else o.appendChild(document.createTextNode(t))}),c(o)},n.Fragment="DOMHELPERSINTERNALEMPTYFRAGMENTCOMPONENT");n.render=function(t,e){var n=t.render();n instanceof Array?n.forEach(e.appendChild):e.appendChild(t.render())},n.renderAsString=function(t){return t.renderAsString()}},{}]},{},[41,39,40,47,50,58,55,59,56,60,61,57,62,63,64,65,66,67,68,69,51,70,71,72,52,53,73,74,54,75,76,77,78,79,80,81,82,83,84,85,86,87,88,42,49,5,3,4,2,1]),e&&(define=e)}();